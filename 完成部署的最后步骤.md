# å®Œæˆ CI/CD è‡ªåŠ¨åŒ–éƒ¨ç½²çš„æœ€åæ­¥éª¤

## âœ… å·²å®Œæˆ

1. **æœ¬åœ°ä»£ç å·²æäº¤å¹¶æ¨é€åˆ° GitHub**
   - Commit: `192c059 - feat: implement complete Git CI/CD automation system`
   - åŒ…å«æ‰€æœ‰ CI/CD æ–‡ä»¶:deploy-pm2.sh, CICD-SETUP.md, GitHub Actions workflow

2. **éƒ¨ç½²è„šæœ¬å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨**
   - `/var/www/playnew/deploy-pm2.sh` âœ…
   - `/var/www/playnew/CICD-SETUP.md` âœ…

## ğŸ”§ éœ€è¦å®Œæˆçš„æ­¥éª¤

### æ­¥éª¤ 1: è®¾ç½® GitHub Secrets (å¿…éœ€)

åœ¨ GitHub ä»“åº“ä¸­é…ç½® CI/CD æ‰€éœ€çš„å¯†é’¥:

1. æ‰“å¼€æ‚¨çš„ GitHub ä»“åº“: https://github.com/EthaninUK/playnew-0.3

2. è¿›å…¥ **Settings** â†’ **Secrets and variables** â†’ **Actions**

3. ç‚¹å‡» **New repository secret**,æ·»åŠ ä»¥ä¸‹ä¸‰ä¸ª secrets:

#### Secret 1: SSH_HOST
```
Name: SSH_HOST
Value: 13.158.222.72
```

#### Secret 2: SSH_USER
```
Name: SSH_USER
Value: ubuntu
```

#### Secret 3: SSH_PRIVATE_KEY
```
Name: SSH_PRIVATE_KEY
Value: (å¤åˆ¶ä¸‹é¢å®Œæ•´çš„ç§é’¥å†…å®¹)
```

è¿è¡Œæ­¤å‘½ä»¤è·å–ç§é’¥:
```bash
cat "/Users/m1/PlayNew_0.3/LightsailDefaultKey-ap-northeast-1 (2).pem"
```

**é‡è¦**: å¤åˆ¶å®Œæ•´å†…å®¹,åŒ…æ‹¬:
- ç¬¬ä¸€è¡Œ: `-----BEGIN RSA PRIVATE KEY-----`
- æ‰€æœ‰ä¸­é—´çš„å¯†é’¥å†…å®¹
- æœ€åä¸€è¡Œ: `-----END RSA PRIVATE KEY-----`

### æ­¥éª¤ 2: åœ¨æœåŠ¡å™¨ä¸Šé…ç½® Git ä»“åº“

æœ‰ä¸¤ç§æ–¹æ³•:

#### æ–¹æ³• A: è®¾ç½®ä»“åº“ä¸ºå…¬å¼€ (æ¨è,æœ€ç®€å•)

1. GitHub ä»“åº“ â†’ **Settings** â†’ **General**
2. æ»šåŠ¨åˆ°æœ€åº•éƒ¨ â†’ **Danger Zone**
3. ç‚¹å‡» **Change visibility** â†’ **Make public**
4. ç¡®è®¤æ“ä½œ

ç„¶ååœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ:
```bash
ssh -i "LightsailDefaultKey-ap-northeast-1 (2).pem" ubuntu@13.158.222.72

cd /var/www/playnew
git init
git remote add origin https://github.com/EthaninUK/playnew-0.3.git
git fetch origin
git checkout -b main origin/main
git branch --set-upstream-to=origin/main main
```

#### æ–¹æ³• B: ä½¿ç”¨ GitHub Personal Access Token (ä»“åº“ä¿æŒç§æœ‰)

1. GitHub â†’ **Settings** (ä¸ªäººè®¾ç½®,ä¸æ˜¯ä»“åº“è®¾ç½®) â†’ **Developer settings** â†’ **Personal access tokens** â†’ **Tokens (classic)**

2. ç‚¹å‡» **Generate new token** â†’ **Generate new token (classic)**

3. é…ç½®:
   - Note: `PlayNew Server Deployment`
   - Expiration: `No expiration` (æˆ–è‡ªå®šä¹‰)
   - å‹¾é€‰æƒé™: `repo` (å®Œæ•´çš„ä»“åº“è®¿é—®æƒé™)

4. ç‚¹å‡» **Generate token**,å¤åˆ¶ç”Ÿæˆçš„ token (åªæ˜¾ç¤ºä¸€æ¬¡!)

5. åœ¨æœåŠ¡å™¨ä¸Šé…ç½®:
```bash
ssh -i "LightsailDefaultKey-ap-northeast-1 (2).pem" ubuntu@13.158.222.72

cd /var/www/playnew
git init
git remote add origin https://github.com/EthaninUK/playnew-0.3.git

# é…ç½® Git ä½¿ç”¨ token è®¤è¯
git config --global credential.helper store
echo "https://EthaninUK:YOUR_TOKEN_HERE@github.com" > ~/.git-credentials

git fetch origin
git checkout -b main origin/main
git branch --set-upstream-to=origin/main main
```

### æ­¥éª¤ 3: æµ‹è¯•è‡ªåŠ¨éƒ¨ç½²

å®Œæˆä¸Šè¿°æ­¥éª¤å,è‡ªåŠ¨éƒ¨ç½²å·²ç»å°±ç»ª!

#### æµ‹è¯•æ–¹æ³• 1: è‡ªåŠ¨è§¦å‘ (æ¨è)
```bash
# åœ¨æœ¬åœ°åšä¸€ä¸ªå°æ”¹åŠ¨
git commit --allow-empty -m "test: trigger CI/CD deployment"
git push origin main

# ğŸ‰ GitHub Actions ä¼šè‡ªåŠ¨éƒ¨ç½²!
# æŸ¥çœ‹éƒ¨ç½²è¿›åº¦: https://github.com/EthaninUK/playnew-0.3/actions
```

#### æµ‹è¯•æ–¹æ³• 2: æ‰‹åŠ¨è§¦å‘
1. GitHub ä»“åº“ â†’ **Actions** æ ‡ç­¾
2. é€‰æ‹© **Deploy to Production** workflow
3. ç‚¹å‡» **Run workflow** æŒ‰é’®
4. é€‰æ‹© `main` åˆ†æ”¯
5. ç‚¹å‡»ç»¿è‰²çš„ **Run workflow** æŒ‰é’®

#### æµ‹è¯•æ–¹æ³• 3: ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šæµ‹è¯•éƒ¨ç½²è„šæœ¬
```bash
ssh -i "LightsailDefaultKey-ap-northeast-1 (2).pem" ubuntu@13.158.222.72

cd /var/www/playnew
chmod +x deploy-pm2.sh
./deploy-pm2.sh
```

## ğŸ“Š ç›‘æ§å’ŒéªŒè¯

### æŸ¥çœ‹ GitHub Actions æ‰§è¡Œæ—¥å¿—
https://github.com/EthaninUK/playnew-0.3/actions

### æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
```bash
# å‰ç«¯æ—¥å¿— (PM2)
pm2 logs playnew-frontend

# åç«¯æ—¥å¿— (Docker)
docker-compose -f docker-compose.prod.yml logs -f directus
docker-compose -f docker-compose.prod.yml logs -f meilisearch
docker-compose -f docker-compose.prod.yml logs -f n8n
```

### æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
pm2 status                                          # PM2 è¿›ç¨‹
docker-compose -f docker-compose.prod.yml ps        # Docker å®¹å™¨
```

## ğŸ¯ å®Œæˆåçš„å·¥ä½œæµç¨‹

ä¸€æ—¦è®¾ç½®å®Œæˆ,æ‚¨çš„æ—¥å¸¸å·¥ä½œæµç¨‹å°†ä¼šæ˜¯:

```bash
# æœ¬åœ°å¼€å‘
vim frontend/some-file.tsx
npm run dev  # æœ¬åœ°æµ‹è¯•

# æäº¤å¹¶æ¨é€
git add .
git commit -m "feat: add awesome feature"
git push origin main

# â˜•ï¸ å–æ¯å’–å•¡,ç­‰å¾…è‡ªåŠ¨éƒ¨ç½²å®Œæˆ!
# çº¦ 2-3 åˆ†é’Ÿå,æ›´æ”¹å°†åœ¨ https://www.playnew.ai ä¸Šçº¿
```

## ğŸ†˜ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: GitHub Actions éƒ¨ç½²å¤±è´¥
- æ£€æŸ¥ Actions æ—¥å¿—: https://github.com/EthaninUK/playnew-0.3/actions
- ç¡®è®¤ GitHub Secrets å·²æ­£ç¡®é…ç½®
- ç¡®è®¤ SSH ç§é’¥å®Œæ•´å¤åˆ¶ (åŒ…æ‹¬ BEGIN å’Œ END è¡Œ)

### é—®é¢˜ 2: æœåŠ¡å™¨ Git è®¤è¯å¤±è´¥
- å¦‚æœä»“åº“æ˜¯ç§æœ‰çš„,ç¡®ä¿ä½¿ç”¨äº† Personal Access Token
- æˆ–è€…å°†ä»“åº“è®¾ç½®ä¸ºå…¬å¼€

### é—®é¢˜ 3: éƒ¨ç½²è„šæœ¬æ‰§è¡Œå¤±è´¥
- SSH åˆ°æœåŠ¡å™¨æŸ¥çœ‹è¯¦ç»†é”™è¯¯
- æ£€æŸ¥æœåŠ¡å™¨ä¸Š `/var/www/playnew` ç›®å½•æƒé™
- ç¡®è®¤ Docker æœåŠ¡æ­£åœ¨è¿è¡Œ: `sudo systemctl status docker`

## ğŸ“š æ›´å¤šä¿¡æ¯

è¯¦ç»†çš„ CI/CD è®¾ç½®æŒ‡å—è¯·å‚é˜…: [CICD-SETUP.md](CICD-SETUP.md)

---

**ä¸‹ä¸€æ­¥**: å®Œæˆ"æ­¥éª¤ 1: è®¾ç½® GitHub Secrets",ç„¶åé€‰æ‹©"æ­¥éª¤ 2"çš„å…¶ä¸­ä¸€ç§æ–¹æ³•é…ç½®æœåŠ¡å™¨ã€‚

å®Œæˆå,æ‚¨å°±æ‹¥æœ‰äº†å®Œå…¨è‡ªåŠ¨åŒ–çš„ Git + CI/CD éƒ¨ç½²ç³»ç»Ÿ! ğŸš€
