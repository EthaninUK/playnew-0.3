const axios = require('axios');

const DIRECTUS_URL = 'http://localhost:8055';

// ===== 13.5 Alpaca Finance 杠杆挖矿 =====
const STRATEGY_13_5 = {
  title: 'Alpaca Finance 杠杆挖矿 - 收益放大器',
  slug: 'vault-13-5-alpaca-finance-leveraged-yield',
  summary: '在 Alpaca Finance 使用杠杆挖矿金库（最高 6x 杠杆），放大 PancakeSwap、Wombat 等协议的流动性挖矿收益，年化 20-150% APY，BSC 链上低 Gas 费操作。',

  category: 'vault',
  category_l1: 'yield',
  category_l2: '聚合器/金库',

  difficulty_level: 3,
  risk_level: 4,

  apy_min: 20,
  apy_max: 150,
  threshold_capital: '300 美元起',
  threshold_capital_min: 300,
  time_commitment: '初始设置 30 分钟，每周监控风险',
  time_commitment_minutes: 30,
  threshold_tech_level: 'intermediate',

  content: `> **适合人群**: DeFi 进阶用户，理解杠杆风险，追求高收益并能承受波动的投资者
> **阅读时间**: 约 18 分钟
> **关键词**: Alpaca Finance / 杠杆挖矿 / 6x 收益放大 / BSC 链 / 借贷 + 挖矿

---

## 🎯 什么是 Alpaca Finance 杠杆挖矿？用真实案例讲明白

### 小张的收益困境

**背景**：
- 小张有 1000 美元，在 PancakeSwap 挖矿
- 年化收益率 30%，一年赚 300 美元
- 看到别人用杠杆，收益翻倍甚至更多

**他的疑问**：
"我听说杠杆挖矿能让收益翻 3-6 倍，但我不懂怎么操作，也担心风险太高..."

### Alpaca Finance 如何放大收益？

**传统挖矿（无杠杆）**：
- 投入 1000 美元到 PancakeSwap BNB-BUSD 池
- 年化收益率 30%
- 一年赚 **300 美元**

**Alpaca 杠杆挖矿（3x 杠杆）**：
- 你投入 1000 美元本金
- Alpaca 借给你 2000 美元（2x 杠杆）
- 总共 3000 美元投入 PancakeSwap 挖矿
- 年化收益率 30% × 3000 = **900 美元收益**
- 扣除借款利息（假设 10%）：2000 × 10% = 200 美元
- 净收益：900 - 200 = **700 美元**
- **收益提升 133%！**（从 300 变成 700）

**核心原理**：
Alpaca Finance = **借贷协议 + 流动性挖矿** 的组合：
1. 你存入本金（比如 1000 BUSD）
2. Alpaca 从借贷池借钱给你（比如 2000 BUSD）
3. 总资金（3000 BUSD）自动投入 PancakeSwap 挖矿
4. 挖矿收益归你，你支付借款利息
5. 净收益 = 挖矿收益 × 杠杆倍数 - 借款利息

**简单说**：Alpaca 让你用**别人的钱**来挖矿，放大收益，但也放大了风险！

---

## 📊 为什么选择 Alpaca Finance？

### 1. 收益对比：无杠杆 vs 杠杆挖矿

以 **PancakeSwap BNB-BUSD 池** 为例（1000 美元本金）：

| 杠杆倍数 | 总投资额 | 年化 APY | 总收益 | 借款利息 | 净收益 | 收益提升 |
|---------|---------|---------|--------|---------|--------|---------|
| **1x（无杠杆）** | 1000 | 30% | 300 | 0 | **300** | 基准 |
| **2x 杠杆** | 2000 | 30% | 600 | -100 | **500** | +67% |
| **3x 杠杆** | 3000 | 30% | 900 | -200 | **700** | +133% |
| **4x 杠杆** | 4000 | 30% | 1200 | -300 | **900** | +200% |
| **6x 杠杆** | 6000 | 30% | 1800 | -500 | **1300** | +333% |

**关键发现**：
- ✅ 杠杆越高，收益越高（但风险也越高）
- ⚠️ 必须确保 **挖矿 APY > 借款利率**，否则亏损
- ⚠️ 币价波动会导致清算风险

### 2. Alpaca Finance 的市场地位

- **TVL（总锁仓量）**：1-3 亿美元
- **所在链**：BSC（币安智能链）
- **成立时间**：2021 年初（3 年历史）
- **独特优势**：BSC 链上最大的杠杆挖矿协议

**核心功能**：
1. **杠杆挖矿**：最高 6x 杠杆放大收益
2. **借贷市场**：不想挖矿也可以出借赚利息（8-15% APY）
3. **自动复投**：挖矿奖励自动卖出并复投
4. **多池支持**：PancakeSwap、Wombat、BiSwap 等

**安全性**：
- 经过 PeckShield、Certik 审计
- 运营 3 年，经历多轮牛熊
- 有清算机制保护借款人
- 但仍有智能合约风险

---

## ⚠️ 核心风险：必须先理解再操作！

### 风险 1：清算风险（最重要！）

**什么是清算？**
- 如果你挖矿的币价大跌，你的资产价值可能不足以偿还借款
- 这时 Alpaca 会**强制卖出你的资产**来还款
- 你可能损失大部分本金

**举例说明**：
- 你用 1000 BUSD 本金，3x 杠杆挖 BNB-BUSD
- 借了 2000 BUSD，总共 3000 投入
- 如果 BNB 价格下跌 25%，你的资产变成 2250
- 资产价值 < 借款 × 清算阈值（比如 1.2），触发清算
- Alpaca 强制卖出，你可能只剩 250-300 BUSD（损失 70%）

**如何避免清算**？
1. **选择稳定币对**：BNB-BUSD 比 BNB-ETH 稳定
2. **降低杠杆倍数**：新手用 2x，进阶用 3-4x
3. **监控健康系数**：保持在 1.5 以上（越高越安全）
4. **及时补仓**：价格下跌时追加本金
5. **设置止损**：跌到一定程度主动退出

### 风险 2：无常损失（LP 挖矿特有）

**什么是无常损失？**
- 当你提供流动性时，两个币的价格比例变化会导致损失
- 比如 BNB-BUSD 池，BNB 价格上涨，你的 BNB 会被自动卖出换成 BUSD
- 虽然你的 BUSD 变多了，但 BNB 减少了，总价值可能低于单纯持有 BNB

**杠杆会放大无常损失**：
- 无杠杆无常损失 5%
- 3x 杠杆无常损失可能达到 15%

**如何降低无常损失**？
- 选择价格相关性高的币对（BNB-BUSD、ETH-BTC）
- 选择稳定币对（BUSD-USDT，无常损失极低）
- 短期波动不要慌，长期挖矿收益会覆盖

### 风险 3：借款利率波动

- Alpaca 的借款利率是浮动的（根据资金利用率）
- 利率范围：5-25%（极端情况更高）
- 如果利率突然升高（比如从 8% 涨到 20%），你的净收益会骤减

**应对方法**：
- 定期检查借款利率（每周 1 次）
- 如果利率 > 挖矿 APY 的 50%，考虑降低杠杆
- 使用 Alpaca 的利率预警功能

---

## 📋 Alpaca Finance 使用指南（分步教程）

### 第一步：准备工作（10 分钟）

**你需要准备**：

1. **钱包**：MetaMask
   - 下载：metamask.io
   - 添加 BSC 网络（见下方配置）

2. **添加 BSC 网络到 MetaMask**：
   - 打开 MetaMask → 网络 → 添加网络
   - 网络名称：BSC Mainnet
   - RPC URL：https://bsc-dataseed.binance.org/
   - 链 ID：56
   - 货币符号：BNB
   - 区块浏览器：https://bscscan.com

3. **准备资金**：
   - **本金**：至少 300 美元（推荐 500-1000）
   - **币种选择**：
     - 新手推荐：BUSD（稳定币）
     - 进阶选择：BNB、USDT
   - 从交易所提币到 BSC 钱包

4. **Gas 费**：准备 5-10 美元的 BNB
   - BSC 的 Gas 费很低（每笔 0.5-2 美元）

### 第二步：理解 Alpaca 的核心概念（5 分钟）

**Health（健康系数）**：
- 数值越高，越安全（推荐 > 1.5）
- 低于 1.0 会被清算
- 公式：Health = 资产价值 / (借款金额 × 清算阈值)

**Debt Ratio（债务率）**：
- 显示你借了多少钱相对于总资产
- 比如 3x 杠杆 ≈ 67% 债务率

**Yield（收益率）**：
- 显示当前池子的年化收益率
- 包括挖矿奖励 + 交易手续费

**Borrow Interest（借款利率）**：
- 你需要支付的借款年化利息
- 动态变化，资金紧张时会升高

### 第三步：选择合适的挖矿池（核心步骤）

1. **访问 Alpaca 官网**：
   - 打开 https://app.alpacafinance.org
   - 点击右上角 **Connect Wallet**
   - 选择 MetaMask 并连接

2. **进入 Lend & Earn 页面**：
   - 在顶部菜单点击 **Farm**
   - 看到所有可用的挖矿池

3. **新手推荐池子**（按安全等级排序）：

   **最安全 - 稳定币池**：
   - **BUSD-USDT**（推荐度 ⭐⭐⭐⭐⭐）
     - 年化：20-40%（2-3x 杠杆后）
     - 风险：极低（无价格波动）
     - 无常损失：几乎为 0
     - 适合新手测试杠杆机制

   **中等风险 - BNB 相关池**：
   - **BNB-BUSD**（推荐度 ⭐⭐⭐⭐）
     - 年化：30-60%（3x 杠杆后）
     - 风险：中等
     - 单边 BNB 波动，一边稳定币保护
     - 适合看好 BNB 的用户

   - **BNB-ETH**（推荐度 ⭐⭐⭐）
     - 年化：40-80%（4x 杠杆后）
     - 风险：较高
     - 双边波动，无常损失较大
     - 适合高级玩家

   **高收益 - 新项目池**：
   - **新代币对**（推荐度 ⭐⭐）
     - 年化：100-200%+（高杠杆后）
     - 风险：极高
     - 代币可能归零，清算风险大
     - 只适合小额测试

4. **选池标准**：
   - **新手**：选 BUSD-USDT，2x 杠杆
   - **进阶**：选 BNB-BUSD，3x 杠杆
   - **高级**：选高 APY 池，4-6x 杠杆（自担风险）

### 第四步：开始杠杆挖矿（关键操作）

假设我们选择 **BNB-BUSD 池，3x 杠杆**：

1. **点击选中的池子**：
   - 在 Farm 列表中找到 **BNB-BUSD (PancakeSwap)**
   - 点击进入详情页

2. **选择杠杆倍数和币种**：
   - 看到两个选项：**Farm BNB** 或 **Farm BUSD**
   - 区别：
     - **Farm BNB**：你借 BNB，适合看涨 BNB
     - **Farm BUSD**：你借 BUSD，适合看跌 BNB 或求稳
   - 新手建议选 **Farm BUSD**（更稳定）

3. **输入金额和杠杆**：
   - 输入你的本金（比如 1000 BUSD）
   - 选择杠杆倍数（新手选 2x 或 3x）
   - 系统会显示：
     - 你的健康系数（Health）
     - 预计年化收益率
     - 借款金额和利率

4. **模拟案例（重要！）**：

   **输入**：
   - 本金：1000 BUSD
   - 杠杆：3x
   - 借款：2000 BUSD

   **系统显示**：
   - 总投资额：3000 BUSD
   - 健康系数：1.8（安全）
   - 挖矿 APY：30%
   - 借款利率：10%
   - 预计年收益：900 - 200 = **700 BUSD**

   **确认信息无误后继续**

5. **授权和存入**：
   - 第一次使用需要 **Approve BUSD**（授权合约）
     - 点击 Approve，确认 MetaMask 交易
     - 等待交易完成（约 5 秒）
   - 授权后点击 **Farm**
     - 确认交易，支付 Gas 费（约 1-2 美元）
     - 等待交易完成

6. **验证是否成功**：
   - 回到 Alpaca 首页，点击 **My Positions**
   - 看到你的持仓信息：
     - 资产价值
     - 债务金额
     - 健康系数
     - 实时收益
   - 成功！

### 第五步：监控和管理持仓（每周 1 次）

**日常监控重点**：

1. **健康系数（Health）**：
   - **健康状态**：> 1.5（绿色）
   - **警告状态**：1.2-1.5（黄色，需关注）
   - **危险状态**：< 1.2（红色，即将清算）

   **如果健康系数下降**：
   - 方案 A：追加本金（Add Collateral）
   - 方案 B：部分还款（Repay）
   - 方案 C：直接平仓止损（Close Position）

2. **实时收益**：
   - 在 My Positions 看到 **Yield Earned**
   - Alpaca 会自动复投，你看到的是累计收益

3. **借款利率变化**：
   - 检查 **Borrow Interest** 是否异常升高
   - 如果 > 15%，考虑降低杠杆

**如何追加本金（避免清算）**：
1. 进入 My Positions
2. 点击你的持仓
3. 点击 **Add Collateral**
4. 输入追加金额（比如 200 BUSD）
5. 确认交易
6. 健康系数会立即提升

**如何部分还款（降低风险）**：
1. 点击持仓 → **Repay**
2. 输入还款金额（比如还 500 BUSD 借款）
3. 系统自动卖出部分 LP，还款
4. 杠杆倍数降低，风险下降

### 第六步：退出和收获（随时可操作）

**完全退出（Close Position）**：

1. **进入持仓页面**：
   - My Positions → 点击你的持仓

2. **选择退出方式**：

   **方式 A：Minimize Trading（最小化交易）**：
   - 尽量保留 LP Token 形态
   - 减少滑点损失
   - 适合市场正常时

   **方式 B：Convert to BNB / Convert to BUSD**：
   - 把所有资产转换成单一币种
   - 适合你看好某个币的时候

3. **点击 Close Position**：
   - 系统会自动：
     1. 卖出部分 LP 还清借款
     2. 剩余资产返回你的钱包
   - 确认交易，支付 Gas 费

4. **收到资金**：
   - 本金 + 净收益 - 借款利息 = 最终到账
   - 比如 1000 本金，赚了 700，最终收到 1700 BUSD

---

## 🎓 进阶技巧和策略

### 技巧 1：动态调整杠杆倍数

**策略**：
- 牛市/横盘：用 3-4x 杠杆，放大收益
- 熊市/大跌：降低到 2x 或平仓，保护本金

**操作方法**：
- 定期（每周）查看市场趋势
- 用 Repay 功能部分还款，降低杠杆
- 或用 Add Debt 功能增加借款，提高杠杆

### 技巧 2：多池分散投资

不要把所有资金放一个池子：

**分散方案**：
- 50% → BUSD-USDT（安全稳定）
- 30% → BNB-BUSD（中等收益）
- 20% → 高收益池（激进配置）

### 技巧 3：利用 Alpaca 借贷赚利息

如果你不想冒杠杆风险，可以反过来：

**出借赚利息**：
1. 在 Alpaca 首页选择 **Lend**
2. 存入 BUSD/BNB
3. 年化 8-15%，别人借你的钱去杠杆挖矿
4. 你赚取利息，无清算风险
5. 随时可以提取

**适合谁**：
- 保守型投资者
- 想赚稳定收益的用户
- 熊市避险选择

### 技巧 4：使用 Zapper 一键进入

**简化操作**：
- 访问 zapper.fi
- 搜索 "Alpaca Finance"
- 用任意代币一键 Zap 进 LP 池
- 省去手动添加流动性的步骤

---

## ❓ 常见问题 FAQ

**Q1：Alpaca 安全吗？会不会跑路？**
A：Alpaca 是 BSC 上运营 3 年的老牌项目，经过多次审计。但 DeFi 始终有风险，建议分散投资，不要 All-in。

**Q2：杠杆挖矿和合约杠杆有什么区别？**
A：
- **合约杠杆**（如 Binance 合约）：赌价格涨跌，高风险高收益
- **杠杆挖矿**：用杠杆放大挖矿收益，风险相对较低（但仍有清算风险）

**Q3：健康系数多少才安全？**
A：
- > 2.0：非常安全
- 1.5-2.0：安全
- 1.2-1.5：需要关注
- < 1.2：危险，可能被清算

**Q4：清算后我会损失所有本金吗？**
A：不会全部损失，但可能损失 50-80%。清算后剩余资产会返还给你。

**Q5：什么时候应该降低杠杆？**
A：
- 市场大跌，健康系数 < 1.5
- 借款利率 > 挖矿 APY 的 50%
- 你开始睡不着觉，心里不安

**Q6：小资金（300 美元）适合杠杆挖矿吗？**
A：可以，但建议：
- 只用 2x 杠杆
- 选择 BUSD-USDT 稳定池测试
- 把它当作学习成本，先体验机制

**Q7：Alpaca 和 Yearn 有什么区别？**
A：
- **Yearn**：无杠杆，收益 5-15%，风险低
- **Alpaca**：有杠杆，收益 20-150%，风险高
- 如果你是新手，先用 Yearn 积累经验

**Q8：可以 24 小时不管吗？**
A：不建议！杠杆挖矿需要定期监控（每周至少 2 次），特别是在市场波动大的时候。

---

## 💡 最后的建议

### 什么人适合 Alpaca 杠杆挖矿？

✅ **适合**：
- DeFi 进阶用户，理解杠杆和清算机制
- 追求高收益，能承受 30-50% 本金损失风险
- 有时间定期监控持仓（每周 2-3 次）
- 对 BSC 生态熟悉
- 本金至少 500 美元（小资金不划算）

❌ **不适合**：
- DeFi 新手（建议先用 Yearn/Beefy）
- 风险厌恶型投资者
- 没时间监控的人
- 不理解清算机制的用户
- 承受不了本金损失的人

### 实操建议

**第一阶段（第 1 周）**：
- 在 BUSD-USDT 池投入 300-500 美元
- 只用 2x 杠杆测试
- 每天查看健康系数，熟悉界面

**第二阶段（第 2-4 周）**：
- 如果测试成功，增加到 1000 美元
- 尝试 BNB-BUSD 池，3x 杠杆
- 学会追加本金和部分还款

**第三阶段（长期）**：
- 建立杠杆挖矿组合：
  - 50% 低杠杆稳定池（2x）
  - 30% 中等杠杆 BNB 池（3x）
  - 20% 高杠杆激进池（4-5x）
- 每周复盘，根据市场调整杠杆
- 设定止盈目标（比如收益达到 50% 就部分退出）

### 风险管理原则（必须遵守！）

1. **永远不要满杠杆**：最高用 4x，给自己留缓冲空间
2. **设置止损线**：健康系数 < 1.3 立即追加或平仓
3. **定期提现**：每月提取 50% 收益锁定利润
4. **分散投资**：不要把所有钱放 Alpaca
5. **了解退出成本**：提前计算 Gas 费 + 滑点

Alpaca Finance 是 **收益放大器**，但也是**风险放大器**。只有真正理解杠杆机制，严格执行风险管理的用户，才能在杠杆挖矿中长期获利。

**记住**：高收益来自高风险，永远不要投入超过你能承受损失的资金！从小额开始，慢慢积累经验。`,

  steps: [
    { step_number: 1, title: '理解杠杆和清算机制', description: '学习健康系数、债务率等核心概念。', estimated_time: '15 分钟' },
    { step_number: 2, title: '选择合适的池子和杠杆', description: '新手选 BUSD-USDT + 2x 杠杆测试。', estimated_time: '10 分钟' },
    { step_number: 3, title: '开始杠杆挖矿', description: '授权并存入资金，开启杠杆挖矿持仓。', estimated_time: '10 分钟' },
    { step_number: 4, title: '每周监控健康系数', description: '检查健康系数、借款利率，必要时追加本金。', estimated_time: '每周 15 分钟' },
    { step_number: 5, title: '动态调整杠杆', description: '根据市场情况提高或降低杠杆倍数。', estimated_time: '每月 20 分钟' },
  ],
};

// ===== 13.6 Sommelier Finance 主动管理 =====
const STRATEGY_13_6 = {
  title: 'Sommelier Finance 主动管理金库 - AI 策略师代你投资',
  slug: 'vault-13-6-sommelier-finance-active-management',
  summary: '投资 Sommelier Finance 的主动管理金库，由链上策略师和 AI 算法优化资产配置，动态调整持仓追求超额收益，年化 12-60% APY，适合追求专业管理的投资者。',

  category: 'vault',
  category_l1: 'yield',
  category_l2: '聚合器/金库',

  difficulty_level: 2,
  risk_level: 3,

  apy_min: 12,
  apy_max: 60,
  threshold_capital: '500 美元起',
  threshold_capital_min: 500,
  time_commitment: '初始存入 15 分钟，完全自动管理',
  time_commitment_minutes: 15,
  threshold_tech_level: 'intermediate',

  content: `> **适合人群**: 追求专业投资策略，相信主动管理能跑赢市场的中高级投资者
> **阅读时间**: 约 16 分钟
> **关键词**: Sommelier Finance / 主动管理 / AI 策略 / 链上基金 / 动态调仓

---

## 🎯 什么是 Sommelier Finance？用类比讲明白

### 被动 vs 主动投资的困境

**小李的投资经历**：

**第一阶段 - 被动投资（Yearn/Beefy）**：
- 存入 10000 USDC 到 Yearn USDC Vault
- 系统自动在 Compound、Aave 之间切换
- 年化收益 8-12%，很稳定
- 但总觉得：**"市场上那么多机会，我只能拿固定收益？"**

**第二阶段 - 自己主动投资**：
- 看到某个新 DeFi 项目 APY 80%，冲进去
- 两周后代币崩盘，亏损 30%
- 又试了几个"高收益"池，有的赚有的亏
- 结果：**累死累活，收益还不如躺平**

**第三阶段 - 发现 Sommelier**：
- "有没有专业的基金经理帮我主动管理，我只需要出钱？"
- Sommelier Finance 就是这样的产品！

### Sommelier = 链上对冲基金

**传统对冲基金**：
- 你把钱交给专业基金经理
- 他们根据市场动态调整持仓
- 目标：跑赢市场，获得超额收益
- 问题：门槛高（100 万美元起）、不透明、锁定期长

**Sommelier Finance**：
- 把钱存入 Sommelier Vault
- **链上策略师 + AI 算法**自动管理你的资产
- 实时调整持仓：
  - 市场好时提高风险敞口
  - 市场差时转移到稳定资产
  - 捕捉短期套利机会
- 优势：
  - 门槛低（500 美元起）
  - 完全透明（链上可查）
  - 随时退出（无锁定期）
  - 策略由专业团队 + AI 执行

**核心差异**：

| 特点 | 被动金库（Yearn） | Sommelier 主动金库 |
|-----|-----------------|-------------------|
| 策略调整 | 固定策略（如借贷利率套利） | 动态策略（根据市场调整） |
| 收益来源 | 固定协议收益 | 套利 + 趋势交易 + 借贷 |
| 年化收益 | 5-15% | 12-60% |
| 风险 | 低 | 中等 |
| 适合人群 | 保守型 | 进取型 |

**简单说**：
- Yearn = **余额宝**（稳定但收益有限）
- Sommelier = **私募基金**（追求超额收益，但有波动）

---

## 📊 为什么选择 Sommelier Finance？

### 1. 核心优势：专业管理 + AI 增强

**Sommelier 的策略团队**：
- 来自 TradFi（传统金融）背景的量化交易员
- 使用机器学习算法预测市场趋势
- 24/7 监控链上数据，实时调仓

**真实案例 - Real Yield ETH 策略**：

**市场背景（2023 年）**：
- ETH 价格在 1500-2000 美元波动
- 借贷利率：Aave 3-5%，Compound 4-6%
- Uniswap V3 LP 收益：5-15%（取决于价格区间）

**Sommelier 如何操作**（简化版）：

**第 1 周**：
- 检测到 ETH 价格上涨趋势
- 策略：60% Uniswap V3 LP（捕捉价格上涨 + 手续费）
- 策略：40% Aave 借贷（稳定收益）
- 周收益：1.2%（年化 62%）

**第 2 周**：
- 检测到波动加剧，价格不确定
- 调整为：30% Uniswap V3 LP，70% Aave
- 降低风险，保护利润
- 周收益：0.5%（年化 26%）

**第 3 周**：
- 检测到 Compound 利率突然升高到 8%
- 调整为：80% Compound，20% Uniswap
- 捕捉套利机会
- 周收益：0.8%（年化 42%）

**对比被动策略（Yearn ETH Vault）**：
- 固定在 Aave 借贷，年化 5%
- 3 周收益：0.29%

**Sommelier Real Yield ETH**：
- 动态调整，3 周总收益：2.5%
- **超额收益：+760%**

### 2. Sommelier 的产品矩阵

Sommelier 有多个 Vault，每个针对不同风险偏好：

**稳健型 - Real Yield USD**：
- 资产：USDC/USDT/DAI
- 策略：在 Aave、Compound、Maker 之间动态切换
- 年化：12-20%
- 风险：低
- 适合：保守型投资者

**平衡型 - Real Yield ETH**：
- 资产：ETH
- 策略：借贷 + Uniswap V3 LP + 套利
- 年化：20-40%
- 风险：中等
- 适合：长期持有 ETH 的用户

**进取型 - Turbo ETH**：
- 资产：ETH
- 策略：高频交易 + 杠杆 LP + 期权对冲
- 年化：30-60%+
- 风险：高
- 适合：追求高收益的进阶用户

**DeFi 原生型 - Morpho Vault**：
- 资产：多种
- 策略：利用 Morpho 协议的优化借贷
- 年化：15-35%
- 风险：中等

### 3. 技术创新：Cosmos 跨链架构

Sommelier 基于 **Cosmos SDK** 构建：
- 可以管理以太坊、Arbitrum、Optimism 上的资产
- 策略执行速度快（Cosmos 链的优势）
- Gas 费低（策略调整在 Cosmos 链上计算）

---

## 📋 Sommelier Finance 使用指南

### 第一步：准备工作（10 分钟）

**你需要准备**：

1. **钱包**：MetaMask
   - 确保已安装并备份助记词

2. **资金**：至少 500 美元
   - 稳定币：USDC/USDT/DAI（选 Real Yield USD）
   - ETH：至少 0.3 ETH（选 Real Yield ETH）
   - 从交易所提币到以太坊主网

3. **Gas 费**：准备 50-100 美元的 ETH
   - 存入和提取各需要一笔交易
   - 建议在 Gas 低峰时操作

### 第二步：选择合适的 Vault

1. **访问 Sommelier 官网**：
   - 打开 https://app.sommelier.finance
   - 点击 **Connect Wallet** 连接 MetaMask

2. **浏览 Vault 列表**：

   在首页看到所有 Vault，显示：
   - **APY**：近期年化收益率（动态变化）
   - **TVL**：总锁仓量（越大越稳定）
   - **策略说明**：Vault 的投资策略

3. **新手推荐 Vault**：

   **最稳健 - Real Yield USD**：
   - 年化：12-20%
   - 策略：稳定币在 Aave/Compound/Morpho 动态切换
   - 风险：极低
   - 适合：第一次使用 Sommelier 的用户

   **平衡选择 - Real Yield ETH**：
   - 年化：20-40%
   - 策略：ETH 借贷 + Uniswap V3 LP
   - 风险：中等
   - 适合：长期看好 ETH 的持有者

   **进阶选择 - Turbo stETH**：
   - 年化：25-50%
   - 策略：Lido stETH 复杂策略（包含杠杆）
   - 风险：较高
   - 适合：理解 stETH 机制的用户

### 第三步：存入资金（5 分钟）

假设选择 **Real Yield USD Vault**：

1. **点击 Vault 进入详情页**：
   - 看到详细的策略说明
   - 历史收益曲线
   - 当前资产配置

2. **查看当前策略配置**：
   - 比如显示：
     - 50% Aave USDC（借贷）
     - 30% Morpho USDT（优化借贷）
     - 20% Compound DAI（借贷）
   - 这会实时变化（策略师调整）

3. **输入存款金额**：
   - 点击 **Deposit** 标签
   - 输入金额（比如 1000 USDC）
   - 系统显示你将获得的 **Vault 份额**（类似基金份额）

4. **授权并存入**：
   - 第一次需要 **Approve USDC**（授权）
     - 点击 Approve，确认 MetaMask 交易
     - 等待交易完成（约 1 分钟）
   - 授权后点击 **Deposit**
     - 确认交易，支付 Gas 费
     - 等待交易完成

5. **验证成功**：
   - 在首页点击 **Portfolio**
   - 看到你的持仓：
     - Vault 份额
     - 当前价值
     - 实时收益
   - 成功！

### 第四步：理解收益来源（了解机制）

**Sommelier 如何产生收益？**

1. **基础收益层**（稳定）：
   - 借贷协议利息（Aave、Compound）
   - Uniswap LP 手续费
   - 质押收益（stETH 等）

2. **优化收益层**（主动管理）：
   - 动态切换到利率最高的协议
   - 调整 Uniswap V3 LP 的价格区间
   - 利用 Morpho 等优化协议获得更高利率

3. **套利收益层**（策略增强）：
   - 捕捉短期套利机会
   - 跨协议利差套利
   - 流动性挖矿奖励优化

**举例说明**：

**某周的策略调整**（Real Yield ETH）：
- 周一：Aave ETH 借贷利率 4%，全仓 Aave
- 周三：Compound 利率升到 5.5%，转移 60% 到 Compound
- 周五：Uniswap ETH/USDC 手续费率突增，分配 30% 到 LP
- 结果：周收益 0.6%（远超单一协议的 0.08%）

### 第五步：监控和管理（每月 1 次）

**Sommelier 的优势是自动化，你基本不需要操作**

**建议监控项**：

1. **每月查看收益**（5 分钟）：
   - 登录 Portfolio
   - 查看本月收益率
   - 对比其他 Vault 表现

2. **了解策略调整**（可选）：
   - 查看 Vault 页面的 **Rebalance History**
   - 了解策略师做了哪些调整
   - 学习专业投资思路

3. **关注 APY 变化**：
   - Sommelier 的 APY 是动态的
   - 如果某个 Vault APY 持续下降，可以考虑切换

**什么时候需要调整？**

- **市场大变化**：比如熊市，考虑切换到稳定币 Vault
- **收益率下降**：如果 APY < 10% 持续 1 个月，可能策略失效
- **风险偏好变化**：想要更稳健或更激进，切换 Vault

### 第六步：提取资金（随时可退）

**Sommelier 没有锁定期，随时提取**

1. **进入 Vault 页面**：
   - 找到你存款的 Vault
   - 点击 **Withdraw** 标签

2. **输入提取金额**：
   - 输入要提取的份额（可以部分提取）
   - 或点击 **Max** 全部提取
   - 系统显示你将收到的资产数量（本金 + 收益）

3. **确认提取**：
   - 点击 **Withdraw**
   - 确认 MetaMask 交易（Gas 费）
   - 等待交易完成

4. **收到资金**：
   - 资产直接回到你的钱包
   - 比如存入 1000 USDC，3 个月后提取可能变成 1050 USDC

**提取费用**：
- Sommelier 收取 **1% 管理费 + 10% 绩效费**
- 管理费：每年 1%（自动扣除）
- 绩效费：只对超额收益部分收取 10%
  - 比如你赚了 100 USDC，扣除 10 USDC 绩效费
  - 你实际收到 90 USDC

---

## ⚠️ 风险提示和注意事项

### 主要风险

**1. 策略执行风险（中等）**

- 策略师的决策可能失误
- 市场突变时，主动管理可能跑输被动策略
- **历史表现不代表未来收益**

**案例**：
- 2022 年 LUNA 崩盘时，某些主动策略损失 20-30%
- 被动稳定币策略反而更抗跌

**缓解措施**：
- 选择 TVL 大、运营时间长的 Vault
- 分散投资，不要 All-in 一个 Vault

**2. 智能合约风险（中等）**

- Sommelier 依赖多个底层协议（Aave、Uniswap 等）
- 任何一个协议出问题，可能影响 Vault
- Sommelier 本身也有合约风险

**安全措施**：
- Sommelier 经过 Certik、Quantstamp 审计
- 有 bug 赏金计划
- 运营 2 年无重大安全事故

**3. 绩效费风险（低）**

- 10% 绩效费可能侵蚀收益
- 如果 Vault 收益不佳，费用占比会更高

**对比**：
- Yearn：绩效费 20%
- Beefy：绩效费 4.5%
- Sommelier：1% 管理费 + 10% 绩效费（中等偏低）

**4. Gas 费成本（中等）**

- 以太坊主网操作，Gas 费较高
- 存入 + 提取可能需要 50-100 美元
- 小资金不划算

**解决方案**：
- 至少投入 500 美元
- 在 Gas 低峰操作（周末、凌晨）
- 持有至少 3 个月，摊薄 Gas 费成本

### 安全建议

1. **从小额开始**：第一次投 500-1000 美元测试
2. **选择稳定 Vault**：新手优先 Real Yield USD
3. **长期持有**：至少 3 个月，让策略发挥作用
4. **对比表现**：定期对比 Yearn 等被动策略
5. **设定止损**：如果亏损 > 10%，考虑退出

---

## 🎓 进阶玩法和策略

### 策略 1：多 Vault 组合投资

**不要只投一个 Vault，建立投资组合**：

**保守组合（年化 15-25%）**：
- 50% Real Yield USD（稳定币）
- 30% Real Yield ETH
- 20% Yearn USDC（对冲）

**平衡组合（年化 25-40%）**：
- 40% Real Yield ETH
- 30% Turbo stETH
- 30% Morpho Vault

**激进组合（年化 40-60%+）**：
- 50% Turbo stETH
- 30% 高 APY 新 Vault
- 20% 稳定币保底

### 策略 2：定期再平衡

**每季度调整配置**：
- 检查各 Vault 表现
- 卖出表现差的，买入表现好的
- 保持风险敞口平衡

### 策略 3：利用 Zapper 简化操作

- 访问 zapper.fi
- 搜索 "Sommelier"
- 用任意代币一键 Zap 进 Vault
- 省去手动兑换的步骤

---

## ❓ 常见问题 FAQ

**Q1：Sommelier 和 Yearn 到底选哪个？**
A：
- **Yearn**：适合保守型，追求稳定收益（5-15%）
- **Sommelier**：适合进取型，追求超额收益（12-60%）
- 建议：两者都配置，比例根据风险偏好调整

**Q2：绩效费 10% 会不会太高？**
A：不高。对比传统对冲基金（2% 管理费 + 20% 绩效费），Sommelier 已经很良心。而且绩效费只对超额收益收取，赚钱了才收费。

**Q3：为什么 APY 一直在变？**
A：Sommelier 是主动管理，收益率跟随市场和策略变化。这很正常。如果 APY 稳定不变，反而说明策略太被动。

**Q4：策略师是谁？靠谱吗？**
A：Sommelier 团队来自 TradFi 背景（传统金融），有量化交易经验。但没有人能保证 100% 盈利，主动管理总有失误风险。

**Q5：可以随时提取吗？**
A：可以。Sommelier 没有锁定期，随时提取。但建议至少持有 3 个月，让策略有时间发挥。

**Q6：小资金（500 美元）适合吗？**
A：勉强可以，但 Gas 费占比较高（可能 10-20%）。建议至少 1000 美元，或等以太坊 Gas 费降低。

**Q7：熊市时 Sommelier 会保护本金吗？**
A：不会。主动管理不等于保本。熊市时策略师会降低风险（比如转移到稳定币），但不能完全避免损失。

**Q8：和其他主动管理平台比如何？**
A：
- **Sommelier**：Cosmos 架构，跨链管理
- **Enzyme**：以太坊原生，更去中心化
- **dHEDGE**：支持更多链，但 TVL 较小
- Sommelier 在技术和收益上较平衡

---

## 💡 最后的建议

### 什么人适合 Sommelier Finance？

✅ **适合**：
- DeFi 中级到高级用户
- 相信主动管理能跑赢被动策略
- 追求 15-40% 年化收益
- 能承受 10-20% 的波动
- 本金至少 500 美元（推荐 1000+）
- 愿意长期持有（3 个月以上）

❌ **不适合**：
- DeFi 新手（先用 Yearn 积累经验）
- 极度保守的投资者（选择 Aave 直接借贷）
- 需要保本的资金
- 频繁进出的短期交易者
- 小额资金（< 500 美元）

### 实操建议

**第一个月**：
- 在 Real Yield USD 投入 500-1000 美元
- 观察策略调整和收益变化
- 对比 Yearn USDC Vault 的表现

**第二到三个月**：
- 如果表现良好，增加到 2000-5000 美元
- 尝试 Real Yield ETH 或其他 Vault
- 建立多 Vault 组合

**长期策略**：
- 保持 30-50% 在 Sommelier（主动管理）
- 30-50% 在 Yearn/Beefy（被动策略）
- 20% 在 Aave 等底层协议（保底）
- 每季度再平衡

Sommelier Finance 是 **DeFi 中的对冲基金**，提供专业的主动管理服务。虽然不能保证一定跑赢被动策略，但对于追求超额收益、相信专业管理的投资者来说，是值得配置的选择。

**记住**：主动管理不等于保本，永远不要投入超过你能承受损失的资金！从小额开始，慢慢积累信任。`,

  steps: [
    { step_number: 1, title: '理解主动管理机制', description: '学习 Sommelier 的策略调整和收益来源。', estimated_time: '15 分钟' },
    { step_number: 2, title: '选择合适的 Vault', description: '新手选 Real Yield USD，进阶选 Real Yield ETH。', estimated_time: '10 分钟' },
    { step_number: 3, title: '存入资金', description: '授权并存入资金到选定的 Vault。', estimated_time: '5 分钟' },
    { step_number: 4, title: '每月查看收益', description: '查看收益表现和策略调整历史。', estimated_time: '每月 10 分钟' },
    { step_number: 5, title: '季度再平衡', description: '根据表现调整 Vault 配置。', estimated_time: '每季度 20 分钟' },
  ],
};

// ===== 获取认证 Token =====
async function getAuthToken() {
  const response = await axios.post(`${DIRECTUS_URL}/auth/login`, {
    email: 'the_uk1@outlook.com',
    password: 'Mygcdjmyxzg2026!',
  });
  return response.data.data.access_token;
}

// ===== 主函数：创建策略 =====
async function createStrategies() {
  try {
    console.log('\\n开始创建 13.5 和 13.6 策略...\\n');

    const token = await getAuthToken();

    const strategies = [STRATEGY_13_5, STRATEGY_13_6];

    for (let i = 0; i < strategies.length; i++) {
      const strategy = {
        ...strategies[i],
        status: 'published',
        published_at: new Date().toISOString(),
        view_count: 0,
        bookmark_count: 0,
        is_featured: false,
      };

      const response = await axios.post(
        `${DIRECTUS_URL}/items/strategies`,
        strategy,
        {
          headers: {
            Authorization: `Bearer ${token}`,
          },
        }
      );

      console.log(`✅ [${i + 1}/2] ${strategy.title}`);
      console.log(`   ID: ${response.data.data.id}`);
      console.log(`   Slug: ${response.data.data.slug}\\n`);
    }

    console.log('🎉 创建完成！');
    console.log('访问: http://localhost:3000/strategies?category=vault\\n');
  } catch (error) {
    console.error('\\n❌ 创建失败:', error.response?.data || error.message);
  }
}

// 执行
createStrategies();
