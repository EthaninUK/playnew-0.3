services:
  chatwoot:
    build:
      context: .
      dockerfile: Dockerfile.chatwoot
    image: my-chatwoot:latest-patched
    # 千万不要绑定挂载 ./:/app 或 public:/app/public
    # volumes:
    #   - .:/app
    environment:
      - RAILS_ENV=production
      - NODE_ENV=production
      - FRONTEND_URL=http://localhost:3002
      - SECRET_KEY_BASE=chatwoot-secret-key-please-change-this-in-production-use-rails-secret-command

      # Database Configuration (Using Supabase PostgreSQL)
      - POSTGRES_HOST=aws-1-ap-northeast-1.pooler.supabase.com
      - POSTGRES_PORT=5432
      - POSTGRES_DATABASE=postgres
      - POSTGRES_USERNAME=postgres.cujpgrzjmmttysphjknu
      - POSTGRES_PASSWORD=bi3d8FpBFTUWuwOb

      # Redis Configuration
      - REDIS_URL=redis://host.docker.internal:6379
      - REDIS_PASSWORD=

      # Installation Configuration
      - INSTALLATION_NAME=PlayNew.ai
      - ENABLE_ACCOUNT_SIGNUP=false

      # Timezone
      - TZ=Asia/Shanghai
    depends_on:
      - redis
