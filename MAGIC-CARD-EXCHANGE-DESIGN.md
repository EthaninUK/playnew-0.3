# ç©æ³•äº¤æ¢é­”æ³•å¡ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ
## "ç¿»å¼€é­”æ³•å¡"æ¦‚å¿µ + æ¨å¹¿è£‚å˜æœºåˆ¶

---

## ä¸€ã€æ ¸å¿ƒè®¾è®¡ç†å¿µ

### 1.1 äº§å“å®šä½
**"ç©æ³•ç›²ç›’" + "æ¨å¹¿è£‚å˜" çš„æ¸¸æˆåŒ–äº¤æ¢ç³»ç»Ÿ**

```
ç”¨æˆ·æ—…ç¨‹:
æ³¨å†Œ â†’ è·å¾— 1 ç§¯åˆ† â†’ ç¿»å¼€é­”æ³•å¡(3 é€‰ 1)â†’ è§£é”ç©æ³•
     â†“
æƒ³è¦æ›´å¤šç©æ³• â†’ æ¨å¹¿å¥½å‹æ³¨å†Œ â†’ è·å¾—ç§¯åˆ† â†’ ç»§ç»­ç¿»å¡
     â†“
ä¸»åŠ¨æäº¤ç©æ³•éœ€æ±‚ â†’ å¹³å°æ”¶é›†éœ€æ±‚ â†’ åç»­æä¾›
```

### 1.2 æ ¸å¿ƒæœºåˆ¶

#### ç§¯åˆ†è·å–(å”¯ä¸€é€”å¾„)
```
âœ… æ³¨å†Œè´¦å·: +1 ç§¯åˆ†(é¦–æ¬¡)
âœ… æ¨å¹¿å¥½å‹: +1 ç§¯åˆ†/äºº(å¥½å‹å®Œæˆæ³¨å†Œ)
âŒ å…¶ä»–é€”å¾„: æ— (ä¿æŒç¨€ç¼ºæ€§)
```

#### ç©æ³•äº¤æ¢(é˜²åˆ·æœºåˆ¶)
```
âœ… ç¬¬ 1 æ¬¡ç¿»å¡: å›ºå®š 3 ä¸ªæ–°æ‰‹ç©æ³•ä¸­éšæœº 1 ä¸ª
âœ… ç¬¬ 2 æ¬¡åŠä»¥å: ä»å®Œæ•´ç©æ³•åº“ä¸­éšæœºæŠ½å–

ç›®çš„:
- é˜²æ­¢ç”¨æˆ·æ³¨å†Œå°å·åˆ·é«˜çº§ç©æ³•
- ä¿è¯æ–°äººéƒ½èƒ½è·å¾—åŸºç¡€ç©æ³•
- åˆ¶é€ "æŠ½å¡"çš„æœŸå¾…æ„Ÿ
```

---

## äºŒã€é¡µé¢è®¾è®¡æ–¹æ¡ˆ

### 2.1 é¡µé¢å¸ƒå±€(å•é¡µé¢è®¾è®¡)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Header]                               [æˆ‘çš„ç§¯åˆ†: 1 ğŸ’]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚              ğŸ´ ç©æ³•äº¤æ¢ - é­”æ³•å¡ç³»ç»Ÿ ğŸ´                  â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚           [é­”æ³•å¡ç¿»ç‰ŒåŒºåŸŸ] - æ ¸å¿ƒäº¤äº’                â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚   å½“å‰çŠ¶æ€: ä½ æœ‰ 1 æ¬¡ç¿»ç‰Œæœºä¼š(1 ç§¯åˆ†)                â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â”‚
â”‚ â”‚   â”‚         â”‚  â”‚         â”‚  â”‚         â”‚           â”‚ â”‚
â”‚ â”‚   â”‚   ï¼Ÿ    â”‚  â”‚   ï¼Ÿ    â”‚  â”‚   ï¼Ÿ    â”‚           â”‚ â”‚
â”‚ â”‚   â”‚         â”‚  â”‚         â”‚  â”‚         â”‚           â”‚ â”‚
â”‚ â”‚   â”‚  ç¥ç§˜å¡  â”‚  â”‚  ç¥ç§˜å¡  â”‚  â”‚  ç¥ç§˜å¡  â”‚           â”‚ â”‚
â”‚ â”‚   â”‚         â”‚  â”‚         â”‚  â”‚         â”‚           â”‚ â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚        [ç‚¹å‡»ä»»æ„ä¸€å¼ å¡ç‰‡å¼€å§‹ç¿»ç‰Œ]                    â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ğŸ’¡ æç¤º:                                            â”‚ â”‚
â”‚ â”‚  - é¦–æ¬¡ç¿»ç‰Œå°†ä» 3 ä¸ªæ–°æ‰‹ç©æ³•ä¸­éšæœºè·å¾— 1 ä¸ª          â”‚ â”‚
â”‚ â”‚  - ä¹‹åçš„ç¿»ç‰Œå°†ä»å®Œæ•´ç©æ³•åº“ä¸­éšæœºè·å¾—                â”‚ â”‚
â”‚ â”‚  - æƒ³è¦æ›´å¤šç§¯åˆ†?é‚€è¯·å¥½å‹æ³¨å†Œå³å¯!                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  ğŸ å¦‚ä½•è·å¾—æ›´å¤šç§¯åˆ†?                                â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  ğŸ“¢ é‚€è¯·å¥½å‹æ³¨å†Œ,æ¯æˆåŠŸ 1 äºº = 1 ç§¯åˆ†               â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  ä½ çš„é‚€è¯·é“¾æ¥:                                       â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚  â”‚ https://playnew.com/ref/abc123              â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ [å¤åˆ¶é“¾æ¥] [åˆ†äº«åˆ° Twitter] [åˆ†äº«åˆ° Telegram] â”‚   â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  å·²é‚€è¯·: 3 äºº | å¾…ç¡®è®¤: 1 äºº | è·å¾—ç§¯åˆ†: 3 ğŸ’        â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  ğŸ“ æƒ³è¦ç‰¹å®šçš„ç©æ³•?å‘Šè¯‰æˆ‘ä»¬!                         â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  æˆ‘æƒ³è¦çš„ç©æ³•ç±»å‹: [ä¸‹æ‹‰é€‰æ‹©]                        â”‚ â”‚
â”‚ â”‚  â–¡ ç©ºæŠ•ç©æ³•                                         â”‚ â”‚
â”‚ â”‚  â–¡ DeFi æŒ–çŸ¿                                        â”‚ â”‚
â”‚ â”‚  â–¡ å¥—åˆ©ç­–ç•¥                                         â”‚ â”‚
â”‚ â”‚  â–¡ NFT äº¤æ˜“                                         â”‚ â”‚
â”‚ â”‚  â–¡ å…¶ä»–: [æ–‡æœ¬æ¡†]                                   â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  å…·ä½“éœ€æ±‚æè¿°:                                       â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚  â”‚ ä¾‹å¦‚: æ±‚ LayerZero ç©ºæŠ•æœ€æ–°æ”»ç•¥...          â”‚   â”‚ â”‚
â”‚ â”‚  â”‚                                             â”‚   â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  [æäº¤éœ€æ±‚] (æäº¤åå¯è·å¾— 0.5 ç§¯åˆ†å¥–åŠ±)              â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ğŸ“š æˆ‘å·²è§£é”çš„ç©æ³• (3 ä¸ª)                            â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚ â”‚  â”‚ âœ… LayerZero ç©ºæŠ•å®Œå…¨æ”»ç•¥               â”‚        â”‚ â”‚
â”‚ â”‚  â”‚    è§£é”æ—¶é—´: 2025-01-13                â”‚        â”‚ â”‚
â”‚ â”‚  â”‚    [æŸ¥çœ‹è¯¦æƒ…]                          â”‚        â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚ â”‚  â”‚ âœ… Arbitrum ç”Ÿæ€æŒ–çŸ¿æŒ‡å—                â”‚        â”‚ â”‚
â”‚ â”‚  â”‚    è§£é”æ—¶é—´: 2025-01-12                â”‚        â”‚ â”‚
â”‚ â”‚  â”‚    [æŸ¥çœ‹è¯¦æƒ…]                          â”‚        â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚  [æŸ¥çœ‹å…¨éƒ¨ 3 ä¸ªç©æ³•]                                â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€äº¤äº’æµç¨‹è®¾è®¡

### 3.1 é¦–æ¬¡ç¿»å¡æµç¨‹(æ–°ç”¨æˆ·)

#### æ­¥éª¤ 1: ç”¨æˆ·è¿›å…¥é¡µé¢
```
æ˜¾ç¤º:
- å½“å‰ç§¯åˆ†: 1 ğŸ’
- 3 å¼ èƒŒé¢æœä¸Šçš„é­”æ³•å¡(ç¥ç§˜æ„Ÿ)
- æç¤ºæ–‡å­—: "ç‚¹å‡»ä»»æ„ä¸€å¼ å¡ç‰‡å¼€å§‹ç¿»ç‰Œ"
```

#### æ­¥éª¤ 2: ç‚¹å‡»å¡ç‰‡
```
åŠ¨ç”»æ•ˆæœ:
1. è¢«ç‚¹å‡»çš„å¡ç‰‡å¼€å§‹å‘å…‰(0.3s)
2. å¡ç‰‡ç¿»è½¬åŠ¨ç”»(0.5s)
   - ä½¿ç”¨ CSS 3D transform: rotateY(180deg)
   - ç¿»è½¬åˆ°ä¸€åŠæ—¶,èƒŒæ™¯å˜ä¸ºç™½è‰²
3. å¡ç‰‡æ­£é¢æ˜¾ç¤ºç©æ³•ä¿¡æ¯(æ¸å…¥æ•ˆæœ)

å¡ç‰‡æ­£é¢æ˜¾ç¤º:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ æ­å–œè·å¾—  â”‚
â”‚             â”‚
â”‚ LayerZero   â”‚
â”‚ ç©ºæŠ•å®Œå…¨æ”»ç•¥ â”‚
â”‚             â”‚
â”‚ ä»·å€¼: 500ğŸ’ â”‚
â”‚ éš¾åº¦: â­â­â­  â”‚
â”‚             â”‚
â”‚ [æŸ¥çœ‹è¯¦æƒ…]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ­¥éª¤ 3: æ‰£é™¤ç§¯åˆ†,è§£é”ç©æ³•
```
åç«¯æ“ä½œ:
1. æ‰£é™¤ç”¨æˆ· 1 ç§¯åˆ†(1 â†’ 0)
2. ä»"æ–°æ‰‹ç©æ³•æ± "éšæœºæŠ½å– 1 ä¸ª
3. åˆ›å»º play_pass è®°å½•
4. è®°å½•äº¤æ¢å†å²

å‰ç«¯æ˜¾ç¤º:
- é¡¶éƒ¨ç§¯åˆ†æ•°å˜åŒ–åŠ¨ç”»: 1 â†’ 0
- Toast æç¤º: "æ¶ˆè€— 1 ç§¯åˆ†,æˆåŠŸè§£é” LayerZero ç©ºæŠ•æ”»ç•¥"
- å¡ç‰‡ä¸‹æ–¹å‡ºç°"æŸ¥çœ‹è¯¦æƒ…"æŒ‰é’®
```

#### æ­¥éª¤ 4: å…¶ä»–ä¸¤å¼ å¡ç‰‡æ˜¾ç¤º
```
æœªé€‰ä¸­çš„ä¸¤å¼ å¡ç‰‡ä¹Ÿç¿»å¼€(æ…¢é€Ÿ,0.8s å»¶è¿Ÿ):
- æ˜¾ç¤º"æœªé€‰æ‹©"çŠ¶æ€(åŠé€æ˜,ç°è‰²)
- æ˜¾ç¤ºå¡ç‰‡å†…å®¹(è®©ç”¨æˆ·çœ‹åˆ°"é”™è¿‡äº†ä»€ä¹ˆ")

ç›®çš„:
- åˆ¶é€ "é€‰æ‹©çš„ç´§å¼ æ„Ÿ"
- æ¿€å‘"ä¸‹æ¬¡è¦é€‰å¯¹"çš„å¿ƒç†
```

---

### 3.2 ç¬¬äºŒæ¬¡åŠä»¥åç¿»å¡æµç¨‹

#### æ­¥éª¤ 1: è·å¾—ç§¯åˆ†(é€šè¿‡é‚€è¯·)
```
ç”¨æˆ· A é‚€è¯·ç”¨æˆ· B æ³¨å†Œ:
  â†“
ç”¨æˆ· B å®Œæˆæ³¨å†Œ
  â†“
ç³»ç»Ÿè‡ªåŠ¨ç»™ç”¨æˆ· A +1 ç§¯åˆ†
  â†“
æ¨é€é€šçŸ¥: "æ­å–œ!ä½ çš„å¥½å‹ [ç”¨æˆ· B] å®Œæˆæ³¨å†Œ,ä½ è·å¾— 1 ç§¯åˆ†"
```

#### æ­¥éª¤ 2: è¿›å…¥ç¿»å¡é¡µé¢
```
æ˜¾ç¤ºå˜åŒ–:
- æç¤ºæ–‡å­—å˜ä¸º: "ä»å®Œæ•´ç©æ³•åº“ä¸­éšæœºæŠ½å– 1 ä¸ª"
- 3 å¼ å¡ç‰‡ä¾ç„¶æ˜¯èƒŒé¢æœä¸Š
- å¡ç‰‡èƒŒé¢å¯èƒ½æœ‰ä¸åŒçš„ç­‰çº§æ ‡è¯†(æ™®é€š/ç¨€æœ‰/å²è¯—)
```

#### æ­¥éª¤ 3: ç¿»å¡é€»è¾‘
```
åç«¯éšæœºç®—æ³•:
- 70% æ¦‚ç‡: æ™®é€šç©æ³•(ä»·å€¼ 100-300 ç§¯åˆ†)
- 25% æ¦‚ç‡: ç¨€æœ‰ç©æ³•(ä»·å€¼ 300-500 ç§¯åˆ†)
- 5% æ¦‚ç‡: å²è¯—ç©æ³•(ä»·å€¼ 500-1000 ç§¯åˆ†)

å‰ç«¯æ˜¾ç¤º:
- å¡ç‰‡é¢œè‰²åŒºåˆ†:
  - æ™®é€š: è“è‰²è¾¹æ¡†
  - ç¨€æœ‰: ç´«è‰²è¾¹æ¡† + å…‰æ•ˆ
  - å²è¯—: é‡‘è‰²è¾¹æ¡† + ç²’å­ç‰¹æ•ˆ
```

---

### 3.3 è§†è§‰åŠ¨ç”»æ•ˆæœç»†èŠ‚

#### å¡ç‰‡ç¿»è½¬åŠ¨ç”»(æ ¸å¿ƒ)
```css
/* å¡ç‰‡å®¹å™¨ */
.magic-card {
  width: 200px;
  height: 300px;
  perspective: 1000px;
  cursor: pointer;
  position: relative;
}

/* å¡ç‰‡å†…å±‚ */
.card-inner {
  width: 100%;
  height: 100%;
  transition: transform 0.6s;
  transform-style: preserve-3d;
  position: relative;
}

/* ç¿»è½¬æ•ˆæœ */
.magic-card.flipped .card-inner {
  transform: rotateY(180deg);
}

/* å¡ç‰‡æ­£é¢å’ŒèƒŒé¢ */
.card-front, .card-back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border-radius: 12px;
  box-shadow: 0 8px 16px rgba(0,0,0,0.2);
}

/* èƒŒé¢(åˆå§‹çŠ¶æ€) */
.card-back {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  display: flex;
  align-items: center;
  justify-content: center;
}

/* æ­£é¢(ç¿»è½¬å) */
.card-front {
  background: white;
  transform: rotateY(180deg);
  padding: 20px;
}

/* æ‚¬åœæ•ˆæœ */
.magic-card:hover:not(.flipped) {
  transform: translateY(-10px);
  transition: transform 0.3s;
}

.magic-card:hover:not(.flipped) .card-back {
  box-shadow: 0 12px 24px rgba(102, 126, 234, 0.4);
}
```

#### ç¿»å¡æ—¶çš„ç²’å­æ•ˆæœ
```javascript
// ä½¿ç”¨ Canvas æˆ– CSS åŠ¨ç”»å®ç°ç²’å­çˆ†ç‚¸æ•ˆæœ
function createParticles(cardElement) {
  for (let i = 0; i < 20; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.left = `${Math.random() * 100}%`;
    particle.style.top = `${Math.random() * 100}%`;
    cardElement.appendChild(particle);

    // ç²’å­é£å‡ºåŠ¨ç”»
    setTimeout(() => particle.remove(), 1000);
  }
}
```

#### ç¨€æœ‰åº¦å…‰æ•ˆ
```css
/* æ™®é€šå¡ç‰‡ */
.card-rarity-common {
  border: 2px solid #3b82f6;
}

/* ç¨€æœ‰å¡ç‰‡(ç´«è‰²å…‰æ™•) */
.card-rarity-rare {
  border: 2px solid #a855f7;
  box-shadow: 0 0 20px rgba(168, 85, 247, 0.6);
  animation: pulse-rare 2s infinite;
}

@keyframes pulse-rare {
  0%, 100% { box-shadow: 0 0 20px rgba(168, 85, 247, 0.6); }
  50% { box-shadow: 0 0 30px rgba(168, 85, 247, 0.9); }
}

/* å²è¯—å¡ç‰‡(é‡‘è‰²å…‰æ™• + æ—‹è½¬å…‰æŸ) */
.card-rarity-epic {
  border: 2px solid #f59e0b;
  box-shadow: 0 0 30px rgba(245, 158, 11, 0.8);
  animation: pulse-epic 1.5s infinite;
  position: relative;
  overflow: hidden;
}

@keyframes pulse-epic {
  0%, 100% { box-shadow: 0 0 30px rgba(245, 158, 11, 0.8); }
  50% { box-shadow: 0 0 50px rgba(245, 158, 11, 1); }
}

/* å²è¯—å¡ç‰‡çš„æ—‹è½¬å…‰æŸèƒŒæ™¯ */
.card-rarity-epic::before {
  content: '';
  position: absolute;
  width: 200%;
  height: 200%;
  background: linear-gradient(
    45deg,
    transparent 30%,
    rgba(255, 215, 0, 0.3) 50%,
    transparent 70%
  );
  animation: rotate-beam 3s linear infinite;
}

@keyframes rotate-beam {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
```

---

## å››ã€æ•°æ®åº“è®¾è®¡

### 4.1 æ–°å¢è¡¨ç»“æ„

```sql
-- 1. ç”¨æˆ·ç§¯åˆ†è¡¨(æ‰©å±•ç°æœ‰ user_credits)
ALTER TABLE user_credits ADD COLUMN IF NOT EXISTS referral_code VARCHAR(20) UNIQUE;
ALTER TABLE user_credits ADD COLUMN IF NOT EXISTS referred_by_user_id UUID;
ALTER TABLE user_credits ADD COLUMN IF NOT EXISTS referral_count INT DEFAULT 0;

COMMENT ON COLUMN user_credits.referral_code IS 'ç”¨æˆ·çš„é‚€è¯·ç ';
COMMENT ON COLUMN user_credits.referred_by_user_id IS 'æ¨èäºº ID';
COMMENT ON COLUMN user_credits.referral_count IS 'æˆåŠŸæ¨èçš„äººæ•°';

-- 2. ç©æ³•äº¤æ¢è®°å½•è¡¨
CREATE TABLE magic_card_exchanges (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES auth.users(id),

  -- æŠ½å¡ä¿¡æ¯
  play_id UUID NOT NULL, -- æŠ½åˆ°çš„ç©æ³•
  exchange_type VARCHAR(20) NOT NULL, -- 'first_draw' | 'regular_draw'
  rarity VARCHAR(20), -- 'common' | 'rare' | 'epic'

  -- å¡æ± ä¿¡æ¯(è®°å½•å½“æ—¶å±•ç¤ºçš„ 3 å¼ å¡)
  card_pool JSONB, -- [{play_id, title, rarity}, ...]
  selected_index INT, -- ç”¨æˆ·é€‰æ‹©äº†ç¬¬å‡ å¼ å¡(0-2)

  -- ç§¯åˆ†æ¶ˆè€—
  credits_spent INT DEFAULT 1,

  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_magic_exchange_user ON magic_card_exchanges(user_id);
CREATE INDEX idx_magic_exchange_created ON magic_card_exchanges(created_at DESC);

-- 3. ç©æ³•éœ€æ±‚è¡¨
CREATE TABLE play_requests (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES auth.users(id),

  -- éœ€æ±‚ä¿¡æ¯
  category VARCHAR(50), -- 'airdrop' | 'defi' | 'arbitrage' | 'nft' | 'other'
  description TEXT NOT NULL,

  -- çŠ¶æ€
  status VARCHAR(20) DEFAULT 'pending', -- 'pending' | 'fulfilled' | 'rejected'
  fulfilled_play_id UUID, -- å¦‚æœéœ€æ±‚è¢«æ»¡è¶³,å¯¹åº”çš„ç©æ³• ID

  -- å¥–åŠ±
  reward_credits INT DEFAULT 0, -- æäº¤éœ€æ±‚è·å¾—çš„ç§¯åˆ†å¥–åŠ±(å¦‚ 0.5)

  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_play_requests_user ON play_requests(user_id);
CREATE INDEX idx_play_requests_status ON play_requests(status);

-- 4. æ–°æ‰‹ç©æ³•æ± é…ç½®è¡¨
CREATE TABLE starter_play_pool (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  play_id UUID NOT NULL REFERENCES strategies(id),
  is_active BOOLEAN DEFAULT TRUE,
  weight INT DEFAULT 1, -- æƒé‡(ç”¨äºéšæœºæŠ½å–æ¦‚ç‡)
  order_index INT DEFAULT 0,

  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_starter_pool_active ON starter_play_pool(is_active);

COMMENT ON TABLE starter_play_pool IS 'æ–°æ‰‹ç©æ³•æ± (é¦–æ¬¡æŠ½å¡å›ºå®šä»è¿™é‡ŒæŠ½)';
```

---

### 4.2 åˆå§‹åŒ–æ•°æ®

```sql
-- æ’å…¥ 3 ä¸ªæ–°æ‰‹ç©æ³•åˆ°æ–°æ‰‹æ± 
-- (éœ€è¦å…ˆåœ¨ strategies è¡¨ä¸­æœ‰è¿™äº›ç©æ³•)

-- å‡è®¾å·²æœ‰ç©æ³• ID ä¸º play_1, play_2, play_3
INSERT INTO starter_play_pool (play_id, weight, order_index)
VALUES
  ('play_id_1', 1, 1), -- LayerZero ç©ºæŠ•æ”»ç•¥
  ('play_id_2', 1, 2), -- zkSync æµ‹è¯•ç½‘ä»»åŠ¡
  ('play_id_3', 1, 3); -- Arbitrum ç”Ÿæ€æŒ–çŸ¿
```

---

## äº”ã€API è®¾è®¡

### 5.1 æ ¸å¿ƒæ¥å£

#### 1. GET /api/magic-card/status
è·å–ç”¨æˆ·å½“å‰çŠ¶æ€

**Response:**
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "uuid",
      "credits": 1,
      "referral_code": "ABC123",
      "referral_count": 3,
      "total_exchanges": 1,
      "is_first_draw": true
    },
    "cards_available": true,
    "next_draw_type": "first_draw" // or "regular_draw"
  }
}
```

---

#### 2. POST /api/magic-card/draw
æ‰§è¡ŒæŠ½å¡

**Request:**
```json
{
  "selected_index": 0 // ç”¨æˆ·é€‰æ‹©çš„å¡ç‰‡ç´¢å¼•(0-2)
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "exchange_id": "uuid",

    "card_pool": [
      {
        "index": 0,
        "play_id": "uuid-a",
        "title": "LayerZero ç©ºæŠ•æ”»ç•¥",
        "category": "airdrop",
        "rarity": "common",
        "value": 500,
        "is_selected": true
      },
      {
        "index": 1,
        "play_id": "uuid-b",
        "title": "zkSync æµ‹è¯•ç½‘ä»»åŠ¡",
        "category": "airdrop",
        "rarity": "common",
        "value": 300,
        "is_selected": false
      },
      {
        "index": 2,
        "play_id": "uuid-c",
        "title": "Arbitrum æŒ–çŸ¿æŒ‡å—",
        "category": "defi",
        "rarity": "rare",
        "value": 800,
        "is_selected": false
      }
    ],

    "selected_play": {
      "play_id": "uuid-a",
      "title": "LayerZero ç©ºæŠ•æ”»ç•¥",
      "slug": "layerzero-airdrop-guide",
      "category": "airdrop",
      "rarity": "common",
      "summary": "å®Œæ•´çš„ LayerZero ç©ºæŠ•æ”»ç•¥...",
      "value": 500
    },

    "credits_remaining": 0,
    "message": "æ­å–œ!æ¶ˆè€— 1 ç§¯åˆ†,æˆåŠŸè§£é” LayerZero ç©ºæŠ•æ”»ç•¥"
  }
}
```

**Error Response (ç§¯åˆ†ä¸è¶³):**
```json
{
  "success": false,
  "error": {
    "code": "INSUFFICIENT_CREDITS",
    "message": "ç§¯åˆ†ä¸è¶³,éœ€è¦ 1 ç§¯åˆ†",
    "current_credits": 0,
    "required_credits": 1,
    "suggestion": "é‚€è¯·å¥½å‹æ³¨å†Œå¯è·å¾—ç§¯åˆ†"
  }
}
```

---

#### 3. GET /api/magic-card/my-plays
æŸ¥çœ‹å·²è§£é”çš„ç©æ³•

**Response:**
```json
{
  "success": true,
  "data": {
    "total_count": 3,
    "plays": [
      {
        "play_id": "uuid",
        "title": "LayerZero ç©ºæŠ•æ”»ç•¥",
        "slug": "layerzero-airdrop-guide",
        "category": "airdrop",
        "rarity": "common",
        "unlocked_at": "2025-01-13T10:30:00Z",
        "exchange_type": "first_draw"
      },
      {
        "play_id": "uuid",
        "title": "Uniswap V4 ç­–ç•¥",
        "category": "defi",
        "rarity": "rare",
        "unlocked_at": "2025-01-12T15:20:00Z",
        "exchange_type": "regular_draw"
      }
    ]
  }
}
```

---

#### 4. POST /api/referral/generate-code
ç”Ÿæˆé‚€è¯·ç (å¦‚æœç”¨æˆ·è¿˜æ²¡æœ‰)

**Response:**
```json
{
  "success": true,
  "data": {
    "referral_code": "ABC123",
    "referral_url": "https://playnew.com/ref/ABC123"
  }
}
```

---

#### 5. GET /api/referral/stats
æŸ¥çœ‹æ¨å¹¿ç»Ÿè®¡

**Response:**
```json
{
  "success": true,
  "data": {
    "referral_code": "ABC123",
    "referral_url": "https://playnew.com/ref/ABC123",
    "total_referrals": 5,
    "pending_referrals": 1,
    "confirmed_referrals": 4,
    "earned_credits": 4,
    "referral_list": [
      {
        "user_id": "uuid",
        "username": "user***",
        "status": "confirmed",
        "registered_at": "2025-01-10T12:00:00Z",
        "credits_earned": 1
      }
    ]
  }
}
```

---

#### 6. POST /api/play-request/submit
æäº¤ç©æ³•éœ€æ±‚

**Request:**
```json
{
  "category": "airdrop",
  "description": "æ±‚ LayerZero æœ€æ–°ç©ºæŠ•æ”»ç•¥,åŒ…æ‹¬è·¨é“¾æ¡¥äº¤äº’ç­–ç•¥"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "request_id": "uuid",
    "reward_credits": 0.5,
    "current_credits": 0.5,
    "message": "éœ€æ±‚å·²æäº¤,è·å¾— 0.5 ç§¯åˆ†å¥–åŠ±!æˆ‘ä»¬ä¼šå°½å¿«å¤„ç†ä½ çš„éœ€æ±‚"
  }
}
```

---

## å…­ã€æŠ½å¡ç®—æ³•è®¾è®¡

### 6.1 é¦–æ¬¡æŠ½å¡(æ–°æ‰‹æ± )

```javascript
// åç«¯é€»è¾‘
async function drawFirstCard(userId) {
  // 1. æ£€æŸ¥æ˜¯å¦é¦–æ¬¡æŠ½å¡
  const exchangeCount = await getExchangeCount(userId);
  if (exchangeCount > 0) {
    throw new Error('ä¸æ˜¯é¦–æ¬¡æŠ½å¡,æ— æ³•ä½¿ç”¨æ–°æ‰‹æ± ');
  }

  // 2. ä»æ–°æ‰‹æ± ä¸­éšæœºè·å– 3 ä¸ªç©æ³•
  const starterPlays = await getStarterPlayPool();

  if (starterPlays.length < 3) {
    throw new Error('æ–°æ‰‹æ± ç©æ³•ä¸è¶³ 3 ä¸ª');
  }

  // éšæœºæ‰“ä¹±é¡ºåº
  const shuffled = starterPlays.sort(() => Math.random() - 0.5);
  const cardPool = shuffled.slice(0, 3);

  // 3. è¿”å›å¡æ± 
  return cardPool.map((play, index) => ({
    index,
    play_id: play.id,
    title: play.title,
    category: play.category,
    rarity: 'common', // æ–°æ‰‹ç©æ³•éƒ½æ˜¯æ™®é€šç­‰çº§
    value: play.credits_price || 500
  }));
}
```

---

### 6.2 å¸¸è§„æŠ½å¡(å®Œæ•´æ± )

```javascript
// ç¨€æœ‰åº¦æƒé‡é…ç½®
const RARITY_WEIGHTS = {
  common: 70,  // 70% æ¦‚ç‡
  rare: 25,    // 25% æ¦‚ç‡
  epic: 5      // 5% æ¦‚ç‡
};

// ç¨€æœ‰åº¦å¯¹åº”çš„ç©æ³•ç­›é€‰æ¡ä»¶
const RARITY_CRITERIA = {
  common: { min_value: 0, max_value: 300 },
  rare: { min_value: 300, max_value: 500 },
  epic: { min_value: 500, max_value: 9999 }
};

async function drawRegularCard(userId) {
  // 1. ä¸º 3 å¼ å¡åˆ†åˆ«éšæœºç¨€æœ‰åº¦
  const card1Rarity = getRandomRarity();
  const card2Rarity = getRandomRarity();
  const card3Rarity = getRandomRarity();

  // 2. æ ¹æ®ç¨€æœ‰åº¦ä»å¯¹åº”æ± ä¸­æŠ½å–ç©æ³•
  const card1 = await getPlayByRarity(card1Rarity, userId);
  const card2 = await getPlayByRarity(card2Rarity, userId);
  const card3 = await getPlayByRarity(card3Rarity, userId);

  // 3. ç¡®ä¿ä¸é‡å¤
  const uniqueCards = ensureUnique([card1, card2, card3]);

  // 4. è¿”å›å¡æ± 
  return uniqueCards.map((play, index) => ({
    index,
    play_id: play.id,
    title: play.title,
    category: play.category,
    rarity: play.rarity,
    value: play.credits_price || 500
  }));
}

// éšæœºç¨€æœ‰åº¦(åŸºäºæƒé‡)
function getRandomRarity() {
  const rand = Math.random() * 100;

  if (rand < RARITY_WEIGHTS.common) {
    return 'common';
  } else if (rand < RARITY_WEIGHTS.common + RARITY_WEIGHTS.rare) {
    return 'rare';
  } else {
    return 'epic';
  }
}

// æ ¹æ®ç¨€æœ‰åº¦è·å–ç©æ³•(æ’é™¤ç”¨æˆ·å·²æ‹¥æœ‰çš„)
async function getPlayByRarity(rarity, userId) {
  const criteria = RARITY_CRITERIA[rarity];

  const plays = await db.query(`
    SELECT s.*
    FROM strategies s
    WHERE s.status = 'published'
      AND s.is_purchasable = TRUE
      AND s.credits_price >= $1
      AND s.credits_price < $2
      AND NOT EXISTS (
        SELECT 1 FROM play_passes pp
        WHERE pp.play_id = s.id
          AND pp.owner_id = $3
          AND pp.status = 'active'
      )
    ORDER BY RANDOM()
    LIMIT 1
  `, [criteria.min_value, criteria.max_value, userId]);

  if (plays.length === 0) {
    // å¦‚æœè¯¥ç¨€æœ‰åº¦æ± ä¸­æ²¡æœ‰æœªæ‹¥æœ‰çš„ç©æ³•,é™çº§åˆ° common
    return await getPlayByRarity('common', userId);
  }

  return {
    ...plays[0],
    rarity
  };
}
```

---

## ä¸ƒã€æ¨å¹¿è£‚å˜æœºåˆ¶

### 7.1 é‚€è¯·ç ç”Ÿæˆ

```javascript
// ç”Ÿæˆå”¯ä¸€é‚€è¯·ç 
function generateReferralCode(userId) {
  // æ–¹æ³• 1: åŸºäº user_id çš„çŸ­ç 
  const shortId = userId.substring(0, 8).toUpperCase();

  // æ–¹æ³• 2: éšæœºå­—ç¬¦ä¸²(æ›´å®‰å…¨)
  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // æ’é™¤æ˜“æ··æ·†å­—ç¬¦
  let code = '';
  for (let i = 0; i < 6; i++) {
    code += chars[Math.floor(Math.random() * chars.length)];
  }

  return code;
}

// æ£€æŸ¥é‚€è¯·ç å”¯ä¸€æ€§
async function ensureUniqueReferralCode(code) {
  const existing = await db.query(
    'SELECT 1 FROM user_credits WHERE referral_code = $1',
    [code]
  );

  if (existing.length > 0) {
    // å¦‚æœå†²çª,é‡æ–°ç”Ÿæˆ
    return ensureUniqueReferralCode(generateReferralCode());
  }

  return code;
}
```

---

### 7.2 æ³¨å†Œæµç¨‹(å¸¦é‚€è¯·ç )

```javascript
// æ³¨å†Œæ—¶å¤„ç†é‚€è¯·ç 
async function registerUser(email, password, referralCode) {
  // 1. åˆ›å»ºç”¨æˆ·è´¦å·
  const newUser = await createUser(email, password);

  // 2. åˆå§‹åŒ–ç§¯åˆ†(æ³¨å†Œé€ 1 ç§¯åˆ†)
  await db.query(`
    INSERT INTO user_credits (user_id, balance, referred_by_user_id)
    VALUES ($1, 1, $2)
  `, [newUser.id, null]);

  // 3. å¦‚æœæœ‰é‚€è¯·ç ,å¤„ç†æ¨èäººå¥–åŠ±
  if (referralCode) {
    const referrer = await db.query(
      'SELECT user_id FROM user_credits WHERE referral_code = $1',
      [referralCode]
    );

    if (referrer.length > 0) {
      const referrerId = referrer[0].user_id;

      // ç»™æ¨èäºº +1 ç§¯åˆ†
      await db.query(`
        UPDATE user_credits
        SET balance = balance + 1,
            referral_count = referral_count + 1
        WHERE user_id = $1
      `, [referrerId]);

      // è®°å½•ç§¯åˆ†äº¤æ˜“
      await recordCreditTransaction({
        user_id: referrerId,
        credits_change: 1,
        transaction_type: 'referral_reward',
        description: `æ¨èç”¨æˆ· ${email} æ³¨å†Œ`,
        related_id: newUser.id,
        related_type: 'user'
      });

      // æ›´æ–°æ–°ç”¨æˆ·çš„æ¨èäºº
      await db.query(`
        UPDATE user_credits
        SET referred_by_user_id = $1
        WHERE user_id = $2
      `, [referrerId, newUser.id]);

      // å‘é€é€šçŸ¥ç»™æ¨èäºº
      await sendNotification(referrerId, {
        type: 'referral_success',
        message: `æ­å–œ!ä½ çš„å¥½å‹ ${email} å®Œæˆæ³¨å†Œ,ä½ è·å¾— 1 ç§¯åˆ†`
      });
    }
  }

  return newUser;
}
```

---

## å…«ã€å‰ç«¯ç»„ä»¶è®¾è®¡

### 8.1 æ ¸å¿ƒç»„ä»¶ç»“æ„

```typescript
// components/magic-card/MagicCardExchange.tsx

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

interface Card {
  index: number;
  play_id: string;
  title: string;
  category: string;
  rarity: 'common' | 'rare' | 'epic';
  value: number;
  is_selected?: boolean;
}

export function MagicCardExchange() {
  const [credits, setCredits] = useState(1);
  const [cardPool, setCardPool] = useState<Card[]>([]);
  const [selectedIndex, setSelectedIndex] = useState<number | null>(null);
  const [isFlipping, setIsFlipping] = useState(false);
  const [flippedCards, setFlippedCards] = useState<boolean[]>([false, false, false]);

  // å¤„ç†å¡ç‰‡ç‚¹å‡»
  const handleCardClick = async (index: number) => {
    if (isFlipping || credits < 1) return;

    setIsFlipping(true);
    setSelectedIndex(index);

    try {
      // è°ƒç”¨æŠ½å¡ API
      const response = await fetch('/api/magic-card/draw', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ selected_index: index })
      });

      const data = await response.json();

      if (data.success) {
        setCardPool(data.data.card_pool);
        setCredits(data.data.credits_remaining);

        // å»¶è¿Ÿç¿»å¼€æ‰€é€‰å¡ç‰‡
        setTimeout(() => {
          const newFlipped = [false, false, false];
          newFlipped[index] = true;
          setFlippedCards(newFlipped);

          // å†å»¶è¿Ÿç¿»å¼€å…¶ä»–å¡ç‰‡
          setTimeout(() => {
            setFlippedCards([true, true, true]);
          }, 800);
        }, 300);

        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        toast.success(data.data.message);
      }
    } catch (error) {
      toast.error('æŠ½å¡å¤±è´¥,è¯·é‡è¯•');
    } finally {
      setIsFlipping(false);
    }
  };

  return (
    <div className="magic-card-exchange">
      {/* é¡¶éƒ¨ç§¯åˆ†æ˜¾ç¤º */}
      <div className="credits-display">
        æˆ‘çš„ç§¯åˆ†: <span className="credits-count">{credits}</span> ğŸ’
      </div>

      {/* å¡ç‰‡åŒºåŸŸ */}
      <div className="cards-container">
        {[0, 1, 2].map((index) => (
          <MagicCard
            key={index}
            index={index}
            card={cardPool[index]}
            isFlipped={flippedCards[index]}
            isSelected={selectedIndex === index}
            onClick={() => handleCardClick(index)}
            disabled={isFlipping || credits < 1}
          />
        ))}
      </div>

      {/* é‚€è¯·åŒºåŸŸ */}
      <ReferralSection />

      {/* éœ€æ±‚æäº¤åŒºåŸŸ */}
      <PlayRequestSection />

      {/* å·²è§£é”ç©æ³•åˆ—è¡¨ */}
      <UnlockedPlaysList />
    </div>
  );
}
```

---

### 8.2 å•ä¸ªé­”æ³•å¡ç»„ä»¶

```typescript
// components/magic-card/MagicCard.tsx

import { motion } from 'framer-motion';
import clsx from 'clsx';

interface MagicCardProps {
  index: number;
  card?: Card;
  isFlipped: boolean;
  isSelected: boolean;
  onClick: () => void;
  disabled: boolean;
}

export function MagicCard({
  index,
  card,
  isFlipped,
  isSelected,
  onClick,
  disabled
}: MagicCardProps) {
  return (
    <motion.div
      className={clsx('magic-card', {
        'flipped': isFlipped,
        'selected': isSelected,
        'disabled': disabled
      })}
      whileHover={!disabled && !isFlipped ? { y: -10 } : {}}
      onClick={onClick}
    >
      <motion.div
        className="card-inner"
        animate={{ rotateY: isFlipped ? 180 : 0 }}
        transition={{ duration: 0.6 }}
      >
        {/* å¡ç‰‡èƒŒé¢ */}
        <div className="card-back">
          <div className="card-back-pattern">
            <div className="mystery-symbol">?</div>
            <div className="card-text">ç¥ç§˜å¡</div>
          </div>
        </div>

        {/* å¡ç‰‡æ­£é¢ */}
        <div className={clsx('card-front', `rarity-${card?.rarity}`)}>
          {card && (
            <>
              <div className="card-header">
                <span className="rarity-badge">{getRarityLabel(card.rarity)}</span>
              </div>

              <div className="card-content">
                <h3 className="card-title">{card.title}</h3>
                <div className="card-category">{getCategoryLabel(card.category)}</div>
                <div className="card-value">ä»·å€¼: {card.value} ğŸ’</div>
              </div>

              {isSelected && (
                <div className="card-footer">
                  <motion.button
                    className="btn-view-details"
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ delay: 1 }}
                  >
                    æŸ¥çœ‹è¯¦æƒ…
                  </motion.button>
                </div>
              )}

              {!isSelected && isFlipped && (
                <div className="card-overlay">
                  <span className="not-selected-label">æœªé€‰æ‹©</span>
                </div>
              )}
            </>
          )}
        </div>
      </motion.div>

      {/* ç²’å­æ•ˆæœ(ç¿»å¡æ—¶) */}
      {isFlipped && isSelected && <ParticleEffect />}
    </motion.div>
  );
}

function getRarityLabel(rarity: string) {
  const labels = {
    common: 'æ™®é€š',
    rare: 'ç¨€æœ‰',
    epic: 'å²è¯—'
  };
  return labels[rarity] || 'æœªçŸ¥';
}

function getCategoryLabel(category: string) {
  const labels = {
    airdrop: 'ç©ºæŠ•',
    defi: 'DeFi',
    arbitrage: 'å¥—åˆ©',
    nft: 'NFT'
  };
  return labels[category] || category;
}
```

---

## ä¹ã€å®æ–½è®¡åˆ’

### ç¬¬ 1 æ­¥: æ•°æ®åº“å‡†å¤‡(1 å¤©)
- [ ] æ‰§è¡Œæ•°æ®åº“è¿ç§»è„šæœ¬
- [ ] åœ¨ strategies è¡¨ä¸­æ ‡è®° 3 ä¸ªæ–°æ‰‹ç©æ³•
- [ ] æ’å…¥åˆ° starter_play_pool è¡¨
- [ ] ä¸ºç°æœ‰ç”¨æˆ·ç”Ÿæˆé‚€è¯·ç 

### ç¬¬ 2 æ­¥: åç«¯ API å¼€å‘(2 å¤©)
- [ ] å®ç° 6 ä¸ªæ ¸å¿ƒ API æ¥å£
- [ ] å®ç°æŠ½å¡ç®—æ³•(é¦–æ¬¡ + å¸¸è§„)
- [ ] å®ç°é‚€è¯·ç é€»è¾‘
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•

### ç¬¬ 3 æ­¥: å‰ç«¯ç»„ä»¶å¼€å‘(3 å¤©)
- [ ] å®ç° MagicCard ç»„ä»¶(å«ç¿»è½¬åŠ¨ç”»)
- [ ] å®ç° MagicCardExchange ä¸»é¡µé¢
- [ ] å®ç° ReferralSection(é‚€è¯·åŒºåŸŸ)
- [ ] å®ç° PlayRequestSection(éœ€æ±‚æäº¤)
- [ ] å®ç° UnlockedPlaysList(å·²è§£é”åˆ—è¡¨)

### ç¬¬ 4 æ­¥: è§†è§‰æ•ˆæœä¼˜åŒ–(1 å¤©)
- [ ] å¡ç‰‡ç¿»è½¬åŠ¨ç”»ä¼˜åŒ–
- [ ] ç²’å­æ•ˆæœå®ç°
- [ ] ç¨€æœ‰åº¦å…‰æ•ˆå®ç°
- [ ] å“åº”å¼è®¾è®¡

### ç¬¬ 5 æ­¥: æµ‹è¯•ä¸ä¸Šçº¿(1 å¤©)
- [ ] å®Œæ•´æµç¨‹æµ‹è¯•
- [ ] é‚€è¯·ç æµ‹è¯•
- [ ] æŠ½å¡æ¦‚ç‡æµ‹è¯•
- [ ] éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

**æ€»è®¡**: 8 å¤©

---

## åã€å…³é”®ä¼˜åŠ¿

### 10.1 è§£å†³å†·å¯åŠ¨é—®é¢˜
```
âœ… æ–°ç”¨æˆ·æ³¨å†Œå³å¯ä½“éªŒ(1 ç§¯åˆ†å…è´¹)
âœ… æ¨å¹¿æœºåˆ¶è‡ªå¸¦è£‚å˜å±æ€§(é‚€è¯·å¥½å‹è·ç§¯åˆ†)
âœ… é˜²åˆ·æœºåˆ¶(é¦–æ¬¡å›ºå®š 3 é€‰ 1,é˜²æ­¢å°å·åˆ·é«˜çº§ç©æ³•)
```

### 10.2 æ¸¸æˆåŒ–ä½“éªŒ
```
âœ… "å¼€ç›²ç›’"çš„æœŸå¾…æ„Ÿ(ä¸çŸ¥é“ä¼šæŠ½åˆ°ä»€ä¹ˆ)
âœ… "ç¨€æœ‰åº¦"çš„æ”¶é›†æ¬²(æƒ³æŠ½åˆ°å²è¯—å¡)
âœ… "é€‰æ‹©çš„ç´§å¼ æ„Ÿ"(3 é€‰ 1,æ€•é€‰é”™)
```

### 10.3 æ•°æ®é©±åŠ¨ä¼˜åŒ–
```
âœ… è®°å½•æ‰€æœ‰æŠ½å¡æ•°æ®(å“ªäº›ç©æ³•æœ€å—æ¬¢è¿)
âœ… è®°å½•ç”¨æˆ·éœ€æ±‚(çŸ¥é“ç”¨æˆ·æƒ³è¦ä»€ä¹ˆ)
âœ… æ¨å¹¿æ•°æ®å¯è¿½è¸ª(å“ªäº›ç”¨æˆ·å¸¦æ¥äº†æ–°ç”¨æˆ·)
```

---

## æ€»ç»“

è¿™ä¸ªè®¾è®¡æ–¹æ¡ˆ:
1. âœ… **ç®€å•æ˜“æ‡‚**:ç”¨æˆ·ä¸€çœ‹å°±æ˜ç™½æ€ä¹ˆç©
2. âœ… **è‡ªå¸¦è£‚å˜**:æ¨å¹¿æœºåˆ¶å¤©ç„¶å¸¦æµé‡
3. âœ… **é˜²åˆ·æœºåˆ¶**:é¦–æ¬¡å›ºå®šæ± ,é˜²æ­¢è–…ç¾Šæ¯›
4. âœ… **è§†è§‰å¸å¼•**:é­”æ³•å¡ç¿»è½¬,æ¸¸æˆåŒ–ä½“éªŒ
5. âœ… **æ•°æ®é—­ç¯**:æ”¶é›†ç”¨æˆ·éœ€æ±‚,ä¼˜åŒ–å†…å®¹

**ä¸‹ä¸€æ­¥**:
- æˆ‘å¸®ä½ å¼€å§‹æ•°æ®åº“å¼€å‘?
- è¿˜æ˜¯å…ˆåšä¸ªå‰ç«¯åŸå‹è®©ä½ çœ‹çœ‹æ•ˆæœ?
- æˆ–è€…ä½ è¿˜æƒ³è°ƒæ•´å“ªäº›ç»†èŠ‚?

ä½ è§‰å¾—æ€ä¹ˆæ ·?ğŸš€