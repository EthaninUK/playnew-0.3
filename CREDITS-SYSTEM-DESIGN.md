# ğŸ–ï¸ PlayNew.ai ç§¯åˆ†ç³»ç»Ÿ - å®Œæ•´å¼€å‘æ–‡æ¡£

**ç‰ˆæœ¬**: v1.0.0
**è®¾è®¡æ—¶é—´**: 2025-11-16
**ç³»ç»ŸçŠ¶æ€**: ğŸ“‹ Design Phase
**é¢„è®¡å¼€å‘å‘¨æœŸ**: 3-4 å‘¨

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒè®¾è®¡ç†å¿µ](#æ ¸å¿ƒè®¾è®¡ç†å¿µ)
3. [ç§¯åˆ†ç³»ç»Ÿæ¶æ„](#ç§¯åˆ†ç³»ç»Ÿæ¶æ„)
4. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
5. [ç§¯åˆ†è·å–æœºåˆ¶](#ç§¯åˆ†è·å–æœºåˆ¶)
6. [ç§¯åˆ†æ¶ˆè€—æœºåˆ¶](#ç§¯åˆ†æ¶ˆè€—æœºåˆ¶)
7. [ä¼šå‘˜ä½“ç³»é›†æˆ](#ä¼šå‘˜ä½“ç³»é›†æˆ)
8. [API è®¾è®¡](#api-è®¾è®¡)
9. [å‰ç«¯ç»„ä»¶è®¾è®¡](#å‰ç«¯ç»„ä»¶è®¾è®¡)
10. [æ¸¸æˆåŒ–è®¾è®¡](#æ¸¸æˆåŒ–è®¾è®¡)
11. [å®æ–½è·¯çº¿å›¾](#å®æ–½è·¯çº¿å›¾)
12. [é£é™©è¯„ä¼°ä¸åº”å¯¹](#é£é™©è¯„ä¼°ä¸åº”å¯¹)

---

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

### 1.1 é¡¹ç›®èƒŒæ™¯

PlayNew.ai æ˜¯ä¸€ä¸ª Web3 ç©æ³•ç­–ç•¥å¹³å°,å·²ç»å…·å¤‡:
- âœ… 4çº§ä¼šå‘˜ä½“ç³» (Free/Pro/Premium/Partner)
- âœ… æ’è¡Œæ¦œç³»ç»Ÿ (6ç§æ¦œå•)
- âœ… å†…å®¹åˆ†ç±»ç³»ç»Ÿ (strategies/news/gossip/arbitrage)
- âœ… Supabase + Directus åŒæ¶æ„
- âœ… Next.js 14 + TypeScript å‰ç«¯

### 1.2 ç§¯åˆ†ç³»ç»Ÿç›®æ ‡

**æ ¸å¿ƒç›®æ ‡**:
1. ğŸ® **å¢å¼ºç”¨æˆ·ç²˜æ€§** - é€šè¿‡ç§¯åˆ†æ¿€åŠ±æé«˜ DAU/MAU
2. ğŸ’° **ä¼˜åŒ–å•†ä¸šæ¨¡å¼** - ç§¯åˆ†ä¸ä¼šå‘˜ä½“ç³»åŒè½®é©±åŠ¨
3. ğŸ† **æ„å»ºç¤¾åŒºç”Ÿæ€** - æ¿€åŠ±ç”¨æˆ·è´¡çŒ®ä¼˜è´¨å†…å®¹
4. ğŸ“ˆ **æ•°æ®ä»·å€¼æŒ–æ˜** - ç§¯åˆ†è¡Œä¸ºåæ˜ ç”¨æˆ·çœŸå®åå¥½
5. ğŸ **çµæ´»è¿è¥å·¥å…·** - æ”¯æŒæ´»åŠ¨ã€æ¨å¹¿ã€ç”¨æˆ·ç•™å­˜

### 1.3 è®¾è®¡åŸåˆ™

| åŸåˆ™ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **ç®€å•æ˜“æ‡‚** | è§„åˆ™æ¸…æ™°,æ–°æ‰‹3åˆ†é’Ÿç†è§£ | æ¯æ—¥ç­¾åˆ° +10 ç§¯åˆ† |
| **å…¬å¹³æ¿€åŠ±** | å¤šæ ·åŒ–è·å–é€”å¾„,ä¸å”¯ä»˜è´¹ | åˆ†äº«å†…å®¹ +5 ç§¯åˆ† |
| **æ¶ˆè€—æœ‰ä»·å€¼** | ç§¯åˆ†æ¶ˆè€—å¸¦æ¥å®é™…æ”¶ç›Š | è§£é”é«˜çº§ç­–ç•¥,æŸ¥çœ‹å¥—åˆ©ä¿¡å· |
| **é˜²åˆ·æœºåˆ¶** | é˜²æ­¢æ¶æ„åˆ·ç§¯åˆ† | æ¯æ—¥ä¸Šé™,è¡Œä¸ºéªŒè¯ |
| **ä¼šå‘˜ååŒ** | ä¸ç°æœ‰ä¼šå‘˜ä½“ç³»äº’è¡¥ | ä¼šå‘˜è·å¾—ç§¯åˆ†å€ç‡åŠ æˆ |
| **å¯æŒç»­æ€§** | ç§¯åˆ†äº§å‡ºä¸æ¶ˆè€—å¹³è¡¡ | æ¯æ—¥äº§å‡º â‰ˆ å¹³å‡æ¶ˆè€— Ã— 1.2 |

---

## ğŸ—ï¸ æ ¸å¿ƒè®¾è®¡ç†å¿µ

### 2.1 ç§¯åˆ†å®šä½

**PlayNew Coins (PNC)** - PlayNew å¹³å°çš„é€šç”¨è™šæ‹Ÿç§¯åˆ†

- **ä¸­æ–‡åç§°**: PlayNew å¸ / ç©å¸
- **è‹±æ–‡ç¼©å†™**: PNC
- **å›¾æ ‡**: ğŸª™ æˆ–è‡ªå®šä¹‰é‡‘å¸å›¾æ ‡
- **æ€§è´¨**: å¹³å°å†…è™šæ‹Ÿç§¯åˆ†,ä¸å¯æç°,ä¸å¯äº¤æ˜“

### 2.2 ç§¯åˆ†æµè½¬é—­ç¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç§¯åˆ†ç”Ÿæ€ç³»ç»Ÿ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  [ç§¯åˆ†è·å–]          [ç§¯åˆ†å­˜å‚¨]          [ç§¯åˆ†æ¶ˆè€—]            â”‚
â”‚                                                              â”‚
â”‚  â€¢ æ¯æ—¥ç­¾åˆ°          ç”¨æˆ·ç§¯åˆ†æ±           â€¢ æŸ¥çœ‹é«˜çº§ç­–ç•¥       â”‚
â”‚  â€¢ ä»»åŠ¡å®Œæˆ    â”€â”€â–º   (Supabase)    â”€â”€â–º   â€¢ è§£é”å¥—åˆ©ä¿¡å·      â”‚
â”‚  â€¢ å†…å®¹è´¡çŒ®          å®æ—¶ä½™é¢            â€¢ ä¸‹è½½èµ„æ–™           â”‚
â”‚  â€¢ ç¤¾äº¤äº’åŠ¨          å†å²è®°å½•            â€¢ å…‘æ¢å¥–åŠ±           â”‚
â”‚  â€¢ ä¼šå‘˜å……å€¼                              â€¢ å‚ä¸æ´»åŠ¨           â”‚
â”‚  â€¢ æ´»åŠ¨å¥–åŠ±                              â€¢ æ‰“èµä½œè€…           â”‚
â”‚                                                              â”‚
â”‚  [ç§¯åˆ†å›æµ]                                                   â”‚
â”‚  â€¢ ç”¨æˆ·æ¶ˆè€— 40% â†’ å†…å®¹ä½œè€…                                    â”‚
â”‚  â€¢ ç”¨æˆ·æ¶ˆè€— 10% â†’ å¹³å°å¥–åŠ±æ±                                  â”‚
â”‚  â€¢ ç”¨æˆ·æ¶ˆè€— 50% â†’ é”€æ¯(é€šç¼©è®¾è®¡)                             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 ä¸ç°æœ‰ç³»ç»Ÿå…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¼šå‘˜ä½“ç³»      â”‚  â†â”€â”€â”€ ç§¯åˆ†è´­ä¹°ä¼šå‘˜æŠ˜æ‰£
â”‚  (4çº§ä¼šå‘˜)     â”‚  â†â”€â”€â”€ ä¼šå‘˜è·å¾—ç§¯åˆ†åŠ æˆ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç§¯åˆ†ç³»ç»Ÿ      â”‚  â†â”€â”€â”€ æ ¸å¿ƒæ¿€åŠ±æœºåˆ¶
â”‚  (PNC Coins)   â”‚  â†â”€â”€â”€ è¿æ¥æ‰€æœ‰åŠŸèƒ½
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ’è¡Œæ¦œç³»ç»Ÿ    â”‚       â”‚  å†…å®¹ç³»ç»Ÿ      â”‚
â”‚  (6ç§æ¦œå•)     â”‚       â”‚  (Strategies)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†‘ æ¶ˆè€—ç§¯åˆ†æŸ¥çœ‹            â†‘ æ¶ˆè€—ç§¯åˆ†è§£é”
```

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### 3.1 æ ¸å¿ƒæ•°æ®è¡¨

#### è¡¨1: user_credits (ç”¨æˆ·ç§¯åˆ†ä¸»è¡¨)

```sql
CREATE TABLE user_credits (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) NOT NULL UNIQUE,

  -- ç§¯åˆ†ä½™é¢
  current_balance INT DEFAULT 0 CHECK (current_balance >= 0),
  total_earned INT DEFAULT 0 CHECK (total_earned >= 0),
  total_spent INT DEFAULT 0 CHECK (total_spent >= 0),

  -- å†»ç»“å’Œé”å®š
  frozen_credits INT DEFAULT 0 CHECK (frozen_credits >= 0),
  locked_credits INT DEFAULT 0 CHECK (locked_credits >= 0),

  -- ä¼šå‘˜åŠ æˆ
  membership_bonus_rate DECIMAL(3,2) DEFAULT 0.00, -- 0.00-2.00 (0%-200%)

  -- ç­‰çº§ç³»ç»Ÿ
  credits_level INT DEFAULT 1 CHECK (credits_level >= 1 AND credits_level <= 10),
  level_progress INT DEFAULT 0,

  -- ç»Ÿè®¡
  daily_earn_limit INT DEFAULT 1000,
  daily_earned_today INT DEFAULT 0,
  last_daily_reset DATE DEFAULT CURRENT_DATE,

  -- æ—¶é—´æˆ³
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),

  -- çº¦æŸ
  CONSTRAINT valid_balance CHECK (current_balance >= 0),
  CONSTRAINT valid_frozen CHECK (frozen_credits <= current_balance)
);

-- ç´¢å¼•
CREATE INDEX idx_user_credits_user_id ON user_credits(user_id);
CREATE INDEX idx_user_credits_balance ON user_credits(current_balance DESC);
CREATE INDEX idx_user_credits_level ON user_credits(credits_level);
CREATE INDEX idx_user_credits_daily_reset ON user_credits(last_daily_reset);

-- æ³¨é‡Š
COMMENT ON TABLE user_credits IS 'ç”¨æˆ·ç§¯åˆ†ä¸»è¡¨';
COMMENT ON COLUMN user_credits.current_balance IS 'å½“å‰å¯ç”¨ç§¯åˆ†';
COMMENT ON COLUMN user_credits.frozen_credits IS 'å†»ç»“ç§¯åˆ†(æç°/äº¤æ˜“ä¸­)';
COMMENT ON COLUMN user_credits.locked_credits IS 'é”å®šç§¯åˆ†(æ´»åŠ¨å¥–åŠ±æœªåˆ°æœŸ)';
COMMENT ON COLUMN user_credits.membership_bonus_rate IS 'ä¼šå‘˜ç§¯åˆ†åŠ æˆå€ç‡';
```

#### è¡¨2: credit_transactions (ç§¯åˆ†äº¤æ˜“è®°å½•)

```sql
CREATE TABLE credit_transactions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) NOT NULL,

  -- äº¤æ˜“åŸºæœ¬ä¿¡æ¯
  transaction_type VARCHAR(50) NOT NULL, -- 'earn', 'spend', 'transfer', 'refund'
  amount INT NOT NULL, -- æ­£æ•°ä¸ºæ”¶å…¥,è´Ÿæ•°ä¸ºæ”¯å‡º
  balance_before INT NOT NULL,
  balance_after INT NOT NULL,

  -- äº¤æ˜“æ¥æº/ç”¨é€”
  source_type VARCHAR(50) NOT NULL,
  -- earn: 'daily_signin', 'task_complete', 'content_contribute', 'referral'
  -- spend: 'view_strategy', 'unlock_arbitrage', 'download_resource', 'gift_author'
  -- transfer: 'p2p_transfer', 'reward_pool'

  source_id UUID, -- å…³è”çš„å†…å®¹/ä»»åŠ¡/ç”¨æˆ· ID
  source_metadata JSONB, -- é¢å¤–ä¿¡æ¯

  -- æè¿°
  description TEXT,
  display_title VARCHAR(200), -- å‰ç«¯æ˜¾ç¤ºçš„æ ‡é¢˜

  -- çŠ¶æ€
  status VARCHAR(20) DEFAULT 'completed', -- 'pending', 'completed', 'failed', 'refunded'

  -- è¿‡æœŸæ—¶é—´ (ç”¨äºé”å®šç§¯åˆ†)
  expires_at TIMESTAMPTZ,

  -- æ—¶é—´æˆ³
  created_at TIMESTAMPTZ DEFAULT NOW(),
  completed_at TIMESTAMPTZ,

  -- å…³è”è®¢å• (å¦‚æœæ˜¯è´­ä¹°ç§¯åˆ†)
  order_id UUID,

  CONSTRAINT valid_amount CHECK (amount != 0)
);

-- ç´¢å¼•
CREATE INDEX idx_credit_trans_user_id ON credit_transactions(user_id);
CREATE INDEX idx_credit_trans_type ON credit_transactions(transaction_type);
CREATE INDEX idx_credit_trans_source ON credit_transactions(source_type, source_id);
CREATE INDEX idx_credit_trans_created ON credit_transactions(created_at DESC);
CREATE INDEX idx_credit_trans_status ON credit_transactions(status);

-- æ³¨é‡Š
COMMENT ON TABLE credit_transactions IS 'ç§¯åˆ†äº¤æ˜“æµæ°´è®°å½•';
COMMENT ON COLUMN credit_transactions.amount IS 'ç§¯åˆ†å˜åŠ¨æ•°é‡,æ­£æ•°ä¸ºæ”¶å…¥,è´Ÿæ•°ä¸ºæ”¯å‡º';
```

#### è¡¨3: credit_tasks (ç§¯åˆ†ä»»åŠ¡é…ç½®)

```sql
CREATE TABLE credit_tasks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  -- ä»»åŠ¡åŸºæœ¬ä¿¡æ¯
  task_key VARCHAR(50) NOT NULL UNIQUE,
  task_name VARCHAR(100) NOT NULL,
  task_description TEXT,
  task_type VARCHAR(30) NOT NULL, -- 'daily', 'weekly', 'monthly', 'onetime', 'achievement'

  -- å¥–åŠ±é…ç½®
  credits_reward INT NOT NULL CHECK (credits_reward > 0),
  bonus_credits INT DEFAULT 0, -- é¢å¤–å¥–åŠ±(è¿ç»­å®Œæˆç­‰)

  -- é™åˆ¶æ¡ä»¶
  daily_limit INT DEFAULT 1,
  weekly_limit INT,
  monthly_limit INT,
  total_limit INT, -- ç»ˆèº«æ¬¡æ•°é™åˆ¶

  -- ä¼šå‘˜é™åˆ¶
  min_membership_level INT DEFAULT 0, -- 0=Free, 1=Pro, 2=Premium, 3=Partner

  -- ä»»åŠ¡å‚æ•°
  required_action VARCHAR(50), -- 'login', 'share', 'comment', 'view', 'refer'
  required_count INT DEFAULT 1, -- éœ€è¦å®Œæˆçš„æ¬¡æ•°
  required_duration INT, -- éœ€è¦çš„æ—¶é—´(ç§’)
  required_params JSONB, -- é¢å¤–å‚æ•° (å¦‚è¯„è®ºæœ€å°‘å­—æ•°)

  -- çŠ¶æ€
  is_active BOOLEAN DEFAULT TRUE,
  is_featured BOOLEAN DEFAULT FALSE,
  sort_order INT DEFAULT 0,

  -- UI é…ç½®
  icon VARCHAR(50),
  color VARCHAR(20),
  badge_text VARCHAR(20),

  -- æ—¶é—´
  start_date DATE,
  end_date DATE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_credit_tasks_type ON credit_tasks(task_type);
CREATE INDEX idx_credit_tasks_active ON credit_tasks(is_active);
CREATE INDEX idx_credit_tasks_featured ON credit_tasks(is_featured);

-- æ³¨é‡Š
COMMENT ON TABLE credit_tasks IS 'ç§¯åˆ†ä»»åŠ¡é…ç½®è¡¨';
```

#### è¡¨4: user_task_progress (ç”¨æˆ·ä»»åŠ¡è¿›åº¦)

```sql
CREATE TABLE user_task_progress (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) NOT NULL,
  task_id UUID REFERENCES credit_tasks(id) NOT NULL,

  -- è¿›åº¦ç»Ÿè®¡
  completed_count INT DEFAULT 0,
  total_credits_earned INT DEFAULT 0,

  -- æ—¶é—´å‘¨æœŸ
  period_type VARCHAR(20), -- 'day', 'week', 'month', 'lifetime'
  period_date DATE DEFAULT CURRENT_DATE,

  -- çŠ¶æ€
  is_completed BOOLEAN DEFAULT FALSE,
  last_completed_at TIMESTAMPTZ,
  first_completed_at TIMESTAMPTZ,

  -- è¿ç»­å®Œæˆ
  consecutive_days INT DEFAULT 0,
  max_consecutive_days INT DEFAULT 0,

  -- æ—¶é—´æˆ³
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(user_id, task_id, period_type, period_date)
);

-- ç´¢å¼•
CREATE INDEX idx_task_progress_user ON user_task_progress(user_id);
CREATE INDEX idx_task_progress_task ON user_task_progress(task_id);
CREATE INDEX idx_task_progress_period ON user_task_progress(period_type, period_date);
CREATE INDEX idx_task_progress_completed ON user_task_progress(is_completed);
```

#### è¡¨5: credit_rewards_pool (ç§¯åˆ†å¥–åŠ±æ± )

```sql
CREATE TABLE credit_rewards_pool (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  -- å¥–æ± ä¿¡æ¯
  pool_name VARCHAR(100) NOT NULL,
  pool_type VARCHAR(30), -- 'daily', 'weekly', 'monthly', 'event'

  -- ç§¯åˆ†æ± 
  total_credits INT DEFAULT 0,
  allocated_credits INT DEFAULT 0,
  remaining_credits INT DEFAULT 0,

  -- åˆ†é…è§„åˆ™
  distribution_rule VARCHAR(30), -- 'random', 'rank', 'contribution', 'proportional'
  distribution_params JSONB,

  -- å‚ä¸æ¡ä»¶
  min_credits_level INT DEFAULT 1,
  min_membership_level INT DEFAULT 0,
  max_participants INT,

  -- çŠ¶æ€
  status VARCHAR(20) DEFAULT 'active', -- 'pending', 'active', 'distributing', 'completed'

  -- æ—¶é—´
  start_time TIMESTAMPTZ,
  end_time TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- æ³¨é‡Š
COMMENT ON TABLE credit_rewards_pool IS 'ç§¯åˆ†å¥–åŠ±æ±  - ç”¨äºæ´»åŠ¨å’Œæ’è¡Œæ¦œå¥–åŠ±';
```

#### è¡¨6: user_unlocked_content (å·²è§£é”å†…å®¹)

```sql
CREATE TABLE user_unlocked_content (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) NOT NULL,

  -- å†…å®¹ä¿¡æ¯
  content_id UUID NOT NULL,
  content_type VARCHAR(50) NOT NULL, -- 'strategy', 'arbitrage', 'news', 'resource'
  content_title VARCHAR(200),

  -- æ¶ˆè€—ä¿¡æ¯
  credits_spent INT NOT NULL,
  original_price INT, -- åŸä»·(å¯èƒ½æ‰“æŠ˜)
  discount_rate DECIMAL(3,2), -- æŠ˜æ‰£ç‡

  -- è§£é”æ–¹å¼
  unlock_method VARCHAR(30), -- 'credits', 'membership', 'free', 'gift'
  unlock_source UUID, -- èµ é€è€…IDæˆ–æ´»åŠ¨ID

  -- è®¿é—®ç»Ÿè®¡
  view_count INT DEFAULT 1,
  last_viewed_at TIMESTAMPTZ DEFAULT NOW(),

  -- æ—¶é—´æˆ³
  unlocked_at TIMESTAMPTZ DEFAULT NOW(),
  expires_at TIMESTAMPTZ, -- è¿‡æœŸæ—¶é—´(å¦‚é™æ—¶è§£é”)

  UNIQUE(user_id, content_id, content_type)
);

-- ç´¢å¼•
CREATE INDEX idx_unlocked_user_content ON user_unlocked_content(user_id, content_id, content_type);
CREATE INDEX idx_unlocked_content_type ON user_unlocked_content(content_type);
CREATE INDEX idx_unlocked_expires ON user_unlocked_content(expires_at);
```

### 3.2 æ‰©å±•ç°æœ‰è¡¨

#### 3.2.1 strategies è¡¨æ‰©å±•

```sql
-- æ·»åŠ ç§¯åˆ†ç›¸å…³å­—æ®µ
ALTER TABLE strategies
ADD COLUMN IF NOT EXISTS credits_price INT DEFAULT 0 CHECK (credits_price >= 0),
ADD COLUMN IF NOT EXISTS original_credits_price INT,
ADD COLUMN IF NOT EXISTS is_credits_only BOOLEAN DEFAULT FALSE,
ADD COLUMN IF NOT EXISTS credits_discount_rate DECIMAL(3,2) DEFAULT 0.00,
ADD COLUMN IF NOT EXISTS free_preview_length INT DEFAULT 500;

-- æ³¨é‡Š
COMMENT ON COLUMN strategies.credits_price IS 'æŸ¥çœ‹ç­–ç•¥æ‰€éœ€ç§¯åˆ†,0è¡¨ç¤ºå…è´¹';
COMMENT ON COLUMN strategies.original_credits_price IS 'åŸå§‹ç§¯åˆ†ä»·æ ¼(ç”¨äºæ˜¾ç¤ºæŠ˜æ‰£)';
COMMENT ON COLUMN strategies.is_credits_only IS 'æ˜¯å¦ä»…æ”¯æŒç§¯åˆ†è§£é”(ä¸æ”¯æŒä¼šå‘˜å…è´¹)';
COMMENT ON COLUMN strategies.free_preview_length IS 'å…è´¹é¢„è§ˆå­—ç¬¦æ•°';

-- ç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_strategies_credits_price ON strategies(credits_price);
```

#### 3.2.2 arbitrage è¡¨æ‰©å±•

```sql
ALTER TABLE arbitrage
ADD COLUMN IF NOT EXISTS credits_price INT DEFAULT 10 CHECK (credits_price >= 0),
ADD COLUMN IF NOT EXISTS urgency_multiplier DECIMAL(3,2) DEFAULT 1.00;

COMMENT ON COLUMN arbitrage.credits_price IS 'å¥—åˆ©ä¿¡å·ç§¯åˆ†ä»·æ ¼';
COMMENT ON COLUMN arbitrage.urgency_multiplier IS 'ç´§æ€¥ç¨‹åº¦ä»·æ ¼å€ç‡(ç´§æ€¥å¥—åˆ©æ›´è´µ)';
```

---

## ğŸ ç§¯åˆ†è·å–æœºåˆ¶

### 4.1 è·å–é€”å¾„ä¸€è§ˆ

| ç±»åˆ« | è¡Œä¸º | ç§¯åˆ† | é¢‘ç‡é™åˆ¶ | ä¼šå‘˜åŠ æˆ | è¯´æ˜ |
|------|------|------|---------|---------|------|
| **ğŸ“… æ¯æ—¥ä»»åŠ¡** | æ¯æ—¥ç­¾åˆ° | +10 | 1æ¬¡/å¤© | âœ… | è¿ç»­ç­¾åˆ°æœ‰é¢å¤–å¥–åŠ± |
| | æµè§ˆ5ç¯‡ç­–ç•¥ | +5 | 1æ¬¡/å¤© | âœ… | éœ€å®Œæ•´é˜…è¯» |
| | åˆ†äº«å†…å®¹ | +3 | 5æ¬¡/å¤© | âœ… | åˆ†äº«åˆ°ç¤¾äº¤åª’ä½“ |
| | å‘è¡¨è¯„è®º | +2 | 10æ¬¡/å¤© | âœ… | è¯„è®ºâ‰¥20å­— |
| **ğŸ“ å†…å®¹è´¡çŒ®** | å‘å¸ƒç­–ç•¥(å®¡æ ¸é€šè¿‡) | +100 | ä¸é™ | âœ… | ä¼˜è´¨å†…å®¹+50 |
| | å‘å¸ƒå¿«è®¯ | +20 | ä¸é™ | âœ… | ç‹¬å®¶å¿«è®¯+30 |
| | å‘å¸ƒå…«å¦ | +15 | 5æ¬¡/å¤© | âœ… | çƒ­é—¨å…«å¦+20 |
| | ä¼˜è´¨è¯„è®º(è¢«ç‚¹èµ) | +5 | ä¸é™ | âŒ | æ¯10ä¸ªèµ+5 |
| **ğŸ‘¥ ç¤¾äº¤äº’åŠ¨** | é‚€è¯·æ–°ç”¨æˆ·æ³¨å†Œ | +50 | ä¸é™ | âœ… | æ–°ç”¨æˆ·å®Œæˆé¦–æ¬¡ä»»åŠ¡ |
| | è¢«é‚€è¯·æ–°ç”¨æˆ·æ¶ˆè´¹ | +10% | ä¸é™ | âŒ | æ°¸ä¹…è¿”ä½£ |
| | ç‚¹èµå†…å®¹ | +1 | 20æ¬¡/å¤© | âŒ | æ´»è·ƒåº¦å¥–åŠ± |
| | å…³æ³¨å…¶ä»–ç”¨æˆ· | +2 | 10æ¬¡/å¤© | âŒ | å»ºç«‹ç¤¾äº¤ç½‘ç»œ |
| **ğŸ† æˆå°±ç³»ç»Ÿ** | è¿ç»­ç­¾åˆ°7å¤© | +30 | æ¯å‘¨ | âŒ | æ–­ç­¾é‡æ–°è®¡ç®— |
| | è¿ç»­ç­¾åˆ°30å¤© | +200 | æ¯æœˆ | âŒ | è¶…çº§å¥–åŠ± |
| | å‘å¸ƒ10ç¯‡ç­–ç•¥ | +150 | ä¸€æ¬¡æ€§ | âŒ | å†…å®¹è´¡çŒ®è€…å¾½ç«  |
| | ç´¯è®¡è·å¾—100èµ | +100 | ä¸€æ¬¡æ€§ | âŒ | ç¤¾åŒºæ˜æ˜Ÿå¾½ç«  |
| **ğŸ’³ å……å€¼è´­ä¹°** | è´­ä¹°Proä¼šå‘˜ | +500 | ä¸é™ | âŒ | ä¼šå‘˜é™„èµ ç§¯åˆ† |
| | è´­ä¹°Premiumä¼šå‘˜ | +1500 | ä¸é™ | âŒ | é«˜çº§ä¼šå‘˜ç¦åˆ© |
| | å•ç‹¬è´­ä¹°ç§¯åˆ†åŒ… | æŒ‰å¥—é¤ | ä¸é™ | âŒ | 1000å¸/$9.9èµ· |
| **ğŸ‰ æ´»åŠ¨å¥–åŠ±** | å‚ä¸æ¯å‘¨æŒ‘æˆ˜ | +50-200 | æ¯å‘¨ | âœ… | æ ¹æ®æ’ååˆ†é… |
| | æ–°äººä»»åŠ¡å®Œæˆ | +200 | ä¸€æ¬¡æ€§ | âŒ | 7æ—¥æ–°æ‰‹ä»»åŠ¡ |
| | èŠ‚æ—¥æ´»åŠ¨ | +100-500 | ä¸å®šæœŸ | âœ… | æ˜¥èŠ‚/å‘¨å¹´åº†ç­‰ |

### 4.2 ä¼šå‘˜ç§¯åˆ†åŠ æˆä½“ç³»

```typescript
// ä¼šå‘˜ç§¯åˆ†å€ç‡é…ç½®
const MEMBERSHIP_CREDITS_MULTIPLIER = {
  0: 1.0,   // Free ç”¨æˆ·: åŸºç¡€å€ç‡
  1: 1.2,   // Pro ç”¨æˆ·: 1.2x å€ç‡ (+20%)
  2: 1.5,   // Premium ç”¨æˆ·: 1.5x å€ç‡ (+50%)
  3: 2.0,   // Partner ç”¨æˆ·: 2.0x å€ç‡ (+100%)
};

// ç¤ºä¾‹è®¡ç®—
// Free ç”¨æˆ·æ¯æ—¥ç­¾åˆ°: 10 Ã— 1.0 = 10 ç§¯åˆ†
// Pro ç”¨æˆ·æ¯æ—¥ç­¾åˆ°: 10 Ã— 1.2 = 12 ç§¯åˆ†
// Premium ç”¨æˆ·æ¯æ—¥ç­¾åˆ°: 10 Ã— 1.5 = 15 ç§¯åˆ†
// Partner ç”¨æˆ·æ¯æ—¥ç­¾åˆ°: 10 Ã— 2.0 = 20 ç§¯åˆ†
```

### 4.3 è¿ç»­ç­¾åˆ°å¥–åŠ±æœºåˆ¶

```typescript
// è¿ç»­ç­¾åˆ°é˜¶æ¢¯å¥–åŠ±
const CONSECUTIVE_SIGNIN_REWARDS = [
  { days: 1, credits: 10 },     // ç¬¬1å¤©
  { days: 3, credits: 15 },     // ç¬¬3å¤© (+5 bonus)
  { days: 7, credits: 30 },     // ç¬¬7å¤© (+20 bonus)
  { days: 14, credits: 50 },    // ç¬¬14å¤© (+20 bonus)
  { days: 30, credits: 200 },   // ç¬¬30å¤© (+150 bonus)
  { days: 60, credits: 300 },   // ç¬¬60å¤© (+100 bonus)
  { days: 100, credits: 500 },  // ç¬¬100å¤© (+200 bonus)
];

// æ–­ç­¾è§„åˆ™: è¶…è¿‡48å°æ—¶æœªç­¾åˆ°,è¿ç»­å¤©æ•°é‡ç½®ä¸º0
```

### 4.4 æ¯æ—¥è·å–ä¸Šé™

```typescript
// é˜²æ­¢åˆ·ç§¯åˆ†,è®¾ç½®æ¯æ—¥è·å–ä¸Šé™
const DAILY_EARN_LIMITS = {
  free: 1000,      // Free ç”¨æˆ·: 1000ç§¯åˆ†/å¤©
  pro: 1500,       // Pro ç”¨æˆ·: 1500ç§¯åˆ†/å¤©
  premium: 2500,   // Premium ç”¨æˆ·: 2500ç§¯åˆ†/å¤©
  partner: 5000,   // Partner ç”¨æˆ·: 5000ç§¯åˆ†/å¤©
};

// ç‰¹æ®Šè¯´æ˜:
// - å……å€¼è´­ä¹°çš„ç§¯åˆ†ä¸è®¡å…¥æ¯æ—¥ä¸Šé™
// - æ´»åŠ¨å¥–åŠ±ä¸è®¡å…¥æ¯æ—¥ä¸Šé™
// - é‚€è¯·å¥–åŠ±ä¸è®¡å…¥æ¯æ—¥ä¸Šé™
```

---

## ğŸ’¸ ç§¯åˆ†æ¶ˆè€—æœºåˆ¶

### 5.1 æ¶ˆè€—åœºæ™¯ä¸€è§ˆ

| å†…å®¹ç±»å‹ | åŸºç¡€ä»·æ ¼ | ä¼šå‘˜æŠ˜æ‰£ | è¯´æ˜ |
|---------|---------|---------|------|
| **ç­–ç•¥è¯¦æƒ…** | | | |
| æ™®é€šç­–ç•¥ | 10ç§¯åˆ† | Proå…è´¹ | åŸºç¡€ç©æ³•ç­–ç•¥ |
| ç²¾é€‰ç­–ç•¥ | 30ç§¯åˆ† | Pro -50% | ç¼–è¾‘ç²¾é€‰ç­–ç•¥ |
| é«˜çº§ç­–ç•¥ | 50ç§¯åˆ† | Premiumå…è´¹ | å¤æ‚é«˜æ”¶ç›Šç­–ç•¥ |
| ä¸“å®¶ç­–ç•¥ | 100ç§¯åˆ† | Premium -30% | è¡Œä¸šä¸“å®¶æ·±åº¦åˆ†æ |
| **å¥—åˆ©ä¿¡å·** | | | |
| æ™®é€šå¥—åˆ© | 20ç§¯åˆ† | Pro -30% | å¸¸è§„å¥—åˆ©æœºä¼š |
| ç´§æ€¥å¥—åˆ© | 50ç§¯åˆ† | Premium -20% | æ—¶æ•ˆæ€§å¼º |
| é«˜é¢‘å¥—åˆ© | 30ç§¯åˆ†/å¤© | Premium -50% | è®¢é˜…åˆ¶,1å¤©æœ‰æ•ˆ |
| **å¿«è®¯&å…«å¦** | | | |
| æ™®é€šå¿«è®¯ | 5ç§¯åˆ† | æ‰€æœ‰ä¼šå‘˜å…è´¹ | åŸºç¡€èµ„è®¯ |
| æ·±åº¦å¿«è®¯ | 15ç§¯åˆ† | Proå…è´¹ | æ·±åº¦åˆ†æ |
| ç‹¬å®¶å…«å¦ | 10ç§¯åˆ† | Pro -50% | çˆ†æ–™å†…å®¹ |
| **èµ„æºä¸‹è½½** | | | |
| PDFæŠ¥å‘Š | 50ç§¯åˆ† | Pro -30% | ç ”ç©¶æŠ¥å‘Š |
| æ•°æ®è¡¨æ ¼ | 30ç§¯åˆ† | Pro -30% | Excelæ•°æ® |
| å·¥å…·è„šæœ¬ | 100ç§¯åˆ† | Premium -50% | è‡ªåŠ¨åŒ–å·¥å…· |
| **ç¤¾äº¤åŠŸèƒ½** | | | |
| æ‰“èµä½œè€… | 10-1000 | ä¸æ‰“æŠ˜ | è‡ªå®šä¹‰é‡‘é¢ |
| ç½®é¡¶è¯„è®º | 50ç§¯åˆ† | ä¸æ‰“æŠ˜ | è¯„è®ºç½®é¡¶24h |
| ç§ä¿¡ç”¨æˆ· | 5ç§¯åˆ†/æ¡ | Proå…è´¹ | é˜²æ­¢éªšæ‰° |
| **æ´»åŠ¨å‚ä¸** | | | |
| æŠ½å¥–ä¸€æ¬¡ | 100ç§¯åˆ† | ä¸æ‰“æŠ˜ | å‘¨åº¦æŠ½å¥–æ´»åŠ¨ |
| ç«çŒœå‚ä¸ | 50ç§¯åˆ† | ä¸æ‰“æŠ˜ | é¢„æµ‹å¸‚åœºèµ°åŠ¿ |
| VIPç›´æ’­ | 200ç§¯åˆ† | Premiumå…è´¹ | ä¸“å®¶çº¿ä¸Šç›´æ’­ |

### 5.2 åŠ¨æ€å®šä»·æœºåˆ¶

```typescript
// ç­–ç•¥ä»·æ ¼è®¡ç®—å…¬å¼
function calculateStrategyPrice(strategy: Strategy, user: User): number {
  let basePrice = strategy.credits_price;

  // 1. ä¼šå‘˜æŠ˜æ‰£
  const membershipDiscount = getMembershipDiscount(strategy, user.membership_level);
  basePrice = basePrice * (1 - membershipDiscount);

  // 2. çƒ­åº¦åŠ æˆ (çƒ­é—¨å†…å®¹æ›´è´µ)
  if (strategy.hotness_score > 500) {
    basePrice = basePrice * 1.2;
  }

  // 3. æ—¶æ•ˆæ€§æŠ˜æ‰£ (æ—§å†…å®¹é™ä»·)
  const ageInDays = (Date.now() - new Date(strategy.published_at).getTime()) / (1000 * 60 * 60 * 24);
  if (ageInDays > 90) {
    basePrice = basePrice * 0.7; // 3ä¸ªæœˆå7æŠ˜
  }

  // 4. ä¿ƒé”€æ´»åŠ¨
  if (strategy.is_on_sale) {
    basePrice = basePrice * strategy.sale_discount_rate;
  }

  // 5. æœ€å°ä»·æ ¼ä¿æŠ¤
  return Math.max(basePrice, 1);
}

// ä¼šå‘˜æŠ˜æ‰£è¡¨
const MEMBERSHIP_DISCOUNTS = {
  strategy_normal: { 0: 0, 1: 1.0, 2: 1.0, 3: 1.0 },      // Freeä¸æ‰“æŠ˜,Pro+å…è´¹
  strategy_featured: { 0: 0, 1: 0.5, 2: 0.8, 3: 1.0 },    // ProåŠä»·,Premiumå…«æŠ˜,Partnerå…è´¹
  strategy_advanced: { 0: 0, 1: 0.3, 2: 1.0, 3: 1.0 },    // Proä¸ƒæŠ˜,Premium+å…è´¹
  arbitrage_normal: { 0: 0, 1: 0.3, 2: 0.5, 3: 0.7 },    // Proä¸ƒæŠ˜,PremiumåŠä»·,Partnerä¸‰æŠ˜
};
```

### 5.3 é‡å¤è®¿é—®è§„åˆ™

```typescript
// å·²è§£é”å†…å®¹è®¿é—®ç­–ç•¥
const CONTENT_ACCESS_POLICY = {
  // æ°¸ä¹…è§£é” (ä¸€æ¬¡ä»˜è´¹,ç»ˆèº«ä½¿ç”¨)
  permanent: [
    'strategy',
    'download_resource',
  ],

  // é™æ—¶è§£é” (éœ€è¦å®šæœŸç»­è´¹)
  temporary: {
    'arbitrage_signal': 24 * 60 * 60 * 1000,      // 24å°æ—¶
    'vip_livestream': 7 * 24 * 60 * 60 * 1000,    // 7å¤©å›çœ‹
  },

  // æ¶ˆè€—å‹ (æ¯æ¬¡ä½¿ç”¨éƒ½æ¶ˆè€—)
  consumable: [
    'lottery_ticket',
    'prediction_entry',
  ],
};
```

---

## ğŸ‘‘ ä¼šå‘˜ä½“ç³»é›†æˆ

### 6.1 ä¼šå‘˜ vs ç§¯åˆ†å¯¹æ¯”

| ç»´åº¦ | ä¼šå‘˜åˆ¶ | ç§¯åˆ†åˆ¶ | ç»„åˆä¼˜åŠ¿ |
|------|--------|--------|---------|
| **è·å–æ–¹å¼** | ä»˜è´¹è´­ä¹° | å…è´¹è·å¾—+ä»˜è´¹åŠ é€Ÿ | é™ä½ä»˜è´¹é—¨æ§› |
| **å†…å®¹è®¿é—®** | æ•´ä½“æƒé™ | å•æ¬¡è§£é” | çµæ´»é€‰æ‹© |
| **æ¿€åŠ±ä½œç”¨** | ä¸€æ¬¡æ€§æ¿€åŠ± | æŒç»­æ¿€åŠ± | æé«˜DAU |
| **ä»˜è´¹å‹åŠ›** | è¾ƒé«˜($10-$50/æœˆ) | è¾ƒä½(10-100å¸/æ¬¡) | å¤šå±‚æ¬¡å˜ç° |
| **ç”¨æˆ·ç²˜æ€§** | ä¸­ç­‰ | é«˜ | å¼ºåŒ–ç²˜æ€§ |

### 6.2 ä¼šå‘˜ç¦åˆ©è®¾è®¡

```typescript
// ä¸åŒä¼šå‘˜ç­‰çº§çš„ç§¯åˆ†ç¦åˆ©
const MEMBERSHIP_CREDITS_BENEFITS = {
  // Free ç”¨æˆ· (Level 0)
  free: {
    signup_bonus: 200,                 // æ³¨å†Œèµ é€
    daily_signin: 10,                  // æ¯æ—¥ç­¾åˆ°
    credits_multiplier: 1.0,           // è·å–å€ç‡
    daily_earn_limit: 1000,            // æ¯æ—¥ä¸Šé™
    purchase_discount: 0,              // è´­ä¹°ç§¯åˆ†æŠ˜æ‰£
  },

  // Pro ç”¨æˆ· (Level 1 - $10/æœˆ)
  pro: {
    monthly_grant: 500,                // æ¯æœˆèµ é€500ç§¯åˆ†
    credits_multiplier: 1.2,           // è·å–ç§¯åˆ†+20%
    daily_earn_limit: 1500,            // æ¯æ—¥ä¸Šé™æå‡
    purchase_discount: 0.1,            // è´­ä¹°ç§¯åˆ†9æŠ˜
    free_content: ['strategy_normal'], // æ™®é€šç­–ç•¥å…è´¹
  },

  // Premium ç”¨æˆ· (Level 2 - $30/æœˆ)
  premium: {
    monthly_grant: 1500,               // æ¯æœˆèµ é€1500ç§¯åˆ†
    credits_multiplier: 1.5,           // è·å–ç§¯åˆ†+50%
    daily_earn_limit: 2500,            // æ¯æ—¥ä¸Šé™æ›´é«˜
    purchase_discount: 0.2,            // è´­ä¹°ç§¯åˆ†8æŠ˜
    free_content: ['strategy_normal', 'strategy_featured', 'strategy_advanced'], // å¤§éƒ¨åˆ†ç­–ç•¥å…è´¹
  },

  // Partner ç”¨æˆ· (Level 3 - $50/æœˆ)
  partner: {
    monthly_grant: 3000,               // æ¯æœˆèµ é€3000ç§¯åˆ†
    credits_multiplier: 2.0,           // è·å–ç§¯åˆ†+100%
    daily_earn_limit: 5000,            // æ¯æ—¥ä¸Šé™æœ€é«˜
    purchase_discount: 0.3,            // è´­ä¹°ç§¯åˆ†7æŠ˜
    free_content: ['all'],             // å…¨éƒ¨å†…å®¹å…è´¹
    revenue_share: 0.7,                // å‘å¸ƒå†…å®¹è·å¾—70%æ”¶ç›Š
  },
};
```

### 6.3 ä¼šå‘˜è´­ä¹°èµ é€ç§¯åˆ†

```typescript
// è´­ä¹°ä¼šå‘˜èµ é€ç§¯åˆ†æ–¹æ¡ˆ
const MEMBERSHIP_PURCHASE_CREDITS = {
  pro_monthly: 500,       // Proæœˆä»˜: +500ç§¯åˆ†
  pro_yearly: 6000,       // Proå¹´ä»˜: +6000ç§¯åˆ† (ç›¸å½“äº+1ä¸ªæœˆå…è´¹)
  premium_monthly: 1500,  // Premiumæœˆä»˜: +1500ç§¯åˆ†
  premium_yearly: 18000,  // Premiumå¹´ä»˜: +18000ç§¯åˆ† (+20%å¥–åŠ±)
  partner_monthly: 3000,  // Partneræœˆä»˜: +3000ç§¯åˆ†
  partner_yearly: 36000,  // Partnerå¹´ä»˜: +36000ç§¯åˆ† (+20%å¥–åŠ±)
};
```

---

## ğŸ® æ¸¸æˆåŒ–è®¾è®¡

### 7.1 ç§¯åˆ†ç­‰çº§ç³»ç»Ÿ

```typescript
// ç§¯åˆ†ç­‰çº§é…ç½®
const CREDITS_LEVELS = [
  { level: 1, name: 'é“œç‰Œç©å®¶', minCredits: 0, badge: 'ğŸ¥‰', color: '#CD7F32' },
  { level: 2, name: 'é“¶ç‰Œç©å®¶', minCredits: 1000, badge: 'ğŸ¥ˆ', color: '#C0C0C0' },
  { level: 3, name: 'é‡‘ç‰Œç©å®¶', minCredits: 5000, badge: 'ğŸ¥‡', color: '#FFD700' },
  { level: 4, name: 'é’»çŸ³ç©å®¶', minCredits: 15000, badge: 'ğŸ’', color: '#00BFFF' },
  { level: 5, name: 'å¤§å¸ˆç©å®¶', minCredits: 50000, badge: 'ğŸ‘‘', color: '#8A2BE2' },
  { level: 6, name: 'å®—å¸ˆç©å®¶', minCredits: 150000, badge: 'âš¡', color: '#FF4500' },
  { level: 7, name: 'ä¼ å¥‡ç©å®¶', minCredits: 500000, badge: 'ğŸ”¥', color: '#FF0000' },
  { level: 8, name: 'ç¥è¯ç©å®¶', minCredits: 1500000, badge: 'ğŸŒŸ', color: '#FFD700', glow: true },
  { level: 9, name: 'æ°¸æ’ç©å®¶', minCredits: 5000000, badge: 'ğŸ†', color: '#9400D3', animated: true },
  { level: 10, name: 'è‡³å°Šç©å®¶', minCredits: 10000000, badge: 'ğŸ‘‘', color: 'rainbow', exclusive: true },
];

// ç­‰çº§æƒç›Š
const LEVEL_BENEFITS = {
  1: { discount: 0, daily_limit_bonus: 0 },
  2: { discount: 0.05, daily_limit_bonus: 100 },   // æ¶ˆè´¹95æŠ˜,æ¯æ—¥ä¸Šé™+100
  3: { discount: 0.10, daily_limit_bonus: 300 },
  4: { discount: 0.15, daily_limit_bonus: 500 },
  5: { discount: 0.20, daily_limit_bonus: 1000, exclusive_content: true },
  6: { discount: 0.25, daily_limit_bonus: 1500, priority_support: true },
  7: { discount: 0.30, daily_limit_bonus: 2000, custom_badge: true },
  8: { discount: 0.35, daily_limit_bonus: 3000, vip_community: true },
  9: { discount: 0.40, daily_limit_bonus: 5000, early_access: true },
  10: { discount: 0.50, daily_limit_bonus: 10000, hall_of_fame: true },
};
```

### 7.2 æˆå°±ç³»ç»Ÿ

```typescript
// æˆå°±é…ç½®
const ACHIEVEMENTS = [
  // ç­¾åˆ°ç±»
  {
    id: 'signin_7days',
    name: 'æŒä¹‹ä»¥æ’',
    description: 'è¿ç»­ç­¾åˆ°7å¤©',
    category: 'daily',
    credits_reward: 50,
    badge: 'ğŸ“…',
    rarity: 'common',
  },
  {
    id: 'signin_30days',
    name: 'æ—¥æ—¥ç›¸ä¼´',
    description: 'è¿ç»­ç­¾åˆ°30å¤©',
    category: 'daily',
    credits_reward: 300,
    badge: 'ğŸ–ï¸',
    rarity: 'rare',
  },

  // å†…å®¹ç±»
  {
    id: 'publish_10strategies',
    name: 'ç­–ç•¥å¤§å¸ˆ',
    description: 'å‘å¸ƒ10ç¯‡ç­–ç•¥',
    category: 'content',
    credits_reward: 200,
    badge: 'ğŸ“',
    rarity: 'uncommon',
  },
  {
    id: 'get_100likes',
    name: 'ç¤¾åŒºä¹‹æ˜Ÿ',
    description: 'ç´¯è®¡è·å¾—100ä¸ªç‚¹èµ',
    category: 'social',
    credits_reward: 150,
    badge: 'â­',
    rarity: 'rare',
  },

  // æ¶ˆè´¹ç±»
  {
    id: 'spend_1000credits',
    name: 'æ…·æ…¨è§£å›Š',
    description: 'ç´¯è®¡æ¶ˆè€—1000ç§¯åˆ†',
    category: 'spending',
    credits_reward: 100,
    badge: 'ğŸ’°',
    rarity: 'common',
  },

  // ç¨€æœ‰æˆå°±
  {
    id: 'first_blood',
    name: 'å¹³å°é¦–æ€',
    description: 'æˆä¸ºç¬¬1ä¸ªæ³¨å†Œç”¨æˆ·',
    category: 'special',
    credits_reward: 10000,
    badge: 'ğŸ…',
    rarity: 'legendary',
    unique: true,
  },
];
```

### 7.3 æ¯å‘¨æŒ‘æˆ˜èµ›

```typescript
// æ¯å‘¨æŒ‘æˆ˜èµ›é…ç½®
const WEEKLY_CHALLENGES = {
  week1: {
    name: 'ç­–ç•¥é˜…è¯»å‘¨',
    description: 'æœ¬å‘¨é˜…è¯»20ç¯‡ç­–ç•¥',
    target: 20,
    rewards: [
      { rank: 1, credits: 1000, badge: 'ğŸ¥‡' },
      { rank: 2-5, credits: 500, badge: 'ğŸ¥ˆ' },
      { rank: 6-10, credits: 300, badge: 'ğŸ¥‰' },
      { rank: 11-50, credits: 100 },
    ],
  },

  week2: {
    name: 'ç¤¾äº¤è¾¾äººå‘¨',
    description: 'æœ¬å‘¨åˆ†äº«å†…å®¹50æ¬¡',
    target: 50,
    rewards: [
      { rank: 1, credits: 800, badge: 'ğŸ“¢' },
      { rank: 2-10, credits: 400 },
      { rank: 11-30, credits: 200 },
    ],
  },

  // ... more challenges
};
```

---

## ğŸ”Œ API è®¾è®¡

### 8.1 æ ¸å¿ƒ API ç«¯ç‚¹

#### 1. GET /api/credits/balance
è·å–ç”¨æˆ·ç§¯åˆ†ä½™é¢

**Response:**
```json
{
  "success": true,
  "data": {
    "user_id": "uuid",
    "current_balance": 1250,
    "total_earned": 5000,
    "total_spent": 3750,
    "frozen_credits": 0,
    "locked_credits": 100,
    "credits_level": 3,
    "level_info": {
      "current": 3,
      "name": "é‡‘ç‰Œç©å®¶",
      "badge": "ğŸ¥‡",
      "next_level_at": 5000,
      "progress": 25.0
    },
    "membership_bonus_rate": 1.2,
    "daily_earned_today": 65,
    "daily_earn_limit": 1500
  }
}
```

#### 2. POST /api/credits/earn
è·å¾—ç§¯åˆ†

**Request:**
```json
{
  "source_type": "daily_signin",
  "amount": 10,
  "metadata": {
    "consecutive_days": 5
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "transaction_id": "uuid",
    "amount": 12,
    "original_amount": 10,
    "bonus_amount": 2,
    "bonus_reason": "ä¼šå‘˜åŠ æˆ +20%",
    "balance_before": 1250,
    "balance_after": 1262,
    "daily_earned_today": 77,
    "level_up": false
  }
}
```

#### 3. POST /api/credits/spend
æ¶ˆè€—ç§¯åˆ†

**Request:**
```json
{
  "content_type": "strategy",
  "content_id": "uuid",
  "amount": 30
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "transaction_id": "uuid",
    "amount": 30,
    "original_price": 50,
    "discount": 0.4,
    "discount_reason": "Premiumä¼šå‘˜ -40%",
    "balance_before": 1262,
    "balance_after": 1232,
    "content_unlocked": true,
    "unlock_expires_at": null
  }
}
```

#### 4. POST /api/credits/transfer
ç§¯åˆ†è½¬è´¦ (ç”¨æˆ·ä¹‹é—´)

**Request:**
```json
{
  "to_user_id": "uuid",
  "amount": 50,
  "message": "æ„Ÿè°¢åˆ†äº«"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "transaction_id": "uuid",
    "from_user_id": "uuid",
    "to_user_id": "uuid",
    "amount": 50,
    "fee": 5,
    "total_deducted": 55,
    "balance_after": 1177,
    "message": "æ„Ÿè°¢åˆ†äº«"
  }
}
```

#### 5. GET /api/credits/transactions
ç§¯åˆ†æµæ°´æŸ¥è¯¢

**Query Parameters:**
- `limit`: 20 (default)
- `offset`: 0
- `type`: earn | spend | transfer | refund
- `start_date`: 2025-01-01
- `end_date`: 2025-01-31

**Response:**
```json
{
  "success": true,
  "data": {
    "transactions": [
      {
        "id": "uuid",
        "transaction_type": "earn",
        "source_type": "daily_signin",
        "amount": 12,
        "balance_before": 1250,
        "balance_after": 1262,
        "display_title": "æ¯æ—¥ç­¾åˆ°å¥–åŠ±",
        "description": "è¿ç»­ç­¾åˆ°ç¬¬5å¤©",
        "created_at": "2025-11-16T08:00:00Z"
      }
    ],
    "summary": {
      "total_earned": 500,
      "total_spent": 150,
      "net_change": 350
    },
    "pagination": {
      "total": 128,
      "limit": 20,
      "offset": 0,
      "has_more": true
    }
  }
}
```

#### 6. GET /api/credits/tasks
è·å–å¯ç”¨ä»»åŠ¡åˆ—è¡¨

**Response:**
```json
{
  "success": true,
  "data": {
    "daily_tasks": [
      {
        "task_id": "uuid",
        "task_key": "daily_signin",
        "task_name": "æ¯æ—¥ç­¾åˆ°",
        "description": "æ¯å¤©ç™»å½•å¹³å°è·å¾—ç§¯åˆ†",
        "credits_reward": 10,
        "bonus_credits": 2,
        "progress": {
          "current": 1,
          "total": 1,
          "completed": true
        },
        "next_available_at": "2025-11-17T00:00:00Z"
      }
    ],
    "weekly_tasks": [],
    "achievements": [],
    "daily_summary": {
      "tasks_completed": 3,
      "credits_earned": 25,
      "remaining_tasks": 2
    }
  }
}
```

#### 7. POST /api/credits/check-price
æ£€æŸ¥å†…å®¹ä»·æ ¼ (ä¸å®é™…æ‰£è´¹)

**Request:**
```json
{
  "content_type": "strategy",
  "content_id": "uuid"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "content_id": "uuid",
    "content_type": "strategy",
    "content_title": "Uniswap V3 æµåŠ¨æ€§æŒ–çŸ¿",
    "base_price": 50,
    "final_price": 30,
    "your_balance": 1232,
    "can_afford": true,
    "already_unlocked": false,
    "discounts": [
      {
        "type": "membership",
        "rate": 0.4,
        "amount": 20,
        "reason": "Premiumä¼šå‘˜æŠ˜æ‰£"
      }
    ],
    "free_for_members": ["premium", "partner"]
  }
}
```

#### 8. POST /api/credits/purchase
è´­ä¹°ç§¯åˆ†åŒ…

**Request:**
```json
{
  "package_id": "credits_1000",
  "payment_method": "stripe"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "order_id": "uuid",
    "package": {
      "id": "credits_1000",
      "credits": 1000,
      "bonus_credits": 100,
      "price_usd": 9.9
    },
    "payment_url": "https://checkout.stripe.com/...",
    "expires_at": "2025-11-16T09:00:00Z"
  }
}
```

---

## ğŸ¨ å‰ç«¯ç»„ä»¶è®¾è®¡

### 9.1 ç§¯åˆ†æ˜¾ç¤ºç»„ä»¶

#### CreditsBalance (Header ç§¯åˆ†æ˜¾ç¤º)

```tsx
// components/credits/CreditsBalance.tsx
import { Coins, TrendingUp } from 'lucide-react';
import { Progress } from '@/components/ui/progress';

interface CreditsBalanceProps {
  balance: number;
  level: number;
  levelName: string;
  nextLevelAt: number;
  showProgress?: boolean;
}

export function CreditsBalance({
  balance,
  level,
  levelName,
  nextLevelAt,
  showProgress = false
}: CreditsBalanceProps) {
  const progress = (balance / nextLevelAt) * 100;

  return (
    <div className="flex items-center gap-3 px-4 py-2 rounded-xl bg-gradient-to-r from-amber-50 to-yellow-50 dark:from-amber-950 dark:to-yellow-950 border border-amber-200 dark:border-amber-800">
      {/* å›¾æ ‡ */}
      <div className="relative">
        <Coins className="w-6 h-6 text-amber-600 dark:text-amber-400" />
        <div className="absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white animate-pulse" />
      </div>

      {/* ç§¯åˆ†ä¿¡æ¯ */}
      <div className="flex flex-col gap-0.5">
        <div className="flex items-baseline gap-1.5">
          <span className="text-lg font-bold text-gray-900 dark:text-white">
            {balance.toLocaleString()}
          </span>
          <span className="text-xs text-gray-500">PNC</span>
        </div>

        {showProgress && (
          <>
            <div className="flex items-center gap-1.5">
              <span className="text-xs text-amber-600 dark:text-amber-400 font-medium">
                Lv.{level} {levelName}
              </span>
              <TrendingUp className="w-3 h-3 text-green-500" />
            </div>
            <Progress value={progress} className="h-1 w-24" />
          </>
        )}
      </div>

      {/* å……å€¼æŒ‰é’® */}
      <button className="ml-auto px-3 py-1 text-xs font-medium bg-gradient-to-r from-amber-500 to-yellow-500 text-white rounded-lg hover:shadow-lg transition-all">
        å……å€¼
      </button>
    </div>
  );
}
```

#### CreditsTransaction (ç§¯åˆ†å˜åŠ¨åŠ¨ç”»)

```tsx
// components/credits/CreditsTransaction.tsx
import { motion, AnimatePresence } from 'framer-motion';
import { ArrowUp, ArrowDown } from 'lucide-react';

interface Transaction {
  id: string;
  amount: number;
  type: 'earn' | 'spend';
  message: string;
}

export function CreditsTransactionToast({ transactions }: { transactions: Transaction[] }) {
  return (
    <div className="fixed top-20 right-4 z-50 space-y-2">
      <AnimatePresence>
        {transactions.map((tx) => (
          <motion.div
            key={tx.id}
            initial={{ opacity: 0, x: 100, scale: 0.8 }}
            animate={{ opacity: 1, x: 0, scale: 1 }}
            exit={{ opacity: 0, x: 100, scale: 0.8 }}
            className={`px-4 py-3 rounded-lg shadow-lg backdrop-blur-sm border ${
              tx.type === 'earn'
                ? 'bg-green-50 border-green-200 text-green-900'
                : 'bg-red-50 border-red-200 text-red-900'
            }`}
          >
            <div className="flex items-center gap-2">
              {tx.type === 'earn' ? (
                <ArrowUp className="w-5 h-5 text-green-600" />
              ) : (
                <ArrowDown className="w-5 h-5 text-red-600" />
              )}
              <div>
                <div className="font-bold">
                  {tx.type === 'earn' ? '+' : '-'}{Math.abs(tx.amount)} PNC
                </div>
                <div className="text-sm opacity-80">{tx.message}</div>
              </div>
            </div>
          </motion.div>
        ))}
      </AnimatePresence>
    </div>
  );
}
```

### 9.2 ç§¯åˆ†ä»»åŠ¡é¢æ¿

```tsx
// components/credits/DailyTasksPanel.tsx
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';
import { CheckCircle2, Circle, Gift, ChevronRight } from 'lucide-react';
import { Progress } from '@/components/ui/progress';

interface Task {
  id: string;
  name: string;
  description: string;
  reward: number;
  progress: { current: number; total: number };
  completed: boolean;
  icon: string;
}

export function DailyTasksPanel({ tasks }: { tasks: Task[] }) {
  return (
    <Card className="border-amber-200 dark:border-amber-800">
      <CardHeader className="bg-gradient-to-r from-amber-50 to-yellow-50 dark:from-amber-950 dark:to-yellow-950">
        <CardTitle className="flex items-center gap-2">
          <Gift className="w-5 h-5 text-amber-600" />
          æ¯æ—¥ä»»åŠ¡
        </CardTitle>
      </CardHeader>

      <CardContent className="pt-6 space-y-3">
        {tasks.map((task) => (
          <div
            key={task.id}
            className="flex items-center justify-between p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow"
          >
            <div className="flex items-center gap-4 flex-1">
              {/* å®ŒæˆçŠ¶æ€ */}
              {task.completed ? (
                <CheckCircle2 className="w-6 h-6 text-green-500 flex-shrink-0" />
              ) : (
                <Circle className="w-6 h-6 text-gray-300 flex-shrink-0" />
              )}

              {/* ä»»åŠ¡ä¿¡æ¯ */}
              <div className="flex-1">
                <div className="flex items-center gap-2 mb-1">
                  <span className="text-lg">{task.icon}</span>
                  <h4 className="font-semibold">{task.name}</h4>
                </div>
                <p className="text-sm text-gray-600 dark:text-gray-400 mb-2">
                  {task.description}
                </p>

                {/* è¿›åº¦æ¡ */}
                {!task.completed && (
                  <div className="flex items-center gap-2">
                    <Progress
                      value={(task.progress.current / task.progress.total) * 100}
                      className="h-2 flex-1"
                    />
                    <span className="text-xs text-gray-500">
                      {task.progress.current}/{task.progress.total}
                    </span>
                  </div>
                )}
              </div>
            </div>

            {/* å¥–åŠ± */}
            <div className="flex items-center gap-2 ml-4">
              <div className="text-right">
                <div className="text-lg font-bold text-amber-600">
                  +{task.reward}
                </div>
                <div className="text-xs text-gray-500">PNC</div>
              </div>
              <ChevronRight className="w-4 h-4 text-gray-400" />
            </div>
          </div>
        ))}
      </CardContent>
    </Card>
  );
}
```

### 9.3 ç§¯åˆ†ä¸è¶³å¼¹çª—

```tsx
// components/credits/InsufficientCreditsDialog.tsx
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogDescription,
} from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { AlertCircle, Coins, Gift, Share2, Star } from 'lucide-react';

interface Props {
  open: boolean;
  onClose: () => void;
  required: number;
  current: number;
  contentTitle: string;
}

export function InsufficientCreditsDialog({
  open,
  onClose,
  required,
  current,
  contentTitle,
}: Props) {
  const shortfall = required - current;

  return (
    <Dialog open={open} onOpenChange={onClose}>
      <DialogContent className="max-w-md">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2 text-xl">
            <AlertCircle className="w-6 h-6 text-amber-500" />
            ç§¯åˆ†ä¸è¶³
          </DialogTitle>
          <DialogDescription>
            æŸ¥çœ‹ã€Œ{contentTitle}ã€éœ€è¦ <strong className="text-amber-600">{required} PNC</strong>
          </DialogDescription>
        </DialogHeader>

        <div className="space-y-4">
          {/* å½“å‰çŠ¶æ€ */}
          <div className="p-4 bg-amber-50 dark:bg-amber-950 rounded-lg border border-amber-200 dark:border-amber-800">
            <div className="flex items-center justify-between mb-2">
              <span className="text-sm text-gray-600 dark:text-gray-400">å½“å‰ç§¯åˆ†</span>
              <span className="font-bold text-lg">{current} PNC</span>
            </div>
            <div className="flex items-center justify-between mb-2">
              <span className="text-sm text-gray-600 dark:text-gray-400">æ‰€éœ€ç§¯åˆ†</span>
              <span className="font-bold text-lg text-amber-600">{required} PNC</span>
            </div>
            <div className="h-px bg-gray-300 dark:bg-gray-600 my-2" />
            <div className="flex items-center justify-between">
              <span className="text-sm font-medium text-red-600">è¿˜å·®</span>
              <span className="font-bold text-lg text-red-600">{shortfall} PNC</span>
            </div>
          </div>

          {/* å¿«é€Ÿè·å–ç§¯åˆ† */}
          <div className="space-y-2">
            <h4 className="font-semibold text-sm text-gray-700 dark:text-gray-300">
              å¿«é€Ÿè·å–ç§¯åˆ†:
            </h4>

            <Button
              variant="outline"
              className="w-full justify-between"
              onClick={() => window.location.href = '/tasks'}
            >
              <span className="flex items-center gap-2">
                <Gift className="w-4 h-4 text-green-500" />
                å®Œæˆæ¯æ—¥ä»»åŠ¡
              </span>
              <span className="text-green-600 font-semibold">+30 PNC</span>
            </Button>

            <Button
              variant="outline"
              className="w-full justify-between"
              onClick={() => {/* Share logic */}}
            >
              <span className="flex items-center gap-2">
                <Share2 className="w-4 h-4 text-blue-500" />
                åˆ†äº«åˆ°ç¤¾äº¤åª’ä½“
              </span>
              <span className="text-blue-600 font-semibold">+5 PNC</span>
            </Button>

            <Button
              variant="outline"
              className="w-full justify-between"
              onClick={() => window.location.href = '/credits/purchase'}
            >
              <span className="flex items-center gap-2">
                <Coins className="w-4 h-4 text-amber-500" />
                è´­ä¹°ç§¯åˆ†åŒ…
              </span>
              <span className="text-amber-600 font-semibold">æœ€å¿«</span>
            </Button>

            <Button
              variant="outline"
              className="w-full justify-between"
              onClick={() => window.location.href = '/pricing'}
            >
              <span className="flex items-center gap-2">
                <Star className="w-4 h-4 text-purple-500" />
                å‡çº§ä¼šå‘˜ (å…è´¹è®¿é—®)
              </span>
              <span className="text-purple-600 font-semibold">æ¨è</span>
            </Button>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}
```

---

## ğŸ“Š å®æ–½è·¯çº¿å›¾

### Phase 1: æ•°æ®åº“å’ŒåŸºç¡€æ¶æ„ (ç¬¬1å‘¨)

**ç›®æ ‡**: å»ºç«‹ç§¯åˆ†ç³»ç»Ÿçš„æ•°æ®åŸºç¡€

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º 6 ä¸ªæ ¸å¿ƒæ•°æ®è¡¨
- [ ] ä¸ºç°æœ‰è¡¨æ·»åŠ ç§¯åˆ†ç›¸å…³å­—æ®µ
- [ ] ç¼–å†™æ•°æ®åº“è¿ç§»è„šæœ¬
- [ ] ä¸ºæ‰€æœ‰ç°æœ‰ç”¨æˆ·åˆå§‹åŒ–ç§¯åˆ†è®°å½• (èµ é€200 PNC)
- [ ] é…ç½® Supabase RLS ç­–ç•¥
- [ ] ç¼–å†™æ•°æ®åº“è§¦å‘å™¨å’Œå‡½æ•°

**äº¤ä»˜ç‰©**:
- `sql/init-credits-system.sql` - å®Œæ•´åˆå§‹åŒ–è„šæœ¬
- `sql/migrate-existing-users.sql` - ç”¨æˆ·æ•°æ®è¿ç§»
- æ•°æ®åº“è®¾è®¡æ–‡æ¡£

---

### Phase 2: åç«¯ API å¼€å‘ (ç¬¬2-3å‘¨)

**ç›®æ ‡**: å®ç°æ‰€æœ‰ç§¯åˆ†ç›¸å…³ API

**Week 2 ä»»åŠ¡**:
- [ ] å®ç° `/api/credits/balance` - æŸ¥è¯¢ä½™é¢
- [ ] å®ç° `/api/credits/earn` - è·å¾—ç§¯åˆ†
- [ ] å®ç° `/api/credits/spend` - æ¶ˆè€—ç§¯åˆ†
- [ ] å®ç° `/api/credits/transactions` - å†å²è®°å½•
- [ ] ç¼–å†™ API å•å…ƒæµ‹è¯•

**Week 3 ä»»åŠ¡**:
- [ ] å®ç° `/api/credits/tasks` - ä»»åŠ¡ç³»ç»Ÿ
- [ ] å®ç° `/api/credits/transfer` - ç§¯åˆ†è½¬è´¦
- [ ] å®ç° `/api/credits/check-price` - ä»·æ ¼æŸ¥è¯¢
- [ ] å®ç° `/api/credits/purchase` - è´­ä¹°ç§¯åˆ†
- [ ] é›†æˆ Stripe æ”¯ä»˜

**äº¤ä»˜ç‰©**:
- 8 ä¸ª API ç«¯ç‚¹
- API æ–‡æ¡£ (Swagger/OpenAPI)
- æµ‹è¯•è¦†ç›–ç‡ >80%

---

### Phase 3: ä»»åŠ¡å’Œå¥–åŠ±ç³»ç»Ÿ (ç¬¬3-4å‘¨)

**ç›®æ ‡**: å®ç°ä»»åŠ¡é…ç½®å’Œè‡ªåŠ¨å¥–åŠ±

**ä»»åŠ¡æ¸…å•**:
- [ ] é…ç½®æ¯æ—¥ä»»åŠ¡ (ç­¾åˆ°ã€æµè§ˆã€åˆ†äº«ç­‰)
- [ ] å®ç°ç­¾åˆ°é€»è¾‘å’Œè¿ç»­ç­¾åˆ°å¥–åŠ±
- [ ] å®ç°æˆå°±ç³»ç»Ÿ
- [ ] åˆ›å»ºå¥–åŠ±æ± ç³»ç»Ÿ
- [ ] é…ç½®ä¼šå‘˜ç§¯åˆ†åŠ æˆ
- [ ] ç¼–å†™å®šæ—¶ä»»åŠ¡ (æ¯æ—¥é‡ç½®ã€å¥–åŠ±å‘æ”¾)

**äº¤ä»˜ç‰©**:
- ä»»åŠ¡é…ç½®æ•°æ®
- æˆå°±ç³»ç»Ÿ
- Cron Job è„šæœ¬

---

### Phase 4: å‰ç«¯ç»„ä»¶å¼€å‘ (ç¬¬4-5å‘¨)

**ç›®æ ‡**: å®ç°ç”¨æˆ·ä¾§ç§¯åˆ†ç•Œé¢

**Week 4 ä»»åŠ¡**:
- [ ] Header ç§¯åˆ†æ˜¾ç¤ºç»„ä»¶
- [ ] ç§¯åˆ†å˜åŠ¨åŠ¨ç”»ç»„ä»¶
- [ ] ç§¯åˆ†ä¸è¶³å¼¹çª—
- [ ] æ¯æ—¥ä»»åŠ¡é¢æ¿

**Week 5 ä»»åŠ¡**:
- [ ] ç§¯åˆ†å†å²é¡µé¢ (`/credits/history`)
- [ ] ç§¯åˆ†è´­ä¹°é¡µé¢ (`/credits/purchase`)
- [ ] ä»»åŠ¡ä¸­å¿ƒé¡µé¢ (`/tasks`)
- [ ] æˆå°±å±•ç¤ºé¡µé¢ (`/achievements`)

**äº¤ä»˜ç‰©**:
- 10+ React ç»„ä»¶
- 4 ä¸ªå®Œæ•´é¡µé¢
- å“åº”å¼è®¾è®¡

---

### Phase 5: å†…å®¹è®¿é—®æ§åˆ¶é›†æˆ (ç¬¬5-6å‘¨)

**ç›®æ ‡**: å°†ç§¯åˆ†ç³»ç»Ÿé›†æˆåˆ°å†…å®¹è®¿é—®æµç¨‹

**ä»»åŠ¡æ¸…å•**:
- [ ] ç­–ç•¥è¯¦æƒ…é¡µé›†æˆç§¯åˆ†æ£€æŸ¥
- [ ] å¥—åˆ©ä¿¡å·é¡µé›†æˆç§¯åˆ†æ£€æŸ¥
- [ ] æ–°é—»è¯¦æƒ…é¡µé›†æˆç§¯åˆ†æ£€æŸ¥
- [ ] èµ„æºä¸‹è½½é›†æˆç§¯åˆ†æ£€æŸ¥
- [ ] å®ç°å†…å®¹é¢„è§ˆåŠŸèƒ½
- [ ] å®ç°å·²è§£é”å†…å®¹å…è´¹è®¿é—®
- [ ] åœ¨ Directus ä¸­é…ç½®å†…å®¹ä»·æ ¼

**äº¤ä»˜ç‰©**:
- `useCreditsGate` Hook
- å†…å®¹è®¿é—®æ‹¦æˆªå™¨
- Directus ä»·æ ¼é…ç½®

---

### Phase 6: ä¼šå‘˜ç³»ç»Ÿæ•´åˆ (ç¬¬6å‘¨)

**ç›®æ ‡**: ç§¯åˆ†ç³»ç»Ÿä¸ä¼šå‘˜ä½“ç³»æ— ç¼å¯¹æ¥

**ä»»åŠ¡æ¸…å•**:
- [ ] é…ç½®ä¼šå‘˜ç§¯åˆ†åŠ æˆè§„åˆ™
- [ ] ä¼šå‘˜è´­ä¹°èµ é€ç§¯åˆ†
- [ ] ä¼šå‘˜å†…å®¹æŠ˜æ‰£ç³»ç»Ÿ
- [ ] æ›´æ–°ä¼šå‘˜ç‰¹æƒè¯´æ˜
- [ ] æ›´æ–° Pricing é¡µé¢

**äº¤ä»˜ç‰©**:
- ä¼šå‘˜ç§¯åˆ†è”åŠ¨
- æ›´æ–°çš„ Pricing é¡µé¢

---

### Phase 7: æ¸¸æˆåŒ–å’Œæ¿€åŠ±ä¼˜åŒ– (ç¬¬7å‘¨)

**ç›®æ ‡**: å¢å¼ºç”¨æˆ·å‚ä¸åº¦

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç°ç§¯åˆ†ç­‰çº§ç³»ç»Ÿ
- [ ] ç­‰çº§å¾½ç« å’Œç‰¹æ•ˆ
- [ ] æ¯å‘¨æŒ‘æˆ˜èµ›
- [ ] æ’è¡Œæ¦œé›†æˆ (ç§¯åˆ†æ¦œ)
- [ ] æ–°æ‰‹å¼•å¯¼æµç¨‹
- [ ] ç§¯åˆ†ä½¿ç”¨å»ºè®®ç³»ç»Ÿ

**äº¤ä»˜ç‰©**:
- ç­‰çº§ç³»ç»Ÿ
- æŒ‘æˆ˜èµ›ç³»ç»Ÿ
- æ–°æ‰‹å¼•å¯¼

---

### Phase 8: æµ‹è¯•å’Œä¼˜åŒ– (ç¬¬8å‘¨)

**ç›®æ ‡**: ç¡®ä¿ç³»ç»Ÿç¨³å®šå’Œå¹³è¡¡

**ä»»åŠ¡æ¸…å•**:
- [ ] å†…éƒ¨æµ‹è¯• (20äºº)
- [ ] å‹åŠ›æµ‹è¯• (æ¨¡æ‹Ÿ1000å¹¶å‘)
- [ ] å®‰å…¨æµ‹è¯• (é˜²åˆ·ç§¯åˆ†)
- [ ] æ”¶é›†åé¦ˆå¹¶è°ƒæ•´å‚æ•°
- [ ] ä¿®å¤ Bug
- [ ] æ€§èƒ½ä¼˜åŒ–

**äº¤ä»˜ç‰©**:
- æµ‹è¯•æŠ¥å‘Š
- Bug ä¿®å¤åˆ—è¡¨
- æ€§èƒ½ä¼˜åŒ–æŠ¥å‘Š

---

### Phase 9: ä¸Šçº¿å’Œç›‘æ§ (ç¬¬9å‘¨)

**ç›®æ ‡**: æ­£å¼å‘å¸ƒç§¯åˆ†ç³»ç»Ÿ

**ä»»åŠ¡æ¸…å•**:
- [ ] éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- [ ] å‘å¸ƒå…¬å‘Šå’Œæ•™ç¨‹
- [ ] è®¾ç½®æ•°æ®ç›‘æ§é¢æ¿
- [ ] é…ç½®å‘Šè­¦ç³»ç»Ÿ
- [ ] å‡†å¤‡åº”æ€¥å›æ»šæ–¹æ¡ˆ
- [ ] å®¢æœåŸ¹è®­

**äº¤ä»˜ç‰©**:
- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- ç”¨æˆ·æ–‡æ¡£å’ŒFAQ
- ç›‘æ§Dashboard

---

## âš ï¸ é£é™©è¯„ä¼°ä¸åº”å¯¹

### é£é™©1: ç§¯åˆ†é€šèƒ€

**é£é™©æè¿°**: ç§¯åˆ†äº§å‡ºè¿‡å¤š,å¯¼è‡´ç§¯åˆ†è´¬å€¼

**åº”å¯¹ç­–ç•¥**:
1. ä¸¥æ ¼æ§åˆ¶æ¯æ—¥è·å–ä¸Šé™
2. å®šæœŸè°ƒæ•´ä»»åŠ¡å¥–åŠ±
3. å¼•å…¥ç§¯åˆ†é”€æ¯æœºåˆ¶ (æ¶ˆè´¹ç§¯åˆ†50%é”€æ¯)
4. ç›‘æ§ç§¯åˆ†æ€»é‡,åŠæ—¶è°ƒæ•´

### é£é™©2: æ¶æ„åˆ·ç§¯åˆ†

**é£é™©æè¿°**: ç”¨æˆ·é€šè¿‡è„šæœ¬æˆ–å°å·åˆ·ç§¯åˆ†

**åº”å¯¹ç­–ç•¥**:
1. æ·»åŠ  Google reCAPTCHA
2. è¡Œä¸ºæ£€æµ‹ç®—æ³• (å¼‚å¸¸é¢‘ç‡æ£€æµ‹)
3. IPé™æµå’Œè®¾å¤‡æŒ‡çº¹
4. äººå·¥å®¡æ ¸æœºåˆ¶
5. å°ç¦ä½œå¼Šè´¦å·,æ‰£é™¤éæ³•ç§¯åˆ†

### é£é™©3: ç§¯åˆ†ç³»ç»Ÿå½±å“ä¼šå‘˜é”€å”®

**é£é™©æè¿°**: ç”¨æˆ·é€šè¿‡ç§¯åˆ†æ»¡è¶³éœ€æ±‚,ä¸å†è´­ä¹°ä¼šå‘˜

**åº”å¯¹ç­–ç•¥**:
1. ä¼šå‘˜ä¸“å±å†…å®¹ (ç§¯åˆ†æ— æ³•è§£é”)
2. ä¼šå‘˜è·å¾—ç§¯åˆ†åŠ æˆå’ŒæŠ˜æ‰£
3. è®¾ç½®ç§¯åˆ†è·å–ä¸Šé™
4. å¼ºè°ƒä¼šå‘˜é•¿æœŸä»·å€¼
5. ç§¯åˆ†ä¸ä¼šå‘˜äº’è¡¥è€Œéæ›¿ä»£

### é£é™©4: æ•°æ®åº“æ€§èƒ½é—®é¢˜

**é£é™©æè¿°**: ç§¯åˆ†æµæ°´è¡¨æ•°æ®é‡å¤§,æŸ¥è¯¢æ…¢

**åº”å¯¹ç­–ç•¥**:
1. åˆ†è¡¨ç­–ç•¥ (æŒ‰æœˆåˆ†è¡¨)
2. ç´¢å¼•ä¼˜åŒ–
3. Redisç¼“å­˜ç”¨æˆ·ä½™é¢
4. å½’æ¡£å†å²æ•°æ®
5. å¼‚æ­¥å†™å…¥æµæ°´

### é£é™©5: ç”¨æˆ·ä½“éªŒé—®é¢˜

**é£é™©æè¿°**: ç§¯åˆ†ç³»ç»Ÿè¿‡äºå¤æ‚,æ–°ç”¨æˆ·ä¸ç†è§£

**åº”å¯¹ç­–ç•¥**:
1. ç®€åŒ–è§„åˆ™,æ¸…æ™°æ–‡æ¡£
2. æ–°æ‰‹å¼•å¯¼æµç¨‹
3. å¯è§†åŒ–å±•ç¤º (è¿›åº¦æ¡ã€åŠ¨ç”»)
4. åŠæ—¶åé¦ˆ (Toastæç¤º)
5. å®¢æœæ”¯æŒå’ŒFAQ

---

## ğŸ“ˆ æ•°æ®ç›‘æ§æŒ‡æ ‡

### å…³é”®æŒ‡æ ‡ (KPI)

| æŒ‡æ ‡ç±»åˆ« | å…·ä½“æŒ‡æ ‡ | ç›®æ ‡å€¼ | ç›‘æ§é¢‘ç‡ |
|---------|---------|--------|---------|
| **ç”¨æˆ·æ´»è·ƒ** | DAU | +30% | æ¯æ—¥ |
| | MAU | +25% | æ¯å‘¨ |
| | å¹³å‡åœç•™æ—¶é—´ | +40% | æ¯æ—¥ |
| **ç§¯åˆ†å¹³è¡¡** | ç§¯åˆ†æ€»é‡ | ç¨³å®šå¢é•¿ | æ¯æ—¥ |
| | æ¯æ—¥äº§å‡º/æ¶ˆè€—æ¯” | 1.1-1.3 | æ¯æ—¥ |
| | å¹³å‡ç”¨æˆ·ä½™é¢ | 300-800 | æ¯å‘¨ |
| **ä»»åŠ¡å®Œæˆ** | ç­¾åˆ°ç‡ | >60% | æ¯æ—¥ |
| | ä»»åŠ¡å®Œæˆç‡ | >40% | æ¯æ—¥ |
| | æˆå°±è§£é”ç‡ | >20% | æ¯å‘¨ |
| **å•†ä¸šä»·å€¼** | ç§¯åˆ†è´­ä¹°è½¬åŒ–ç‡ | >5% | æ¯å‘¨ |
| | ä¼šå‘˜è½¬åŒ–ç‡ | >8% | æ¯å‘¨ |
| | ARPU | +15% | æ¯æœˆ |

---

## ğŸ“š é™„å½•

### A. ç§¯åˆ†åŒ…å®šä»·æ–¹æ¡ˆ

```typescript
const CREDITS_PACKAGES = [
  {
    id: 'starter',
    name: 'æ–°æ‰‹ç¤¼åŒ…',
    credits: 500,
    bonus: 50,
    price_usd: 4.99,
    badge: 'ğŸ',
    popular: false,
  },
  {
    id: 'basic',
    name: 'åŸºç¡€åŒ…',
    credits: 1000,
    bonus: 150,
    price_usd: 9.99,
    badge: 'ğŸª™',
    popular: true,
  },
  {
    id: 'premium',
    name: 'è¶…å€¼åŒ…',
    credits: 3000,
    bonus: 600,
    price_usd: 24.99,
    badge: 'ğŸ’',
    popular: false,
    discount: '20% OFF',
  },
  {
    id: 'ultimate',
    name: 'è‡³å°ŠåŒ…',
    credits: 10000,
    bonus: 3000,
    price_usd: 79.99,
    badge: 'ğŸ‘‘',
    popular: false,
    discount: '30% OFF',
  },
];
```

### B. å†…å®¹å®šä»·å‚è€ƒ

| å†…å®¹ç±»å‹ | å»ºè®®ä»·æ ¼ | ä»·æ ¼åŒºé—´ | å®šä»·ä¾æ® |
|---------|---------|---------|---------|
| æ–°æ‰‹ç­–ç•¥ | 5-10 | 5-20 | å†…å®¹æ·±åº¦ |
| ä¸­çº§ç­–ç•¥ | 15-30 | 10-50 | å†…å®¹ä»·å€¼ |
| é«˜çº§ç­–ç•¥ | 40-80 | 30-150 | ç¨€ç¼ºæ€§ |
| å¥—åˆ©ä¿¡å· | 20-50 | 15-100 | æ—¶æ•ˆæ€§ |
| æ·±åº¦æŠ¥å‘Š | 50-100 | 30-200 | ç ”ç©¶æˆæœ¬ |
| ç‹¬å®¶å…«å¦ | 10-20 | 5-50 | çˆ†æ–™ç¨‹åº¦ |

### C. ç¯å¢ƒå˜é‡é…ç½®

```bash
# .env.local

# ç§¯åˆ†ç³»ç»Ÿé…ç½®
CREDITS_INITIAL_BALANCE=200
CREDITS_DAILY_SIGNIN_REWARD=10
CREDITS_REFERRAL_REWARD=50

# ä¼šå‘˜ç§¯åˆ†åŠ æˆ
MEMBERSHIP_PRO_MULTIPLIER=1.2
MEMBERSHIP_PREMIUM_MULTIPLIER=1.5
MEMBERSHIP_PARTNER_MULTIPLIER=2.0

# æ¯æ—¥è·å–ä¸Šé™
CREDITS_DAILY_LIMIT_FREE=1000
CREDITS_DAILY_LIMIT_PRO=1500
CREDITS_DAILY_LIMIT_PREMIUM=2500
CREDITS_DAILY_LIMIT_PARTNER=5000

# Stripe ç§¯åˆ†è´­ä¹°
STRIPE_CREDITS_PRODUCT_ID=prod_xxx
```

---

## âœ… å¼€å‘æ¸…å•

### æ•°æ®åº“ (10é¡¹)
- [ ] user_credits è¡¨
- [ ] credit_transactions è¡¨
- [ ] credit_tasks è¡¨
- [ ] user_task_progress è¡¨
- [ ] credit_rewards_pool è¡¨
- [ ] user_unlocked_content è¡¨
- [ ] strategies è¡¨æ‰©å±•
- [ ] arbitrage è¡¨æ‰©å±•
- [ ] åˆå§‹åŒ–è„šæœ¬
- [ ] RLS ç­–ç•¥é…ç½®

### API (8é¡¹)
- [ ] GET /api/credits/balance
- [ ] POST /api/credits/earn
- [ ] POST /api/credits/spend
- [ ] POST /api/credits/transfer
- [ ] GET /api/credits/transactions
- [ ] GET /api/credits/tasks
- [ ] POST /api/credits/check-price
- [ ] POST /api/credits/purchase

### å‰ç«¯ç»„ä»¶ (12é¡¹)
- [ ] CreditsBalance (Header)
- [ ] CreditsTransactionToast
- [ ] DailyTasksPanel
- [ ] InsufficientCreditsDialog
- [ ] CreditsHistory Page
- [ ] CreditsPurchase Page
- [ ] TasksCenter Page
- [ ] Achievements Page
- [ ] useCreditsGate Hook
- [ ] useCreditsBalance Hook
- [ ] Level Badge Component
- [ ] Achievement Badge Component

### åŠŸèƒ½é›†æˆ (8é¡¹)
- [ ] ç­–ç•¥è¯¦æƒ…é¡µç§¯åˆ†æ£€æŸ¥
- [ ] å¥—åˆ©ä¿¡å·é¡µç§¯åˆ†æ£€æŸ¥
- [ ] æ–°é—»è¯¦æƒ…é¡µç§¯åˆ†æ£€æŸ¥
- [ ] èµ„æºä¸‹è½½ç§¯åˆ†æ£€æŸ¥
- [ ] ä¼šå‘˜ç§¯åˆ†åŠ æˆ
- [ ] ç­¾åˆ°ç³»ç»Ÿ
- [ ] æˆå°±ç³»ç»Ÿ
- [ ] æŒ‘æˆ˜èµ›ç³»ç»Ÿ

### æµ‹è¯• (6é¡¹)
- [ ] API å•å…ƒæµ‹è¯•
- [ ] ç»„ä»¶å•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯•
- [ ] å‹åŠ›æµ‹è¯•
- [ ] å®‰å…¨æµ‹è¯•
- [ ] ç”¨æˆ·æµ‹è¯•

### æ–‡æ¡£ (5é¡¹)
- [ ] API æ–‡æ¡£
- [ ] ç”¨æˆ·ä½¿ç”¨æŒ‡å—
- [ ] ç®¡ç†å‘˜æ“ä½œæ‰‹å†Œ
- [ ] FAQ
- [ ] å¼€å‘æ–‡æ¡£

**æ€»è®¡**: 49 é¡¹ä»»åŠ¡

---

## ğŸ‰ æ€»ç»“

PlayNew.ai ç§¯åˆ†ç³»ç»Ÿè®¾è®¡å®Œæˆï¼

### æ ¸å¿ƒç‰¹ç‚¹

âœ… **å®Œæ•´æ€§** - æ¶µç›–è·å–ã€æ¶ˆè€—ã€è½¬è´¦ã€ç­‰çº§ã€ä»»åŠ¡ã€æˆå°±å…¨æµç¨‹
âœ… **çµæ´»æ€§** - æ”¯æŒåŠ¨æ€å®šä»·ã€ä¼šå‘˜æŠ˜æ‰£ã€ä¿ƒé”€æ´»åŠ¨
âœ… **å¯æ‰©å±•** - é¢„ç•™å¥–åŠ±æ± ã€æŒ‘æˆ˜èµ›ã€P2Päº¤æ˜“ç­‰é«˜çº§åŠŸèƒ½
âœ… **å®‰å…¨æ€§** - é˜²åˆ·æœºåˆ¶ã€æ¯æ—¥ä¸Šé™ã€è¡Œä¸ºæ£€æµ‹
âœ… **å•†ä¸šä»·å€¼** - ä¸ä¼šå‘˜ä½“ç³»ååŒ,å¤šå±‚æ¬¡å˜ç°
âœ… **ç”¨æˆ·ä½“éªŒ** - æ¸¸æˆåŒ–è®¾è®¡,æ¸…æ™°åé¦ˆ,ç®€å•æ˜“æ‡‚

### é¢„æœŸæ•ˆæœ

- ğŸ“ˆ DAUæå‡ 30%+
- ğŸ’° ARPUæå‡ 15%+
- ğŸ† å†…å®¹æ¶ˆè´¹é‡æå‡ 50%+
- â­ ç”¨æˆ·ç•™å­˜ç‡æå‡ 25%+

**å¼€å§‹å¼€å‘å§ï¼** ğŸš€

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**æœ€åæ›´æ–°**: 2025-11-16
**ä½œè€…**: Claude Code (Anthropic)
**é¡¹ç›®çŠ¶æ€**: ğŸ“‹ Ready for Development
