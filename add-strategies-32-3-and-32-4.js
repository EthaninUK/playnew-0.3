// ç­–ç•¥ 32.3 & 32.4: è¡ç”Ÿå“ç­–ç•¥ (Derivatives Strategies) - æœŸæƒå–æ–¹/åšå¸‚ (Options Selling / MM)

const axios = require('axios');

/**
 * 32.3 Delta ä¸­æ€§æœŸæƒç­–ç•¥ï¼ˆShort Strangleï¼‰
 *
 * ä¸€çº§åˆ†ç±»: è¡ç”Ÿå“ç­–ç•¥ (Derivatives Strategies)
 * category_l1: derivatives
 * category: options-selling
 * category_l2: options-selling
 */
const STRATEGY_32_3 = {
  title:
    'Delta ä¸­æ€§æœŸæƒç­–ç•¥ï¼ˆShort Strangleï¼‰- åœ¨çª„å¹…éœ‡è¡ä¸­æ”¶åŒè¾¹æƒåˆ©é‡‘',
  slug: 'delta-neutral-short-strangle',
  summary:
    'ä»¥ BTC/ETH ç­‰å¤§ç›˜å¸ä¸ºåŸºç¡€èµ„äº§ï¼Œå›´ç»•â€œå–å‡ºè™šå€¼çœ‹æ¶¨ + å–å‡ºè™šå€¼çœ‹è·Œâ€çš„ Short Strangle ç»“æ„ï¼Œé€šè¿‡æ§åˆ¶ Delta æ¥è¿‘ä¸­æ€§ã€åŠ¨æ€å¯¹å†²æ–¹å‘é£é™©ï¼Œåœ¨æ ‡çš„ä»·æ ¼çª„å¹…éœ‡è¡æˆ–æ¸©å’Œæ³¢åŠ¨çš„ç¯å¢ƒä¸­èµšå–åŒè¾¹æƒåˆ©é‡‘ä¸æ—¶é—´ä»·å€¼ï¼ˆThetaï¼‰ã€‚ç­–ç•¥çš„æ ¸å¿ƒæ”¶ç›Šæ¥è‡ªâ€œæ—¶é—´è¡°å‡ + æ³¢åŠ¨ç‡å›å½’â€ï¼Œè€Œä¸»è¦é£é™©åœ¨äºæç«¯å•è¾¹è¡Œæƒ…å’Œéšå«æ³¢åŠ¨ç‡æš´æ¶¨ï¼Œéœ€è¦é…å¥—ä¸¥æ ¼çš„ Gamma/Vega é£æ§ä¸ Delta å¯¹å†²æœºåˆ¶ã€‚',
  category: 'options-selling',
  category_l1: 'derivatives',
  category_l2: 'options-selling',
  risk_level: 4,
  apy_min: 12,
  apy_max: 80,
  min_investment: 5000,
  time_commitment:
    'å‰æœŸ 2-4 å‘¨æ‰“ç£¨æ¨¡å‹ä¸é£æ§ï¼Œä¹‹åæ¯æ—¥éœ€å…³æ³¨ä»“ä½å’Œæ³¢åŠ¨ç‡å˜åŒ–ï¼ˆä¸­é«˜é¢‘ç›‘æ§ï¼‰',
  status: 'published',
  content: `# 32.3 Delta ä¸­æ€§æœŸæƒç­–ç•¥ï¼ˆShort Strangleï¼‰- åœ¨çª„å¹…éœ‡è¡ä¸­æ”¶åŒè¾¹æƒåˆ©é‡‘

> âš ï¸ é«˜çº§è­¦å‘Š  
> - æœ¬ç­–ç•¥å±äº**æœŸæƒå–æ–¹ + ä¸»åŠ¨å¯¹å†²ç±»å¤æ‚ç­–ç•¥**ï¼›  
> - éœ€è¦ç†è§£ Delta/Gamma/Vega/Theta ç­‰å¸Œè…Šå­—æ¯å«ä¹‰ï¼›  
> - ä¸¥æ ¼æ„ä¹‰ä¸Šæ›´é€‚åˆåŠä¸“ä¸š/ä¸“ä¸šäº¤æ˜“è€…ä¸é‡åŒ–å›¢é˜Ÿï¼›  
> - å¯¹é£é™©ç®¡ç†è¦æ±‚æé«˜ï¼Œå°¤å…¶æ˜¯åœ¨æç«¯å•è¾¹è¡Œæƒ…ä¸­ã€‚  

---

## ğŸ’° ç­–ç•¥æ¦‚è§ˆ

| å‚æ•°              | æ•°å€¼/è¯´æ˜ |
|-------------------|-----------|
| **åŸºç¡€èµ„äº§**      | BTCã€ETH æˆ–å…¶ä»–æµåŠ¨æ€§å……è¶³çš„ä¸»æµå¸æœŸæƒ |
| **ç­–ç•¥ç»“æ„**      | Short Strangleï¼šå–å‡ºè™šå€¼ Call + å–å‡ºè™šå€¼ Put |
| **æ–¹å‘è§‚ç‚¹**      | çŸ­æœŸå¯¹æ–¹å‘**ä¸å¼ºçƒˆè¡¨æ€**ï¼Œè®¤ä¸ºæ ‡çš„å¤šåœ¨åŒºé—´å†…éœ‡è¡ |
| **æ³¢åŠ¨ç‡è§‚ç‚¹**    | éšå«æ³¢åŠ¨ç‡ï¼ˆIVï¼‰ç›¸å¯¹åé«˜ï¼Œé¢„æœŸæœªæ¥ä¸€æ®µæ—¶é—´æ³¢åŠ¨ç‡å›è½æˆ–ç¨³å®š |
| **æ ¸å¿ƒæ”¶ç›Šæ¥æº**  | æ—¶é—´ä»·å€¼è¡°å‡ï¼ˆThetaï¼‰ã€é«˜ä¼° IV å›å½’ã€å…¬å…ä»·å·® |
| **å…³é”®é£é™©**      | æç«¯å•è¾¹è¡Œæƒ…ï¼ˆGamma é£é™©ï¼‰ã€IV æš´æ¶¨ï¼ˆVega é£é™©ï¼‰ã€æµåŠ¨æ€§é£é™© |
| **é€‚ç”¨äººç¾¤**      | ç†è§£æœŸæƒå®šä»·é€»è¾‘ã€æœ‰ä¸€å®šå®ç›˜ç»éªŒçš„ä¸­é«˜é˜¶ç©å®¶/é‡åŒ–å›¢é˜Ÿ |

---

## ğŸ“– åœºæ™¯æ•…äº‹ï¼šä½ å¹¶ä¸æƒ³çŒœæ–¹å‘ï¼Œåªæƒ³èµšâ€œåˆ«äººææƒ§çš„ä»·æ ¼â€

å‡è®¾å½“å‰å¸‚åœºç¯å¢ƒå¦‚ä¸‹ï¼ˆä»…ç¤ºæ„ï¼‰ï¼š

- BTC åœ¨ 60,000 USDT é™„è¿‘åå¤æ‹‰æ‰¯ï¼ŒçŸ­æœŸå†…æ²¡æœ‰æ˜æ˜¾è¶‹åŠ¿ï¼›
- å¸‚åœºåˆšç»å†ä¸€è½®æš´æ¶¨/æš´è·Œï¼Œå¤§å®¶å¯¹æœªæ¥æ³¢åŠ¨å¾ˆææ…Œï¼Œéšå«æ³¢åŠ¨ç‡åé«˜ï¼›
- ä½ è‡ªå·±çš„åˆ¤æ–­æ˜¯ï¼š  
  - æ¥ä¸‹æ¥ 1 ä¸ªæœˆï¼ŒBTC å¯èƒ½ä¼šåœ¨ 52,000 - 68,000 åŒºé—´å†…éœ‡è¡ï¼›  
  - ä¸å¤ªå¯èƒ½å†ç«‹å³å‡ºç°ç±»ä¼¼ 50% çš„æç«¯å¤§è¡Œæƒ…ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä½ ï¼š

- å•çº¯åšå¤šæ–¹å‘ï¼ˆBuy Call/Buy Futuresï¼‰ï¼š  
  - éœ€è¦èµŒæ–¹å‘å’Œå¹…åº¦ï¼Œä¸€æ—¦åˆ¤æ–­é”™ï¼Œå¯èƒ½äºæŸï¼›  
- å•çº¯ç©ºæ–¹å‘ï¼ˆShort Futuresï¼‰ï¼š  
  - ä¸€æ—¦å¸‚åœºæ…¢æ¶¨æˆ–å†æ¶¨ä¸€è½®ï¼Œå¯èƒ½çˆ†ä»“ï¼›  

ä½ ä¼šäº§ç”Ÿä¸€ä¸ªæƒ³æ³•ï¼š

> â€œå¦‚æœæˆ‘ä¸çŒœæ–¹å‘ï¼Œåªåšä¸€ä¸ªâ€˜åœ¨ä¸€å®šåŒºé—´å†…éƒ½èµšé’±â€™çš„ç»“æ„ï¼Œ  
>  å¹¶ä¸”é€šè¿‡å¯¹å†²æ§åˆ¶æ–¹å‘é£é™©ï¼Œ  
>  åªèµšå¸‚åœºæ„¿æ„ä¸ºæ³¢åŠ¨ä¸ç¡®å®šæ€§ä»˜å‡ºçš„æƒåˆ©é‡‘ï¼Œå¦‚ä½•ï¼Ÿâ€

è¿™å°±æ˜¯ Delta ä¸­æ€§ Short Strangle çš„æ ¸å¿ƒï¼š

- **ç»“æ„**ï¼š  
  - å–å‡ºä¸€å¼ è™šå€¼çœ‹æ¶¨æœŸæƒï¼ˆOut-of-the-money Callï¼‰  
  - å–å‡ºä¸€å¼ è™šå€¼çœ‹è·ŒæœŸæƒï¼ˆOut-of-the-money Putï¼‰  
- **Delta ç®¡ç†**ï¼š  
  - ä½¿ç”¨æœŸè´§/ç°è´§å¤´å¯¸åŠ¨æ€è°ƒæ•´ï¼Œè®©ç»„åˆæ•´ä½“ Delta æ¥è¿‘ 0ï¼›  
- **é¢„æœŸ**ï¼š  
  - åªè¦æ ‡çš„èµ„äº§ä»·æ ¼åœ¨ä¸€æ®µæ—¶é—´å†…ä¸å‘ç”Ÿå‰§çƒˆå•è¾¹ç ´ä½ï¼Œ  
    åŒè¾¹æœŸæƒçš„æ—¶é—´ä»·å€¼ä¼šè‡ªç„¶è¡°å‡ â†’ ä½ èµšæƒåˆ©é‡‘ã€‚

---

## ğŸ§  ç­–ç•¥æ ¸å¿ƒé€»è¾‘æ‹†è§£

### 1ï¸âƒ£ ç»“æ„å½¢æ€ï¼šShort Strangle æ˜¯ä»€ä¹ˆï¼Ÿ

Short Strangle =

\`\`\`text
Short OTM Call + Short OTM Put
ï¼ˆä¸¤ç«¯éƒ½å–å‡ºä¸€ä¸ªè™šå€¼æœŸæƒï¼‰
\`\`\`

ç®€å•ç¤ºæ„ï¼š

- å½“å‰ BTC = 60,000 USDT
- ä½ å–å‡ºï¼š  
  - Callï¼šæ‰§è¡Œä»· 70,000ï¼Œæ”¶ 1,000 USDT æƒåˆ©é‡‘  
  - Putï¼šæ‰§è¡Œä»· 50,000ï¼Œæ”¶ 1,200 USDT æƒåˆ©é‡‘  
- æ€»å…±æ”¶åˆ°æƒåˆ©é‡‘ = 2,200 USDT

**åˆ°æœŸæ—¶æ”¶ç›Šè½®å»“ï¼š**

- è‹¥ BTC æ”¶åœ¨ 50,000 ~ 70,000 åŒºé—´å†…ï¼š  
  - ä¸¤ä¸ªæœŸæƒéƒ½å˜ä¸ºè™šå€¼ï¼Œåˆ°æœŸä½œåºŸï¼›  
  - ä½ ä¿ç•™å…¨éƒ¨ 2,200 USDT æƒåˆ©é‡‘ï¼ˆå¿½ç•¥æ‰‹ç»­è´¹ï¼‰ï¼›  

- è‹¥ BTC æ”¶åœ¨åŒºé—´å¤–ï¼š  
  - å‘ä¸Šçªç ´ 70,000ï¼š  
    - Call ä¼šå‡ºç°äºæŸï¼›  
    - Put ä½œåºŸï¼›  
  - å‘ä¸‹è·Œç ´ 50,000ï¼š  
    - Put ä¼šå‡ºç°äºæŸï¼›  
    - Call ä½œåºŸï¼›  

äºæŸæ”¾å¤§çš„æ–¹å‘ï¼šâ€œèµ°å¾—è¶Šè¿œï¼Œäºå¾—è¶Šå¤šâ€ã€‚

### 2ï¸âƒ£ Delta ä¸­æ€§çš„æ„ä¹‰

å¦‚æœä½ åªæ˜¯â€œè£¸å–â€ Call å’Œ Putï¼š

- åœ¨æ ‡çš„å¿«é€Ÿå•è¾¹è¿åŠ¨æ—¶ï¼ˆæ¯”å¦‚è¿ç»­å¤§æ¶¨æˆ–å¤§è·Œï¼‰ï¼Œ  
  ä½ çš„ç»„åˆä¼šå‡ºç°å·¨å¤§æ–¹å‘æ•å£ï¼ˆDelta å¤§å¹…åç¦» 0ï¼‰ï¼›  
- æ¢è¨€ä¹‹ï¼Œä½ ä¸ä»…åœ¨å–æ³¢åŠ¨ç‡ï¼Œè¿˜åœ¨ **è¢«åŠ¨æŠ¼æ–¹å‘**ã€‚

**Delta ä¸­æ€§** çš„åšæ³•æ˜¯ï¼š

- åœ¨å–å‡º Strangle çš„åŒæ—¶ï¼Œé…åˆæœŸè´§/ç°è´§å¤´å¯¸ï¼Œ  
  è®©ç»„åˆæ•´ä½“ Delta â‰ˆ 0ï¼›  
- å½“ä»·æ ¼æ³¢åŠ¨ä½¿ Delta åç§»æ—¶ï¼Œ  
  é€šè¿‡ä¹°å–æœŸè´§è¿›è¡Œå¯¹å†² â†’ é‡æ–°æ‹‰å› Delta ä¸­æ€§ã€‚

è¿™æ ·ï¼š

- ä½ ä¸»è¦æ‰¿æ‹…çš„æ˜¯ Gamma/Vega é£é™©ï¼Œè€Œä¸æ˜¯å•çº¯æ–¹å‘é£é™©ï¼›  
- å½“ä»·æ ¼åœ¨åŒºé—´å†…æ¥å›éœ‡è¡æ—¶ï¼Œ  
  ä½ çš„ Delta å¯¹å†²äº¤æ˜“æœ¬èº«å¯èƒ½â€œä½ä¹°é«˜å–â€ï¼Œ  
  è¿›ä¸€æ­¥è´¡çŒ® Alphaã€‚

---

## ğŸ§© å®æˆ˜è®¾è®¡ç»´åº¦ï¼šå…­ä¸ªå…³é”®é—®é¢˜

### 1ï¸âƒ£ é€‰å“ªä¸ªæ ‡çš„ï¼ˆUnderlyingsï¼‰ï¼Ÿ

- é€šå¸¸é€‰æ‹©æµåŠ¨æ€§å¥½ã€æœŸæƒå¸‚åœºæˆç†Ÿçš„èµ„äº§ï¼š  
  - BTC  
  - ETH  
  - æˆ–å…¶ä»–å¤´éƒ¨å¸åœ¨ Deribit ç­‰å¹³å°çš„æœŸæƒåˆçº¦

### 2ï¸âƒ£ é€‰å¤šè¿œçš„æ‰§è¡Œä»·ï¼ˆStrikeï¼‰ï¼Ÿ

å…¸å‹åšæ³•ï¼š

- åœ¨å½“å‰ä»·æ ¼ä¸Šä¸‹å„ 10-20% çš„ OTM ä½ç½®å–å‡ºæœŸæƒï¼›  
- ä¾‹å¦‚ BTC=60,000ï¼š  
  - å–å‡º Callï¼šStrike = 70,000ï¼ˆ+16.7%ï¼‰  
  - å–å‡º Putï¼šStrike = 50,000ï¼ˆ-16.7%ï¼‰  

ä½ ä¼šåœ¨å˜é‡ä¸­å¹³è¡¡ï¼š

- æ”¶åˆ°çš„æƒåˆ©é‡‘å¤§å°ï¼›  
- åˆ°æœŸå‰è¢«çªç ´çš„æ¦‚ç‡ï¼›  
- è‡ªå·±èƒ½æ¥å—çš„æœ€å¤§äºæŸèŒƒå›´ã€‚

### 3ï¸âƒ£ é€‰å¤šé•¿çš„åˆ°æœŸæ—¥ï¼ˆTenorï¼‰ï¼Ÿ

- 7-14 å¤©ï¼š  
  - Theta å¾ˆé›†ä¸­ï¼Œæƒåˆ©é‡‘è¡°å‡å¿«ï¼›  
  - è°ƒä»“ä¸å¯¹å†²é¢‘ç‡è¾ƒé«˜ï¼›  

- 30 å¤©ï¼š  
  - æ”¶åˆ°çš„æ€»æƒåˆ©é‡‘æ›´å¯è§‚ï¼›  
  - å¯¹å¸‚åœºæ³¢åŠ¨çš„æš´éœ²æ—¶é—´æ›´é•¿ï¼Œéœ€æ›´å¼ºé£æ§ã€‚

è®¸å¤šé‡åŒ–å›¢é˜Ÿå¸¸ç”¨ 7-30 å¤©åŒºé—´çš„åˆçº¦ï¼Œ  
å¹¶é€šè¿‡â€œæ»šåŠ¨å–å‡º + åŠ¨æ€å¯¹å†²â€çš„æ–¹å¼ç»´æŒç»„åˆã€‚

### 4ï¸âƒ£ å¦‚ä½•å¤„ç† Delta å¯¹å†²ï¼Ÿ

å¸¸è§æ‰‹æ®µï¼š

- ä½¿ç”¨æ°¸ç»­åˆçº¦æˆ–è¿‘æœŸäº¤å‰²åˆçº¦å¯¹å†²ï¼›  
- æ ¹æ®ç»„åˆ Delta å˜åŒ–ï¼Œè®¾å®šå¯¹å†²é˜ˆå€¼ï¼š  
  - å½“ \`|Delta| > Delta_Threshold\` æ—¶ï¼Œå¯¹å†²ä¸€æ¬¡ï¼›  
- æ§åˆ¶å¯¹å†²é¢‘ç‡ï¼š  
  - å¤ªé¢‘ç¹ä¼šå¢åŠ æ‰‹ç»­è´¹ä¸æ»‘ç‚¹ï¼›  
  - å¤ªå°‘åˆå¯èƒ½è®©æ–¹å‘é£é™©å¤±æ§ã€‚

### 5ï¸âƒ£ å¦‚ä½•ç®¡ç† Gamma é£é™©ï¼Ÿ

Gamma é«˜çš„æ—¶æœŸï¼š

- ä¸´è¿‘åˆ°æœŸï¼›  
- æ‰§è¡Œä»·é™„è¿‘ï¼›  
- æ³¢åŠ¨ç‡ä¸Šå‡ï¼›  

åº”å¯¹æ‰‹æ®µï¼š

- å½“æ ‡çš„ä»·æ ¼é è¿‘æŸä¸€è¾¹çš„æ‰§è¡Œä»·æ—¶ï¼š  
  - å¯ä»¥è€ƒè™‘æå‰å¹³æ‰è¯¥è¾¹æœŸæƒï¼›  
  - æˆ–æ•´ä½“å‡ä»“ï¼Œç¼©å° Strangle ä»“ä½ï¼›  
- å¯¹æç«¯è¡Œæƒ…ï¼Œè®¾ç½®æ˜ç¡®çš„äºæŸä¸Šé™ï¼š  
  - ä¾‹å¦‚æŒ‰æ•´ä½“ç­–ç•¥èµ„é‡‘çš„æŸä¸€æ¯”ä¾‹æ­¢æŸã€‚

### 6ï¸âƒ£ Vega é£é™©ï¼šæ³¢åŠ¨ç‡å˜åŒ–çš„å½±å“

- å–æ–¹åœ¨éšå«æ³¢åŠ¨ç‡ä¸Šå‡æ—¶ä¼šå‡ºç°æµ®äºï¼›  
- è‹¥ä½ çš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šâ€œå½“å‰æ³¢åŠ¨ç‡åé«˜ï¼Œæœªæ¥å¤§æ¦‚ç‡å›è½â€ï¼Œ  
  åˆ™åº”é¿å…åœ¨â€œæ³¢åŠ¨ç‡å·²ç»è¢«ç ¸å¾—å¾ˆä½â€æ—¶å‹‰å¼ºå–æ–¹ï¼›  
- å¯é…åˆéƒ¨åˆ†å¤šå¤´æœŸæƒï¼ˆLong Vegaï¼‰ä½œä¸ºå¯¹å†²ï¼Œä¾‹å¦‚é€‚é‡ä¹°å…¥æ·±è™šå€¼æœŸæƒä¿æŠ¤å°¾éƒ¨é£é™©ã€‚

---

## ğŸ› ï¸ ç®€æ˜“ Short Strangle + Delta ä¸­æ€§æ”¶ç›Šæ¨¡æ‹Ÿå™¨ï¼ˆç¤ºæ„ï¼‰

> ä¸‹é¢æ˜¯ä¸€ä¸ª**éå¸¸ç®€åŒ–**çš„ Short Strangle payoff æ¨¡å‹ï¼Œ  
> ç”¨äºç›´è§‚å±•ç¤ºç»„åˆåœ¨ä¸åŒåˆ°æœŸä»·æ ¼ä¸‹çš„ç›ˆäºæƒ…å†µï¼ˆä¸å«åŠ¨æ€å¯¹å†²æ”¶ç›Šï¼‰ã€‚

\`\`\`javascript
class ShortStrangleSimulator {
  /**
   * @param {number} spotEntry         åˆå§‹æ ‡çš„ä»·æ ¼
   * @param {number} callStrike        å–å‡º Call çš„æ‰§è¡Œä»·
   * @param {number} callPremium       å–å‡º Call æ”¶åˆ°çš„æƒåˆ©é‡‘
   * @param {number} putStrike         å–å‡º Put çš„æ‰§è¡Œä»·
   * @param {number} putPremium        å–å‡º Put æ”¶åˆ°çš„æƒåˆ©é‡‘
   * @param {number} contracts         å¼ æ•°ï¼ˆå‡è®¾æ¯å¼ å¯¹åº” 1 å•ä½æ ‡çš„ï¼‰
   */
  constructor({
    spotEntry,
    callStrike,
    callPremium,
    putStrike,
    putPremium,
    contracts = 1
  }) {
    this.spotEntry = spotEntry;
    this.callStrike = callStrike;
    this.callPremium = callPremium;
    this.putStrike = putStrike;
    this.putPremium = putPremium;
    this.contracts = contracts;
  }

  payoffAtExpiry(spotAtExpiry) {
    const {
      callStrike,
      callPremium,
      putStrike,
      putPremium,
      contracts
    } = this;

    const totalPremium = (callPremium + putPremium) * contracts;

    // Call çš„å†…åœ¨ä»·å€¼ï¼ˆå¯¹å–æ–¹æ˜¯äºæŸï¼‰
    const callIntrinsic = Math.max(0, spotAtExpiry - callStrike);
    // Put çš„å†…åœ¨ä»·å€¼ï¼ˆå¯¹å–æ–¹æ˜¯äºæŸï¼‰
    const putIntrinsic = Math.max(0, putStrike - spotAtExpiry);

    const totalIntrinsicLoss =
      (callIntrinsic + putIntrinsic) * contracts;

    const totalPnl = totalPremium - totalIntrinsicLoss;

    return {
      spotAtExpiry,
      totalPremium,
      callIntrinsic,
      putIntrinsic,
      totalIntrinsicLoss,
      totalPnl
    };
  }

  generateCurve(priceList) {
    return priceList.map((p) => this.payoffAtExpiry(p));
  }

  demo() {
    const priceList = [
      30000, 40000, 50000, 55000, 60000, 65000, 70000, 80000
    ];
    const rows = this.generateCurve(priceList);
    console.log('ğŸ“Š Short Strangle åˆ°æœŸç›ˆäºç¤ºä¾‹:');
    rows.forEach((r) => {
      console.log(
        \`- åˆ°æœŸä»·=\${r.spotAtExpiry} | æ”¶åˆ°æƒåˆ©é‡‘=\${r.totalPremium.toFixed(
          2
        )} | å†…åœ¨äºæŸ=\${r.totalIntrinsicLoss.toFixed(
          2
        )} | æ€»PnL=\${r.totalPnl.toFixed(2)}\`
      );
    });
  }
}

// ä½¿ç”¨ç¤ºä¾‹ï¼š
// const sim = new ShortStrangleSimulator({
//   spotEntry: 60000,
//   callStrike: 70000,
//   callPremium: 1000,
//   putStrike: 50000,
//   putPremium: 1200,
//   contracts: 1
// });
// sim.demo();
\`\`\`

> çœŸæ­£å®æˆ˜çš„ Delta ä¸­æ€§ Strangle éœ€è¦å°†â€œåŠ¨æ€ Delta å¯¹å†²æ”¶ç›Š/æˆæœ¬â€ä¸€å¹¶çº³å…¥å›æµ‹æ¨¡å‹ã€‚  
> ä¸Šè¿°ç±»ä»…ä½œç›´è§‚æ•™å­¦å±•ç¤ºã€‚

---

## ğŸ“Š é£æ§å‚æ•°ç¤ºä¾‹ï¼ˆShort Strangleï¼‰

\`\`\`javascript
const SHORT_STRANGLE_RISK_CONFIG = {
  MAX_CAPITAL_RATIO_FOR_STRANGLE: 0.3,       // Strangle å æ€»å‡€èµ„äº§ä¸è¶…è¿‡ 30%
  MAX_LEVERAGE_ON_MARGIN: 1.5,               // å¯¹ä¿è¯é‡‘è´¦æˆ·çš„æœ€å¤§æ æ†å€æ•°
  DELTA_HEDGE_THRESHOLD: 0.1,                // å½“ |Delta| > 0.1 * Notional æ—¶è¿›è¡Œå¯¹å†²
  CLOSE_POSITION_AT_LOSS_RATIO: 0.15,        // å•æœŸæœ€å¤§å¯æ¥å—äºæŸ 15%
  MAX_DAYS_TO_EXPIRY: 30,                    // å•æœŸåˆ°æœŸæ—¶é—´ä¸è¶…è¿‡ 30 å¤©
  STOP_SELL_WHEN_IV_TOO_LOW: true,           // éšå«æ³¢åŠ¨ç‡è¿‡ä½æ—¶åœç”¨æœ¬ç­–ç•¥
  USE_TAIL_HEDGE_OPTIONS: true               // è§†æƒ…å†µä¹°å…¥å°¾éƒ¨ä¿æŠ¤æœŸæƒ
};
\`\`\`

---

## ğŸ¯ å®æˆ˜ Checklistï¼ˆ32.3ï¼‰

### 1ï¸âƒ£ è‡ªèº«æ¡ä»¶è¯„ä¼°

- [ ] ä½ å·²ç»ç†Ÿæ‚‰æœŸæƒåŸºç¡€æ¦‚å¿µï¼ˆCall/Put/Greeksï¼‰ï¼›  
- [ ] ä½ æœ‰èƒ½åŠ›è·Ÿè¸ªç›˜ä¸­æ³¢åŠ¨ï¼Œä¸”å¯ä»¥ä½¿ç”¨æœŸè´§/ç°è´§å¿«é€Ÿå¯¹å†²ï¼›  
- [ ] ä½ å¯¹â€œå–æ–¹ç­–ç•¥æœ‰å¯èƒ½å‡ºç°æç«¯äºæŸâ€æœ‰å¿ƒç†å‡†å¤‡ã€‚

### 2ï¸âƒ£ ç­–ç•¥ç¯å¢ƒç­›é€‰

- [ ] å½“å‰éšå«æ³¢åŠ¨ç‡æ˜¯å¦åé«˜ï¼Ÿ  
- [ ] å¸‚åœºæ˜¯å¦çœ‹èµ·æ¥æ›´åƒâ€œéœ‡è¡æ¶ˆåŒ–â€é˜¶æ®µï¼Œè€Œä¸æ˜¯çˆ†å‘è¶‹åŠ¿çš„èµ·ç‚¹ï¼Ÿ  
- [ ] ä½ çš„æ ‡çš„ï¼ˆBTC/ETH ç­‰ï¼‰æœŸæƒæ˜¯å¦æœ‰è¶³å¤Ÿæ·±åº¦ä¸æµåŠ¨æ€§ï¼Ÿ

### 3ï¸âƒ£ å‚æ•°è®¾å®šä¸é£æ§

- [ ] é€‰å®šæ‰§è¡Œä»·èŒƒå›´ï¼ˆä¸Šä¸‹å„ 10-20% åŒºé—´ï¼‰ï¼›  
- [ ] è®¾å®šæœŸæƒå–å‡ºå¼ æ•°ä¸å¯¹åº”çš„ä¿è¯é‡‘è§„æ¨¡ï¼›  
- [ ] å»ºç«‹ Delta ç›‘æ§ä¸å¯¹å†²è§„åˆ™ï¼›  
- [ ] ä¸ºå•æœŸè®¾å®šæ˜ç¡®çš„æœ€å¤§äºæŸä¸Šé™ä¸æå‰æ­¢æŸæ¡ä»¶ã€‚

### 4ï¸âƒ£ è¿è¡Œä¸å¤ç›˜

- [ ] æŒ‰è®¡åˆ’å–å‡º Strangleï¼Œå¹¶æŒ‰é˜ˆå€¼æ‰§è¡Œ Delta å¯¹å†²ï¼›  
- [ ] å®šæœŸè®°å½•ï¼š  
  - å®é™…æ”¶åˆ°æƒåˆ©é‡‘  
  - å¯¹å†²æˆæœ¬ä¸æ”¶ç›Š  
  - æ•´ä½“ç­–ç•¥å‡€å€¼æ›²çº¿  
- [ ] å¤ç›˜è‹¥å¹²æœŸåï¼Œåˆ¤æ–­ï¼š  
  - æ˜¯å¦è¾¾æˆé¢„æœŸæ”¶ç›Š/å›æ’¤ç›®æ ‡ï¼›  
  - æ˜¯å¦éœ€è¦æ”¶ç´§/æ”¾å®½å‚æ•°ã€‚

---

## âœ… å°ç»“

**Delta ä¸­æ€§ Short Strangle** æ˜¯ä¸€ç§å…¸å‹çš„â€œå–æ³¢åŠ¨â€ç­–ç•¥ï¼š

- ä½ æ”¾å¼ƒé¢„æµ‹æ–¹å‘ï¼Œ  
- è½¬è€Œä¸‹æ³¨â€œæ³¢åŠ¨ä¸ä¼šåƒå¸‚åœºå®šä»·çš„é‚£æ ·å¤§â€ï¼›  
- æ”¶å…¥æ¥æºæ˜¯ï¼š  
  - é«˜ä¼°çš„éšå«æ³¢åŠ¨ç‡ + æ—¶é—´ä»·å€¼è¡°å‡ + éœ‡è¡ä¸­çš„å¯¹å†²æ”¶ç›Šã€‚

ç„¶è€Œå®ƒå¹¶ä¸æ˜¯â€œç¨³èµ¢çš„å°é’æœºâ€ï¼Œ  
è€Œæ˜¯ä¸€ç§ **éœ€è¦æŒç»­ç›¯ç›˜ä¸ä¸¥æ ¼é£æ§çš„ä¸“ä¸šå·¥å…·**ã€‚  

åªæœ‰åœ¨ä½ ï¼š

- å……åˆ†ç†è§£å…¶æ”¶ç›Šç»“æ„ä¸é£é™©æ¥æºï¼Œ  
- å¹¶æœ‰è¶³å¤Ÿçš„æ‰§è¡Œçºªå¾‹ä¸æŠ€æœ¯å·¥å…·æ—¶ï¼Œ  
- æ‰é€‚åˆå°†å…¶çº³å…¥ä½ çš„â€œè¡ç”Ÿå“ç­–ç•¥ (Derivatives Strategies)â€æ¨¡å—ä¸­ã€‚

---

`
};

/**
 * 32.4 Deribit æœŸæƒè‡ªåŠ¨åšå¸‚
 *
 * ä¸€çº§åˆ†ç±»: è¡ç”Ÿå“ç­–ç•¥ (Derivatives Strategies)
 * category_l1: derivatives
 * category: options-selling
 * category_l2: options-selling
 *
 * è¯´æ˜ï¼šè¿™é‡Œçš„â€œè‡ªåŠ¨åšå¸‚â€æ›´åå‘ä¸“ä¸š/åŠä¸“ä¸šå›¢é˜Ÿä½¿ç”¨ã€‚
 */
const STRATEGY_32_4 = {
  title:
    'Deribit æœŸæƒè‡ªåŠ¨åšå¸‚ - ç”¨ç»“æ„åŒ–æŠ¥ä»·ä¸æ—¶é—´è¡°å‡èµšå–ç¨³å®šä»·å·®',
  slug: 'deribit-options-automated-market-making',
  summary:
    'åœ¨ Deribit ç­‰ä¸“ä¸šæœŸæƒäº¤æ˜“å¹³å°æ­å»ºè‡ªåŠ¨åšå¸‚ç³»ç»Ÿï¼šå›´ç»•ä¸åŒåˆ°æœŸæ—¥å’Œæ‰§è¡Œä»·çš„ BTC/ETH æœŸæƒåˆçº¦ï¼ŒæŒç»­æä¾›åŒè¾¹æŠ¥ä»·ï¼ˆBid/Askï¼‰ï¼Œé€šè¿‡ä¹°å–ä»·å·®ï¼ˆSpreadï¼‰ã€æ—¶é—´ä»·å€¼è¡°å‡ï¼ˆThetaï¼‰å’Œéšå«æ³¢åŠ¨ç‡è¯¯å·®ä¿®æ­£æ¥èµšå–ç¨³å®šæ”¶ç›Šã€‚ç­–ç•¥æ ¸å¿ƒæ˜¯æ„å»ºåˆç†çš„å®šä»·æ¨¡å‹ï¼ˆå¦‚ Black-Scholes + æ³¢åŠ¨ç‡æ›²é¢ï¼‰ã€ç²¾ç»†çš„åº“å­˜ç®¡ç†ï¼ˆDelta/Gamma/Vega æ§åˆ¶ï¼‰ã€è‡ªåŠ¨åŒ–é£æ§ï¼Œä»¥åŠå¯¹æç«¯è¡Œæƒ…çš„ä¿æŠ¤æœºåˆ¶ã€‚é€‚åˆæŠ€æœ¯ä¸é£æ§èƒ½åŠ›è¾ƒå¼ºçš„å›¢é˜Ÿï¼Œä¸é€‚åˆå®Œå…¨æ–°æ‰‹ã€‚',
  category: 'options-selling',
  category_l1: 'derivatives',
  category_l2: 'options-selling',
  risk_level: 5,
  apy_min: 15,
  apy_max: 100,
  min_investment: 20000,
  time_commitment:
    'å‰æœŸ 1-3 ä¸ªæœˆå¼€å‘ä¸å›æµ‹åšå¸‚å¼•æ“ï¼Œä¹‹åéœ€ 7x24 ç›‘æ§ä¸ç»´æŠ¤',
  status: 'published',
  content: `# 32.4 Deribit æœŸæƒè‡ªåŠ¨åšå¸‚ - ç”¨ç»“æ„åŒ–æŠ¥ä»·ä¸æ—¶é—´è¡°å‡èµšå–ç¨³å®šä»·å·®

> âš ï¸ æåº¦æ…é‡æç¤º  
> - çœŸæ­£æ„ä¹‰ä¸Šçš„â€œæœŸæƒè‡ªåŠ¨åšå¸‚â€æ˜¯**é«˜ä¸“ä¸šé—¨æ§›**ç­–ç•¥ï¼›  
> - æ¶‰åŠåˆ°ï¼šå®šä»·æ¨¡å‹ã€é£é™©ä¸­æ€§ç†è®ºã€æ³¢åŠ¨ç‡æ›²é¢æ‹Ÿåˆã€è‡ªåŠ¨åŒ–äº¤æ˜“æ¶æ„ï¼›  
> - ä»¥åŠ 7x24 å°æ—¶é£æ§ä¸ç›‘æ§ï¼›  
> - è‹¥æ²¡æœ‰æŠ€æœ¯å›¢é˜Ÿæˆ–æ— æ³•ä¿è¯ç¨³å®šè¿ç»´ï¼Œ**ä¸å»ºè®®å®ç›˜å°è¯•**ã€‚  

---

## ğŸ’° ç­–ç•¥æ¦‚è§ˆ

| å‚æ•°                | æ•°å€¼/è¯´æ˜ |
|---------------------|-----------|
| **æˆ˜åœº**            | Deribit æœŸæƒå¹³å°ï¼ˆBTC/ETH ç­‰ä¸»æµå¸æœŸæƒï¼‰ |
| **è§’è‰²å®šä½**        | åšå¸‚å•†ï¼ˆæŒç»­æŒ‚å‡ºä¹°ä»· Bid å’Œå–ä»· Askï¼‰ |
| **æ”¶ç›Šæ¥æº**        | ä»·å·®ï¼ˆBid-Ask Spreadï¼‰ + æ—¶é—´è¡°å‡ï¼ˆThetaï¼‰ + æ¨¡å‹è¯¯å·®Alpha |
| **ä¸»è¦é£é™©**        | å°¾éƒ¨é£é™©ï¼ˆæç«¯è¡Œæƒ…ï¼‰ã€åº“å­˜é£é™©ï¼ˆGamma/Vegaï¼‰ã€æŠ€æœ¯/é£æ§æ•…éšœ |
| **é€‚ç”¨å¯¹è±¡**        | æœ‰å¼€å‘èƒ½åŠ›çš„é‡åŒ–å›¢é˜Ÿæˆ–éå¸¸è¿›é˜¶çš„ä¸ªäºº |
| **å…³é”®è¦ç´ **        | å®šä»·æ¨¡å‹ã€æŠ¥ä»·é€»è¾‘ã€åº“å­˜ç®¡ç†ã€é£é™©å¯¹å†²ã€ç³»ç»Ÿç¨³å®šæ€§ |

---

## ğŸ“– æ•…äº‹ï¼šä»â€œä¸‹å•çš„äººâ€å˜æˆâ€œè¢«åˆ«äººä¸‹å•çš„é‚£ä¸€è¾¹â€

å¤§éƒ¨åˆ†ç©å®¶è¿›å…¥æœŸæƒå¸‚åœºæ—¶ï¼Œ  
æ‰®æ¼”çš„æ˜¯â€œä¸»åŠ¨ä¸‹å•çš„é‚£ä¸€æ–¹â€ï¼š

- æƒ³åšå¤šæ³¢åŠ¨ï¼Œå°±ä¹° Call/Putï¼›  
- æƒ³å–æ³¢åŠ¨ï¼Œå°±å– Call/Put æˆ–åšç»“æ„åŒ–ç»„åˆï¼›  

ä½†ä½ æ…¢æ…¢ä¼šå‘ç°ï¼š

> **æŒ‚åœ¨ç›˜å£ä¸Šçš„é‚£äº›æ·±åšå§”æ‰˜ï¼Œæ˜¯è°æ”¾ä¸Šå»çš„ï¼Ÿ**  
>  
> åœ¨å¾ˆå¤šæˆç†Ÿå¸‚åœºï¼Œè¿™äº›é€šå¸¸æ¥è‡ªï¼š  
> - ä¸“ä¸šåšå¸‚å•†ï¼ˆMarket Makerï¼‰ï¼›  
> - æœ‰æ¨¡å‹ã€æœ‰é£æ§ã€æœ‰èµ„é‡‘çš„é‡åŒ–å›¢é˜Ÿï¼›  
> - æˆ–éƒ¨åˆ†æµåŠ¨æ€§æä¾›è€…ï¼ˆLPï¼‰ã€‚

ä»–ä»¬å¹²çš„äº‹ï¼Œæœ¬è´¨ä¸Šæ˜¯ï¼š

1. ä½¿ç”¨æŸç§å®šä»·æ¨¡å‹ï¼ˆæ¯”å¦‚ Black-Scholes åŠ ä¸Šè‡ªå·±çš„æ³¢åŠ¨ç‡æ›²é¢ï¼‰ï¼Œ  
   è®¡ç®—å‡ºæ¯ä¸ªæœŸæƒçš„â€œç†è®ºä»·æ ¼â€ï¼›  
2. åœ¨ç†è®ºä»·æ ¼é™„è¿‘ï¼ŒåŠ ä¸Šä¸€å®šçš„ \`Â±spread\` åšæˆæŒ‚å•ï¼š  
   - Bid = Theoretical Price - spread/2  
   - Ask = Theoretical Price + spread/2  
3. ä¸€ç›´æŒ‚åœ¨ç›˜å£ï¼š  
   - åˆ«äººæ¥åƒå•ï¼Œå°±åœ¨ Bid/Ask ä¹‹é—´èµšä¸€ä¸ªä»·å·®ï¼›  
   - åŒæ—¶é€šè¿‡åŠ¨æ€å¯¹å†²æ§åˆ¶æ•´ä½“çš„ Delta/Gamma/Vega ç­‰é£é™©ï¼›  
4. é çš„æ˜¯ï¼š  
   - é«˜é¢‘å°é¢ç¨³å®šèµšä»·å·®ï¼ˆspreadï¼‰å’Œæ—¶é—´ä»·å€¼ï¼ˆThetaï¼‰ï¼›  
   - å¶å°”æ‰¿å—æ³¢åŠ¨çš„æŸå¤±ï¼›  
   - é€šè¿‡æ•´ä½“é£é™©ç®¡ç†ï¼Œè®©é•¿æœŸæœŸæœ›å€¼ä¸ºæ­£ã€‚

Deribit æ˜¯ç›®å‰åŠ å¯†æœŸæƒä¸­éå¸¸é‡è¦çš„å¹³å°ä¹‹ä¸€ï¼š  

- æä¾› BTC/ETH å¤šåˆ°æœŸæ—¥ã€å¤šæ‰§è¡Œä»·æœŸæƒï¼›  
- æœ‰è¾ƒæ ‡å‡†åŒ–çš„ API æ¥å£ï¼Œé€‚åˆè‡ªåŠ¨åŒ–åšå¸‚ï¼›  
- æœ‰ç›¸å¯¹æˆç†Ÿçš„å¸‚åœºç»“æ„ä¸å¤§æˆ·å‚ä¸åº¦ã€‚

ä½ çš„ç›®æ ‡æ˜¯ï¼š

> ä»â€œåªä¼šåœ¨ Deribit ä¸Šæ‰¾ä»·å·®çš„äººâ€ï¼Œ  
>  è¿›é˜¶ä¸ºâ€œåœ¨ Deribit ä¸ŠæŒç»­æä¾›æµåŠ¨æ€§ï¼Œä»ç»“æ„ä¸Šæ”¶ç§Ÿçš„äººâ€ã€‚

---

## ğŸ§  æ ¸å¿ƒé€»è¾‘ï¼šæœŸæƒè‡ªåŠ¨åšå¸‚çš„åŸºæœ¬æ¡†æ¶

### 1ï¸âƒ£ å®šä»·æ¨¡å‹ï¼ˆPricingï¼‰

ä½ éœ€è¦ä¸€ä¸ªâ€œç»™å®šæ ‡çš„ä»·æ ¼ Sã€æ‰§è¡Œä»· Kã€åˆ°æœŸ Tã€æ— é£é™©åˆ©ç‡ rã€éšå«æ³¢åŠ¨ç‡ Ïƒï¼Œè¾“å‡ºæœŸæƒç†è®ºä»·æ ¼â€çš„å‡½æ•°ã€‚

åœ¨ Deribit åœºæ™¯ä¸­ï¼Œå¸¸è§åšæ³•ï¼š

- ä½¿ç”¨ Black-Scholes / Black æ¨¡å‹ä½œä¸ºåŸºç¡€ï¼›  
- æ ¹æ®å†å²æ•°æ®ä¸å¸‚åœºæŠ¥ä»·ï¼Œæ‹Ÿåˆä¸€å¥—â€œéšå«æ³¢åŠ¨ç‡æ›²é¢â€ï¼ˆVol Surfaceï¼‰ï¼š  
  - ä¸åŒæ‰§è¡Œä»·ï¼ˆmoneynessï¼‰  
  - ä¸åŒåˆ°æœŸæ—¥ï¼ˆtenorï¼‰  
- æ ¹æ®ä½ çš„æ³¢åŠ¨ç‡æ›²é¢ï¼Œè®¡ç®—æ¯ä¸ªæœŸæƒåˆçº¦çš„ç†è®ºä»·æ ¼ã€‚

### 2ï¸âƒ£ æŠ¥ä»·é€»è¾‘ï¼ˆQuotingï¼‰

æ ¸å¿ƒæ€æƒ³ï¼š

\`\`\`text
Bid = Theoretical Price - halfSpread
Ask = Theoretical Price + halfSpread
\`\`\`

- spread å¯ä»¥æ˜¯å›ºå®šï¼Œä¹Ÿå¯ä»¥åŠ¨æ€è°ƒæ•´ï¼š  
  - å¸‚åœºæ³¢åŠ¨å¤§ â†’ åŠ å¤§ spreadï¼›  
  - å¸‚åœºå¹³é™ä¸”ç«äº‰æ¿€çƒˆ â†’ ç¼©å° spreadï¼›  
- ä¹Ÿå¯ä»¥ç»“åˆåº“å­˜æ°´å¹³ï¼š  
  - æŸä¸€è¾¹ä»“ä½è¿‡å¤š â†’ ç¨å¾®â€œå¼•å¯¼æŠ¥ä»·â€å¹³ä»“ã€‚

### 3ï¸âƒ£ åº“å­˜ç®¡ç†ï¼ˆInventory & Riskï¼‰

æœŸæƒåšå¸‚ä¸æ˜¯ç®€å•â€œæŠ¥ä»·å–ä¹°éƒ½èµšå·®ä»·â€ï¼Œ  
å› ä¸ºæ¯æ¬¡æˆäº¤éƒ½ä¼šè®©ä½ çš„ï¼š

- Deltaï¼šæ–¹å‘é£é™©  
- Gammaï¼šä»·æ ¼å˜åŒ–å¸¦æ¥çš„ Delta å˜åŒ–é€Ÿåº¦  
- Vegaï¼šæ³¢åŠ¨ç‡å˜åŒ–é£é™©  
- Thetaï¼šæ—¶é—´ä»·å€¼æš´éœ²  

å‘ç”Ÿå˜åŒ–ã€‚

ä½ éœ€è¦ï¼š

- ä¸ºæ¯ä¸ªç»´åº¦è®¾å®šé˜ˆå€¼ï¼š  
  - \`|Delta| < æŸå€¼\`  
  - \`|Gamma| < æŸå€¼\`  
  - \`|Vega| < æŸå€¼\`  
- å½“è¶…å‡ºé˜ˆå€¼æ—¶ï¼š  
  - é€šè¿‡æœŸè´§/ç°è´§/å…¶å®ƒæœŸæƒè¿›è¡Œå¯¹å†²ï¼›  
  - æˆ–è°ƒæ•´æŠ¥ä»·ï¼Œè®©å¸‚åœºå¸®åŠ©ä½ â€œè‡ªç„¶å‡ä»“â€ã€‚

### 4ï¸âƒ£ æŠ€æœ¯ä¸é£æ§æ¶æ„

è‡ªåŠ¨åšå¸‚éœ€è¦ä¸€å¥—ç¨³å®šçš„æŠ€æœ¯ç³»ç»Ÿï¼š

- è¿æ¥ Deribit APIï¼ˆREST + WebSocketï¼‰ï¼›  
- è·å–å®æ—¶è¡Œæƒ…ä¸ Greeks ä¿¡æ¯ï¼›  
- å†³å®šæ¯ä¸€æ¡£æœŸæƒåˆçº¦çš„æŠ¥ä»·ä¸æ’¤å•ï¼›  
- ç›‘æ§é£é™©æŒ‡æ ‡ä¸æœåŠ¡å™¨çŠ¶æ€ï¼›  
- æœ‰æ–­çº¿/å¼‚å¸¸æ—¶è‡ªåŠ¨é™é£é™©æˆ–å…³é—­ä»“ä½ã€‚

æ­¤å¤–ï¼Œè¿˜éœ€è¦ï¼š

- ã€ŒKill-Switchã€ï¼š  
  - å½“æŸå¤±è¶…è¿‡æŸä¸€é˜ˆå€¼ï¼Œç³»ç»Ÿè‡ªåŠ¨å¹³ä»“å¹¶åœæ­¢åšå¸‚ï¼›  
- ã€Œç†”æ–­é€»è¾‘ã€ï¼š  
  - å½“ 1 åˆ†é’Ÿå†…ä»·æ ¼è·³åŠ¨è¿‡äºå‰§çƒˆæ—¶ï¼Œä¸´æ—¶æ‰©å¤§ spread æˆ–åœæ­¢æŠ¥ä»·ã€‚

---

## ğŸ§© ç®€åŒ–ç‰ˆ Deribit åšå¸‚æœºå™¨äººç»“æ„ç¤ºä¾‹ï¼ˆä¼ªä»£ç ï¼‰

> ä»¥ä¸‹ä¸º**ç»“æ„ç¤ºæ„**ï¼Œå¹¶éå¯ç›´æ¥è¿è¡Œç”Ÿäº§ç¯å¢ƒä»£ç ã€‚  
> çœŸæ­£ä½¿ç”¨å‰éœ€è¦è¡¥å……ï¼šé‰´æƒã€é”™è¯¯å¤„ç†ã€é™é¢‘æ§åˆ¶ã€Greeks è®¡ç®—ç­‰ã€‚

\`\`\`javascript
class DeribitOptionsMarketMaker {
  constructor({ apiKey, apiSecret }) {
    this.apiKey = apiKey;
    this.apiSecret = apiSecret;

    this.volSurface = null; // æ³¢åŠ¨ç‡æ›²é¢ï¼ˆéœ€è‡ªè¡Œæ„å»º/æ›´æ–°ï¼‰
    this.riskLimits = {
      maxDelta: 100, // å¯æ‰¿å—çš„æœ€å¤§ç»å¯¹ Delta
      maxGamma: 5,   // ç¤ºä¾‹å€¼ï¼Œéœ€è§†è§„æ¨¡è°ƒæ•´
      maxVega: 5000,
      maxDailyLoss: 10_000 // ä¸€å¤©æœ€å¤§å¯æ¥å—äºæŸ
    };

    this.currentRisk = {
      delta: 0,
      gamma: 0,
      vega: 0,
      pnlToday: 0
    };

    this.quoteConfig = {
      baseSpreadRatio: 0.03, // åœ¨ç†è®ºä»·æ ¼çš„ Â±3% æŒ‚å•ï¼ˆæ ¹æ®å¸‚åœºç«äº‰è°ƒæ•´ï¼‰
      minSpreadAbs: 1,       // æœ€å°ç»å¯¹ä»·å·®
      maxSpreadAbs: 50
    };

    this.isRunning = false;
  }

  /**
   * TODO: å®ç°è¿æ¥ Deribit APIï¼Œè·å–å®æ—¶è¡Œæƒ…ä¸ Greeks æ•°æ®
   */
  async connect() {
    console.log('è¿æ¥ Deribit WebSocket / REST API ...');
  }

  /**
   * æ ¹æ®å½“å‰æ ‡çš„ã€æ‰§è¡Œä»·ã€åˆ°æœŸæ—¥ï¼Œåˆ©ç”¨æ³¢åŠ¨ç‡æ›²é¢è®¡ç®—æœŸæƒç†è®ºä»·æ ¼
   * è¿™é‡Œç”¨ä¸€ä¸ªå ä½å‡½æ•°ï¼Œå®é™…éœ€ç”¨ Black-Scholes ç­‰å…¬å¼+vol surface å®ç°
   */
  theoreticalPrice(option) {
    // option: { underlyingPrice, strike, timeToExpiry, optionType, ... }
    // è¿™é‡Œåªç»™ä¸€ä¸ªç®€åŒ–ç¤ºæ„
    const iv = this.estimateIV(option); // ä» volSurface ä¼°è®¡éšå«æ³¢åŠ¨ç‡
    const mid = option.markPrice || option.indexPrice || option.lastPrice;
    if (!mid) return null;
    // æš‚æ—¶ç›´æ¥è¿”å› midï¼ŒçœŸå®æƒ…å†µéœ€ç”¨ BS å…¬å¼
    return mid;
  }

  estimateIV(option) {
    // ä» volSurface ä¼°è®¡è¯¥æ‰§è¡Œä»·/åˆ°æœŸæ—¥çš„ IV
    // è¿™é‡Œä½¿ç”¨ç®€åŒ–å ä½é€»è¾‘
    if (!this.volSurface) {
      // é»˜è®¤ç»™ä¸ªæ•°
      return 0.8;
    }
    // TODO: æ ¹æ® moneyness + tenor æ’å€¼
    return 0.8;
  }

  /**
   * æ ¹æ®ç†è®ºä»·æ ¼ä¸é…ç½®ç”Ÿæˆ bid/ask æŠ¥ä»·
   */
  generateQuotes(theoreticalPrice) {
    const cfg = this.quoteConfig;
    let spread = theoreticalPrice * cfg.baseSpreadRatio;

    if (spread < cfg.minSpreadAbs) spread = cfg.minSpreadAbs;
    if (spread > cfg.maxSpreadAbs) spread = cfg.maxSpreadAbs;

    const bid = theoreticalPrice - spread / 2;
    const ask = theoreticalPrice + spread / 2;

    return { bid, ask, spread };
  }

  /**
   * æ ¸å¿ƒæŠ¥ä»·æµç¨‹ï¼ˆæç®€ç¤ºæ„ï¼‰
   */
  async quoteOption(option) {
    const theo = this.theoreticalPrice(option);
    if (!theo) return;

    const { bid, ask } = this.generateQuotes(theo);

    // TODO: è°ƒç”¨ Deribit API æŒ‚å•
    console.log(
      \`å¯¹åˆçº¦ \${option.instrument_name} æŠ¥ä»·: bid=\${bid}, ask=\${ask}\`
    );
  }

  /**
   * é£é™©ç›‘æ§ï¼šè‹¥é£é™©è¶…è¿‡é˜ˆå€¼ï¼Œè°ƒæ•´æŠ¥ä»·æˆ–è§¦å‘å¯¹å†²
   */
  async riskCheckAndHedge() {
    const { delta, gamma, vega, pnlToday } = this.currentRisk;
    const limits = this.riskLimits;

    if (Math.abs(delta) > limits.maxDelta) {
      console.log('âš ï¸ Delta è¶…é™ï¼Œè§¦å‘å¯¹å†²é€»è¾‘...');
      // TODO: ä¸‹æœŸè´§/ç°è´§å•å¯¹å†² Delta
    }

    if (Math.abs(gamma) > limits.maxGamma) {
      console.log('âš ï¸ Gamma è¶…é™ï¼Œè€ƒè™‘å‡ä»“éƒ¨åˆ†è¿‘æœˆ/è¿‘ä»·åˆçº¦...');
      // TODO: è°ƒæ•´åº“å­˜
    }

    if (Math.abs(vega) > limits.maxVega) {
      console.log('âš ï¸ Vega è¶…é™ï¼Œè€ƒè™‘å‡å°æ•´ä½“ Vega æš´éœ²...');
      // TODO: æŠŠéƒ¨åˆ†å–æ–¹æ•å£å¯¹å†²ä¸ºæ›´å¹³è¡¡ç»“æ„
    }

    if (pnlToday < -limits.maxDailyLoss) {
      console.log('ğŸš¨ å½“æ—¥æŸå¤±è¶…é™ï¼Œæ‰§è¡Œ Kill-Switchï¼Œåœæ­¢åšå¸‚å¹¶å¹³ä»“ï¼');
      this.isRunning = false;
      // TODO: å‘èµ·æ‰¹é‡æ’¤å• + é£é™©å‡ä»“
    }
  }

  /**
   * ä¸»å¾ªç¯ï¼ˆç¤ºæ„ï¼‰
   */
  async run() {
    this.isRunning = true;
    await this.connect();

    while (this.isRunning) {
      try {
        // 1. æ‹‰å–æœ€æ–°æœŸæƒåˆ—è¡¨ä¸è¡Œæƒ…
        const options = await this.fetchOptionInstruments();

        // 2. å¯¹æ¯ä¸ªå…³æ³¨çš„æœŸæƒåˆçº¦ç”ŸæˆæŠ¥ä»·
        for (const opt of options) {
          await this.quoteOption(opt);
        }

        // 3. æ£€æŸ¥é£é™©å¹¶è¿›è¡Œå¯¹å†²æˆ–é™é£é™©
        await this.riskCheckAndHedge();

        // 4. é€‚å½“ sleepï¼Œé¿å…è¿‡é«˜é¢‘ç¹è°ƒç”¨
        await new Promise((resolve) => setTimeout(resolve, 2000));
      } catch (err) {
        console.error('åšå¸‚å¾ªç¯å¼‚å¸¸:', err.message);
        // å‡ºç°å¼‚å¸¸æ—¶ï¼Œå¯ä»¥æš‚æ—¶æ‰©å¤§ spread æˆ–å…ˆæ’¤å•é™é£é™©
      }
    }
  }

  async fetchOptionInstruments() {
    // TODO: ç”¨ Deribit API è·å– BTC/ETH æœŸæƒåˆ—è¡¨åŠè¡Œæƒ…
    return [
      {
        instrument_name: 'BTC-30JUN24-60000-C',
        markPrice: 2000,
        indexPrice: 60000
      },
      {
        instrument_name: 'BTC-30JUN24-50000-P',
        markPrice: 1500,
        indexPrice: 60000
      }
    ];
  }

  stop() {
    this.isRunning = false;
  }
}

// ä½¿ç”¨ç¤ºä¾‹ï¼ˆä»…ç¤ºæ„ï¼‰ï¼š
// const mm = new DeribitOptionsMarketMaker({ apiKey: 'xxx', apiSecret: 'yyy' });
// mm.run().catch(console.error);
\`\`\`

---

## ğŸ“Š é£æ§ä¸å‚æ•°ç¤ºä¾‹ï¼ˆDeribit æœŸæƒåšå¸‚ï¼‰

\`\`\`javascript
const DERIBIT_MM_RISK_CONFIG = {
  MAX_NOTIONAL_PER_SIDE: 200_000,     // å•ä¸€æ–¹å‘ï¼ˆCall/Putï¼‰æœ€å¤§åä¹‰ä»“ä½
  MAX_NET_DELTA_ABS: 100,             // å‡€ Delta é™åˆ¶
  MAX_NET_GAMMA_ABS: 10,              // å‡€ Gamma é™åˆ¶ï¼ˆç¤ºæ„å€¼ï¼‰
  MAX_NET_VEGA_ABS: 20_000,           // å‡€ Vega é™åˆ¶
  MAX_DAILY_LOSS: 20_000,             // å•æ—¥æœ€å¤§å¯æ‰¿å—äºæŸ
  MAX_INTRADAY_DRAWDOWN: 10_000,      // æ—¥å†…æœ€å¤§å›æ’¤
  QUOTE_PAUSE_ON_VOL_SPIKE: true,     // æ³¢åŠ¨ç‡ç¬é—´é£™å‡æ—¶æš‚åœæŠ¥ä»·
  WIDEN_SPREAD_ON_WEAK_LIQUIDITY: true, // æµåŠ¨æ€§å˜å·®æ—¶è‡ªåŠ¨æ‰©å¤§ç‚¹å·®
  KILL_SWITCH_ON_TECH_ERROR: true     // å…³é”®ç³»ç»Ÿå¼‚å¸¸æ—¶è‡ªåŠ¨æ’¤å•åœæœº
};
\`\`\`

---

## ğŸ¯ å®æˆ˜ Checklistï¼ˆ32.4ï¼‰

### 1ï¸âƒ£ èƒ½åŠ›ä¸èµ„æºè¯„ä¼°

- [ ] ä½ /å›¢é˜Ÿæ˜¯å¦æœ‰å¼€å‘ã€éƒ¨ç½²ã€ç»´æŠ¤è‡ªåŠ¨äº¤æ˜“ç³»ç»Ÿçš„ç»éªŒï¼Ÿ  
- [ ] æ˜¯å¦æœ‰äººæ‡‚æœŸæƒå®šä»·ã€æ³¢åŠ¨ç‡æ›²é¢å’Œé£é™©ä¸­æ€§ç†è®ºï¼Ÿ  
- [ ] æ˜¯å¦æœ‰å……è¶³çš„æµ‹è¯•èµ„é‡‘ä¸â€œå…è®¸è¯•é”™çš„é¢„ç®—â€ï¼Ÿ  

### 2ï¸âƒ£ æŠ€æœ¯æ¶æ„å‡†å¤‡

- [ ] ç†Ÿæ‚‰ Deribit API æ–‡æ¡£ï¼ˆREST + WebSocketï¼‰ï¼›  
- [ ] æ­å»ºä¸€ä¸ªå¯ 7x24 è¿è¡Œçš„ç¯å¢ƒï¼ˆæœåŠ¡å™¨ã€ç›‘æ§ã€æ—¥å¿—ç³»ç»Ÿï¼‰ï¼›  
- [ ] è®¾è®¡æ–­çº¿é‡è¿ã€å¼‚å¸¸å¤„ç†ã€é™é¢‘æ§åˆ¶ç­–ç•¥ï¼›  
- [ ] æ­å»ºå®æ—¶è¡Œæƒ…ä¸è®¢å•è·Ÿè¸ªæ¨¡å—ã€‚

### 3ï¸âƒ£ ç­–ç•¥ä¸æ¨¡å‹è®¾è®¡

- [ ] é€‰å®šåŸºç¡€æ¨¡å‹ï¼ˆBS/Black ç­‰ï¼‰ä¸åˆå§‹æ³¢åŠ¨ç‡æ›²é¢ï¼›  
- [ ] è®¾è®¡æŠ¥ä»·é€»è¾‘ï¼š  
  - Spread å¦‚ä½•ä¸å¸‚åœºæ³¢åŠ¨ã€åº“å­˜é£é™©è”åŠ¨è°ƒæ•´ï¼›  
- [ ] è®¾è®¡åº“å­˜ä¸é£é™©ç®¡ç†æ¨¡å—ï¼š  
  - Delta/Gamma/Vega é˜ˆå€¼  
  - å¯¹å†²é€»è¾‘ï¼ˆæœŸè´§/ç°è´§/å…¶ä»–æœŸæƒï¼‰  
  - Kill-Switch ä¸ç†”æ–­è§„åˆ™ã€‚

### 4ï¸âƒ£ å›æµ‹ä¸çº¸é¢äº¤æ˜“

- [ ] ä½¿ç”¨å†å²æ•°æ®å›æµ‹åšå¸‚é€»è¾‘ï¼š  
  - åœ¨ä¸åŒå¸‚åœºç¯å¢ƒä¸‹ï¼ˆç‰›/ç†Š/éœ‡è¡/æç«¯è¡Œæƒ…ï¼‰çš„è¡¨ç°ï¼›  
- [ ] å…ˆè¿›è¡Œçº¸é¢ä»¿çœŸï¼ˆä¸ä¸‹çœŸå®è®¢å•ï¼‰ï¼›  
- [ ] è°ƒæ•´å‚æ•°ï¼Œé¿å…è¿‡æ‹Ÿåˆï¼Œå¼ºè°ƒç¨³å¥æ€§ã€‚

### 5ï¸âƒ£ å°èµ„é‡‘è¯•è¿è¡Œä¸è¿­ä»£

- [ ] ä»éå¸¸å°çš„åä¹‰è§„æ¨¡å¼€å§‹å®ç›˜è¯•è·‘ï¼›  
- [ ] ä¸¥æ ¼ç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š  
  - æ¯æ—¥ç›ˆäºï¼ˆPnLï¼‰  
  - äº¤æ˜“æˆæœ¬ï¼ˆæ‰‹ç»­è´¹+æ»‘ç‚¹ï¼‰  
  - é£é™©æŒ‡æ ‡ï¼ˆDelta/Gamma/Vega/Thetaï¼‰  
- [ ] æ ¹æ®å®ç›˜è¡¨ç°é€æ­¥è°ƒæ•´æŠ¥ä»·ç­–ç•¥ä¸é£æ§é™é¢ã€‚

### 6ï¸âƒ£ è§„æ¨¡ä¸æ‰©å¼ 

- [ ] å½“ç³»ç»Ÿç¨³å®šè¿è¡Œä¸€æ®µæ—¶é—´ï¼ˆä¾‹å¦‚ 3-6 ä¸ªæœˆï¼‰åï¼Œ  
  å†è€ƒè™‘é€‚åº¦æ‹‰å¤§åšå¸‚è§„æ¨¡ï¼›  
- [ ] åŒæ—¶è¦æ³¨æ„ï¼š  
  - è§„æ¨¡æ”¾å¤§åï¼Œé£é™©ä¸å‹åŠ›æ˜¯éçº¿æ€§å¢é•¿çš„ï¼›  
  - å¿…é¡»åŒæ­¥å¼ºåŒ–ç›‘æ§ä¸æŠ¥è­¦ç³»ç»Ÿã€‚

---

## âœ… å°ç»“

**Deribit æœŸæƒè‡ªåŠ¨åšå¸‚** æ˜¯æ•´ä¸ªâ€œè¡ç”Ÿå“ç­–ç•¥ (Derivatives Strategies)â€ä¸­  
æœ€æ¥è¿‘â€œä¸“ä¸šæ’®åˆæœºæ„/é‡åŒ–åŸºé‡‘å·¥ä½œå†…å®¹â€çš„ä¸€ç§ç©æ³•ï¼š

- ä½ ä¸å†æ˜¯å•çº¯çš„æŠ•æœºè€…ï¼Œ  
- è€Œæ˜¯ç«™åˆ°â€œäº¤æ˜“æ‰€è®¢å•ç°¿å¦ä¸€ä¾§â€ï¼Œ  
- é€šè¿‡æŒç»­æä¾›åŒè¾¹æŠ¥ä»·ä¸ç³»ç»ŸåŒ–é£æ§ï¼Œ  
- å‘æ‰€æœ‰è¿›åœºäº¤æ˜“è€…æ”¶å–ä¸€éƒ¨åˆ† â€œæµåŠ¨æ€§æœåŠ¡è´¹â€ã€‚

å®ƒå¯ä»¥åœ¨é•¿æœŸå¸¦æ¥å¯è§‚ä¸”ç›¸å¯¹ç¨³å®šçš„æ”¶ç›Šï¼ˆå¦‚æœåšå¾—è¶³å¤Ÿä¸“ä¸šï¼‰ï¼Œ  
ä½†åŒæ—¶ä¹Ÿå¯¹ **æŠ€æœ¯ã€èµ„é‡‘ã€é£æ§ã€å›¢é˜Ÿåä½œ** æå‡ºäº†æé«˜è¦æ±‚ã€‚  

å¦‚æœä½ åªæ˜¯ä¸ªäººç©å®¶æˆ–åˆšæ¥è§¦æœŸæƒï¼Œ  
å»ºè®®å…ˆä»ï¼š

- 32.1 BTC Covered Call  
- 32.2 ETH Put Selling  
- 32.3 Delta ä¸­æ€§ Short Strangleï¼ˆå°‘é‡ä»“ä½ + æ‰‹åŠ¨ç®¡ç†ï¼‰  

è¿™äº›æ›´â€œå¯æ§â€çš„è¡ç”Ÿå“ç­–ç•¥å¼€å§‹ï¼Œ  
ç­‰ä½ å¯¹æœŸæƒä¸–ç•ŒçœŸæ­£å»ºç«‹èµ· **ç¨³å›ºçš„è®¤çŸ¥ä¸å·¥å…·æ ˆ** æ—¶ï¼Œ  
å†æ¥ä¸¥è‚ƒåœ°è¯„ä¼°ï¼š  
> â€œæˆ‘æ˜¯å¦å·²ç»å‡†å¤‡å¥½ï¼Œ  
>  æˆä¸º Deribit ä¸Šçš„ä¸€ä¸ªè‡ªåŠ¨åšå¸‚ LPï¼Ÿâ€

---

`
};

/**
 * ä¸Šä¼  32.3 å’Œ 32.4 ç­–ç•¥åˆ° Directus
 */
async function uploadStrategies() {
  const DIRECTUS_URL = 'http://localhost:8055';

  console.log(
    'å¼€å§‹ä¸Šä¼ ç­–ç•¥ 32.3 (Delta ä¸­æ€§ Short Strangle) å’Œ 32.4 (Deribit æœŸæƒè‡ªåŠ¨åšå¸‚)...\\n'
  );

  try {
    const { execSync } = require('child_process');
    const tokenOutput = execSync('./get-new-directus-token.sh').toString();
    const tokenMatch = tokenOutput.match(/DIRECTUS_ADMIN_TOKEN=(.+)/);

    if (!tokenMatch) {
      throw new Error('Failed to get admin token');
    }

    const ADMIN_TOKEN = tokenMatch[1].trim();

    const headers = {
      Authorization: `Bearer ${ADMIN_TOKEN}`,
      'Content-Type': 'application/json'
    };

    console.log('ä¸Šä¼ ç­–ç•¥ 32.3: Delta ä¸­æ€§æœŸæƒç­–ç•¥ (Short Strangle)...');
    await axios.post(`${DIRECTUS_URL}/items/strategies`, STRATEGY_32_3, {
      headers
    });
    console.log('âœ… ç­–ç•¥ 32.3 ä¸Šä¼ æˆåŠŸ\\n');

    console.log('ä¸Šä¼ ç­–ç•¥ 32.4: Deribit æœŸæƒè‡ªåŠ¨åšå¸‚...');
    await axios.post(`${DIRECTUS_URL}/items/strategies`, STRATEGY_32_4, {
      headers
    });
    console.log('âœ… ç­–ç•¥ 32.4 ä¸Šä¼ æˆåŠŸ\\n');

    const response = await axios.get(
      `${DIRECTUS_URL}/items/strategies?limit=1&meta=total_count`,
      { headers }
    );
    console.log(
      `âœ… æ•°æ®åº“ä¸­ç°æœ‰ç­–ç•¥æ€»æ•°: ${response.data.meta.total_count}`
    );
  } catch (error) {
    console.error('âŒ ä¸Šä¼ å¤±è´¥:', error.response?.data || error.message);
    process.exit(1);
  }
}

// è‹¥è¦ç›´æ¥ç”¨ Node æ‰§è¡Œæœ¬æ–‡ä»¶ä¸Šä¼ ç­–ç•¥ï¼Œè¯·å–æ¶ˆä¸‹é¢ä¸€è¡Œæ³¨é‡Šï¼š
uploadStrategies();
