
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  🎯 PlayNew 0.3 - 下一步操作指南
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 已完成的准备工作:
  • 所有部署文件已创建
  • Git 仓库已初始化
  • 代码已提交 (422 文件)
  • 远程仓库已配置

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📝 你现在需要做的事情:

第 1 步: 推送代码到 GitHub
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

A. 确认 GitHub 仓库已创建
   访问: https://github.com/EthaninUK/playnew-0.3
   
   如果显示 404,需要先创建仓库:
   1. 访问: https://github.com/new
   2. 仓库名: playnew-0.3
   3. 设为 Private (私有)
   4. 不要添加 README, .gitignore 等
   5. 点击 "Create repository"

B. 生成 Personal Access Token (如果还没有)
   1. 访问: https://github.com/settings/tokens
   2. "Generate new token" -> "Generate new token (classic)"
   3. Note: PlayNew Deployment
   4. 勾选: repo (完整权限)
   5. 点击 "Generate token"
   6. ⚠️ 立即复制 Token!

C. 推送代码
   在终端执行:
   
   git push -u origin main
   
   输入凭证:
   • Username: EthaninUK
   • Password: [粘贴你的 Token]

   推送后可保存凭证:
   git config --global credential.helper store


第 2 步: 配置域名 DNS (5 分钟)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

登录你的域名管理面板,添加以下 A 记录:

记录类型  主机记录    记录值
------   --------   ---------------
A        @          13.158.222.72
A        www        13.158.222.72
A        api        13.158.222.72
A        search     13.158.222.72
A        n8n        13.158.222.72

⏱️ 等待 DNS 生效 (5-30 分钟)

验证 DNS:
nslookup playnew.ai
nslookup api.playnew.ai


第 3 步: 连接服务器 (现在就可以做)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

你提到的命令:
ssh ubuntu@13.158.222.72

这是用来连接你的 AWS 服务器的。

如果连接失败,可能需要:
• 使用密钥: ssh -i your-key.pem ubuntu@13.158.222.72
• 或者使用密码登录


第 4 步: 服务器初始化 (10 分钟)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

连接到服务器后,执行:

# 下载初始化脚本
wget https://raw.githubusercontent.com/EthaninUK/playnew-0.3/main/setup-server.sh

# 运行脚本 (需要 sudo)
sudo bash setup-server.sh

这会自动安装:
• Docker & Docker Compose
• Nginx
• Certbot (SSL 证书)
• 系统优化 (swap, 文件限制等)


第 5 步: 部署应用 (15 分钟)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

在服务器上执行:

# 克隆代码
cd /var/www
sudo git clone https://github.com/EthaninUK/playnew-0.3.git playnew
sudo chown -R $USER:$USER playnew
cd playnew

# 配置环境变量
# 1. 生成密钥
openssl rand -base64 32  # DIRECTUS_KEY
openssl rand -base64 32  # DIRECTUS_SECRET  
openssl rand -base64 32  # MEILISEARCH_MASTER_KEY

# 2. 创建配置文件
cp .env.production.example .env.production
nano .env.production
# (填入上面生成的密钥)

cp frontend/.env.production.example frontend/.env.production
nano frontend/.env.production
# (更新所有配置,特别是 Stripe 生产密钥!)

# 获取 SSL 证书
sudo systemctl stop nginx
sudo certbot certonly --standalone -d playnew.ai -d www.playnew.ai
sudo certbot certonly --standalone -d api.playnew.ai
sudo certbot certonly --standalone -d search.playnew.ai
sudo certbot certonly --standalone -d n8n.playnew.ai

# 配置 Nginx
sudo cp nginx/playnew.ai.conf /etc/nginx/sites-available/
sudo ln -s /etc/nginx/sites-available/playnew.ai.conf /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl start nginx

# 部署!
./deploy.sh


第 6 步: 配置自动部署 (5 分钟)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

在 GitHub 仓库 Settings > Secrets and variables > Actions:

添加以下 Secrets:
• SSH_HOST: 13.158.222.72
• SSH_USER: ubuntu  
• SSH_PRIVATE_KEY: (你的 SSH 私钥内容)

完成后,每次 git push 都会自动部署!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📚 详细文档:

• 完整指南: DEPLOYMENT.md
• 快速部署: QUICK-DEPLOY.md
• 部署清单: DEPLOYMENT-CHECKLIST.md
• GitHub 推送: GITHUB-PUSH-GUIDE.md
• 总体方案: 部署方案总结.md

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⚠️ 重要提醒:

1. Stripe 必须改为生产密钥 (pk_live_... 不是 pk_test_...)
2. 所有 URL 改为 HTTPS (https://playnew.ai)
3. 生成新的密钥,不要用示例密钥
4. 2GB RAM 有点紧张,如遇内存问题考虑升级到 4GB

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎉 预计完成时间: 约 40 分钟

完成后访问:
• https://playnew.ai (主站)
• https://api.playnew.ai (API)
• https://search.playnew.ai (搜索)
• https://n8n.playnew.ai (自动化)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💬 现在开始吧!

请告诉我:
1. GitHub 仓库是否已创建? (访问确认)
2. 是否需要帮助推送代码?
3. 是否可以连接到服务器?

