const axios = require('axios');

const STRATEGY_14_5 = {
  title: 'Balancer veBAL 治理挖矿 - 多资产流动性协调器',
  slug: 'liquidity-mining-14-5-balancer-vebal-governance',
  summary: '锁定 BAL 代币获得 veBAL 投票权，通过治理投票分配流动性激励，赚取协议手续费和贿选收益。支持多资产池，灵活性更高。',
  category: 'liquidity-mining',
  category_l1: 'yield',
  category_l2: '流动性引导',
  difficulty_level: 'advanced',
  risk_level: 3,
  apy_min: 18,
  apy_max: 65,
  threshold_capital: '中等',
  threshold_capital_min: 3000,
  time_commitment: '低',
  time_commitment_minutes: 25,
  threshold_tech_level: 'advanced',
  status: 'published',
  content: `# Balancer veBAL 治理挖矿 - 多资产流动性协调器

## 📖 小刘的多资产难题

小刘手里有多种代币：ETH、WBTC、USDC、DAI，总价值约 50,000 美元。他想把这些资产都利用起来赚取收益，但传统 DEX 只支持双币池，需要拆分成多个池子管理，非常麻烦。后来他发现了 Balancer——支持最多 8 种代币的流动性池，还能通过 veBAL 投票获得额外收益。

**传统 DEX 的限制：**
- Uniswap/Curve 只支持 2-3 种代币的池子
- 需要将资产拆分管理，增加复杂度
- 每个池子单独提供流动性，Gas 费成本高
- 无法灵活调整资产配置比例

**Balancer veBAL 的优势：**
- 支持多达 8 种代币的流动性池
- 可自定义资产权重（如 80% ETH + 20% USDC）
- 通过 veBAL 投票影响激励分配
- 多链部署（以太坊、Arbitrum、Polygon、Optimism）
- 适合作为投资组合的再平衡工具

---

## 🎯 策略核心原理

### Balancer 是什么？

Balancer 是一个多资产 AMM（自动做市商）协议，核心创新在于：

**1. 灵活的池子配置**
- 支持 2-8 种代币
- 自定义权重（不限于 50:50）
- 例如：40% ETH + 30% WBTC + 20% USDC + 10% DAI

**2. 智能订单路由**
- Balancer 作为流动性聚合器
- 自动寻找最优交易路径
- 可能通过多个池子完成一笔交易

**3. 可编程流动性**
- 支持加权池（Weighted Pools）
- 稳定池（Stable Pools，类似 Curve）
- Boosted Pools（与借贷协议集成）
- Managed Pools（动态调整权重）

### veBAL 投票治理机制

**1. 锁定 80/20 BAL/ETH BPT 获得 veBAL**

与 Curve 不同，Balancer 要求锁定的不是纯 BAL，而是：
- 80% BAL + 20% ETH 的 LP Token（称为 B-80BAL-20WETH）
- 这样设计降低了 BAL 价格波动风险
- 锁定 1 周到 1 年（最长 1 年，比 Curve 短）

**2. veBAL 投票权力**

每两周一次 Gauge 投票：
- 投票决定哪些池子获得 BAL 代币激励
- 获得更多投票的池子，LP APR 更高
- 影响整个 Balancer 生态的资金流向

**3. 收益来源**

| 收益类型 | 说明 | 占比 | 稳定性 |
|---------|------|------|--------|
| **协议手续费** | 所有 Balancer 池子手续费的 50% | 40% | ⭐⭐⭐⭐⭐ |
| **Bribes（Hidden Hand）** | 项目方通过 Hidden Hand 支付贿选 | 45% | ⭐⭐⭐⭐ |
| **BAL 释放** | 协议给 veBAL 持有者的 BAL 奖励 | 10% | ⭐⭐⭐ |
| **Aura 收益** | 通过 Aura Finance 放大收益 | 可选 | ⭐⭐⭐⭐ |

**4. Aura Finance - Balancer 的 Convex**

类似 Convex 之于 Curve，Aura Finance 为 Balancer 提供：
- 累积 veBAL 控制权
- 为普通用户提供增强收益
- 无需锁定，保持流动性
- 简化操作流程

---

## 📊 收益对比表

| 策略 | 锁定时长 | 预计年化收益 | 流动性 | 复杂度 | 适合人群 |
|------|---------|------------|--------|--------|---------|
| **纯 LP（无 veBAL）** | 无 | 5-15% | ⭐⭐⭐⭐⭐ | 低 | 简单参与者 |
| **veBAL 投票** | 1 年 | 20-40% | ⭐ | 高 | 治理参与者 |
| **veBAL + 自己的 LP Boost** | 1 年 | 25-50% | ⭐ | 高 | 大额 LP 提供者 |
| **通过 Aura 参与** | 无 | 18-35% | ⭐⭐⭐ | 中 | 普通用户（推荐）|
| **Aura veBAL 组合** | 混合 | 30-65% | ⭐⭐ | 中 | 平衡策略 |

---

## 💰 收益计算示例

### 案例 1：纯 veBAL 投票策略（1 年锁定）

小刘投入 30,000 USDT：

**初始设置：**
- 购买 BAL：15,000 USDT（假设 BAL = $5）= 3,000 BAL
- 购买 ETH：15,000 USDT ÷ $3,000 = 5 ETH
- 在 Balancer 提供 80/20 池流动性
- 获得 B-80BAL-20WETH LP Token
- 锁定 1 年获得 veBAL

**veBAL 权重计算：**
- 锁定 1 年 = 100% 权重
- 如果 3,000 BAL + 5 ETH = 30,000 USDT 等值
- 获得约 30,000 veBAL（1:1）

**投票策略：专注稳定币和蓝筹池**

小刘选择投票给：
1. **stETH-WETH Stable Pool**（30%）- 高交易量，低滑点
2. **wstETH-WETH**（25%）- LST 热门池
3. **USDC-DAI-USDT Stable Pool**（25%）- 稳定币交易
4. **GHO-USDC**（20%）- Aave 的 GHO 提供高 Bribes

**两周收益计算：**

**来源 1：协议手续费分成**
- Balancer 两周总手续费：约 $500,000
- 小刘 veBAL 占总量：0.1%
- 手续费分成：$500,000 × 0.1% × 50% = $250

**来源 2：Bribes（Hidden Hand）**
- stETH-WETH Bribes：$50,000
- 小刘收益：$50,000 × 0.1% × 30% = $15

- wstETH-WETH Bribes：$30,000
- 收益：$30,000 × 0.1% × 25% = $7.5

- USDC-DAI-USDT Bribes：$20,000
- 收益：$20,000 × 0.1% × 25% = $5

- GHO-USDC Bribes：$100,000（新池高激励）
- 收益：$100,000 × 0.1% × 20% = $20

**Bribes 小计：** $15 + $7.5 + $5 + $20 = $47.5

**来源 3：BAL 代币释放**
- 两周 BAL 释放：约 200,000 BAL
- 小刘占比：0.1%
- BAL 奖励：200,000 × 0.1% = 200 BAL（价值 $1,000）

**两周总收益：** $250 + $47.5 + $1,000 = $1,297.5

**年化收益：**
- 两周收益：$1,297.5
- 年化：$1,297.5 × 26 = $33,735
- 年化收益率：$33,735 ÷ $30,000 = 112.5%

**实际预期 APY：** 30-50%（考虑 BAL 价格波动和 Bribes 变化）

---

### 案例 2：通过 Aura Finance 参与（无锁定）

小刘的朋友小张不想锁定，选择 Aura：

**操作流程：**
1. 在 Balancer 提供 LP（如 wstETH-WETH）
2. 将 LP Token 存入 Aura Finance
3. 获得增强版 BAL 奖励 + AURA 代币
4. 无需锁定，随时可赎回（可能有小额退出费）

**收益对比：**

| 维度 | 直接持有 veBAL | 通过 Aura |
|------|---------------|----------|
| **年化收益** | 30-50% | 25-40% |
| **流动性** | 锁定 1 年 | 随时退出 |
| **复杂度** | 需要投票、Claim | 自动化 |
| **Gas 费** | 高（需多次交易）| 中（批量优化）|
| **额外代币** | 只有 BAL | BAL + AURA |

**小张的收益：**
- 投入 wstETH-WETH LP：$30,000
- Aura 增强 APR：35%
- 年收益：$30,000 × 35% = $10,500
- 额外获得 AURA 代币（可能增值）

**优势：**
- 无需管理投票
- 保持流动性
- 收益自动复投
- 获得 AURA 代币作为额外奖励

---

### 案例 3：高级组合策略（veBAL + Aura）

资深玩家老王采用双管齐下：

**资金分配：**
- 50% 直接锁定 veBAL：$50,000
- 50% 通过 Aura 提供 LP：$50,000

**策略 1：veBAL 部分**
- 专注投票给高 Bribes 的新项目池
- 追求最大化投票收益
- 年化：40-60%

**策略 2：Aura LP 部分**
- 提供稳定币或 LST 池流动性
- 获得稳定的 LP 收益 + Boost
- 年化：25-35%

**综合收益：**
- veBAL 收益：$50,000 × 50% = $25,000
- Aura 收益：$50,000 × 30% = $15,000
- 总年收益：$40,000
- 综合年化：$40,000 ÷ $100,000 = 40%

**优势：**
- 风险分散
- 一半资金保持流动性
- 收益结构多样化
- 既能享受高投票收益，又有稳定 LP 收入

---

## 🔧 操作步骤详解

### 准备阶段（首次设置：25 分钟）

**步骤 1：选择参与网络**

Balancer 支持多链部署：

| 网络 | TVL | Gas 费 | 适合人群 |
|------|-----|--------|---------|
| **以太坊主网** | 最高 | $20-50 | 大资金（>$10,000）|
| **Arbitrum** | 高 | $0.5-2 | 中等资金（$2,000-10,000）|
| **Polygon** | 中 | $0.1-0.5 | 小资金（<$2,000）|
| **Optimism** | 中 | $0.3-1 | 中小资金 |

**步骤 2：准备钱包和资金**
1. 安装 MetaMask
2. 切换到目标网络
3. 准备资金：
   - 如果参与 veBAL：需要 BAL + ETH（80:20 比例）
   - 如果只提供 LP：准备相应代币
4. 准备 Gas 费（ETH 或网络原生代币）

---

### 策略 1：创建 veBAL 锁定（30 分钟）

**步骤 3：获取 80/20 BAL/ETH LP Token**

1. 访问 app.balancer.fi
2. 连接钱包
3. 搜索 "B-80BAL-20WETH" 池
4. 点击 "Add Liquidity"
5. 按 80:20 比例输入 BAL 和 ETH 数量
6. 点击 "Preview"
7. 确认交易（Gas 费 $15-30）

**比例计算示例：**
- 准备 $10,000 投入
- BAL 价格 $5，ETH 价格 $3,000
- 需要：
  - BAL：$10,000 × 80% ÷ $5 = 1,600 BAL
  - ETH：$10,000 × 20% ÷ $3,000 = 0.667 ETH

**步骤 4：锁定 LP Token 获得 veBAL**

1. 在 Balancer 首页点击 "veBAL"
2. 点击 "Get veBAL"
3. 输入要锁定的 B-80BAL-20WETH 数量
4. 选择锁定时长（1 周 - 1 年）
5. 查看将获得的 veBAL 数量
6. 确认锁定交易（Gas 费 $20-40）

**锁定时长建议：**
- 测试：1-3 个月
- 中期：6 个月
- 最大化：1 年（获得 100% 权重）

**步骤 5：查看 veBAL 余额**
- 在 app.balancer.fi/vebal 查看
- 显示：
  - 锁定的 LP Token 数量
  - 当前 veBAL 余额
  - 解锁时间
  - 累积的未领取收益

---

### 策略 2：veBAL 投票赚取收益（每两周：10 分钟）

**步骤 6：研究 Gauge 权重**

1. 访问 app.balancer.fi/vebal
2. 点击 "Vote" 标签
3. 查看所有池子的信息：
   - Current votes：当前投票数
   - Next period BAL：下期 BAL 激励
   - Pool TVL：池子总锁仓
   - Pool APR：LP 收益率

**步骤 7：查看 Bribes（Hidden Hand）**

1. 访问 hiddenhand.finance/balancer
2. 查看当前 epoch 的 Bribes：
   - 每个池子的总 Bribes 金额
   - $/veBAL 比率（性价比指标）
   - Bribes 代币类型
3. 按 $/veBAL 排序找最优池

**高 Bribes 池特征：**
- 新上线的项目池（如 GHO、rETH）
- LST（流动性质押代币）池（如 wstETH）
- 稳定币池（交易量大）

**步骤 8：执行投票**

1. 在 Balancer veBAL 页面点击 "Vote"
2. 为不同池子分配投票权重
3. 可以投 1 个池，也可以分散投多个
4. 确保总计 100%
5. 点击 "Submit votes"
6. 确认交易（Gas 费 $15-25）

**投票策略示例：**

**保守型（稳定收益）：**
- 50% → USDC-DAI-USDT
- 30% → wstETH-WETH
- 20% → rETH-WETH

**激进型（追逐 Bribes）：**
- 100% 投给单个高 Bribes 新项目池
- 风险：项目可能失败，Bribes 消失
- 收益：可能获得数倍回报

**步骤 9：领取收益**

每两周 epoch 结束后：

1. 访问 app.balancer.fi/vebal
2. 点击 "Claim" 标签
3. 查看可领取：
   - Protocol fees（协议手续费，通常是 BAL/ETH）
   - BAL emissions（BAL 代币释放）
4. 点击 "Claim all"
5. 确认交易（Gas 费 $20-40）

**在 Hidden Hand 领取 Bribes：**

1. 访问 hiddenhand.finance/balancer
2. 连接钱包
3. 查看可领取的 Bribes（多种代币）
4. 点击 "Claim"
5. 确认交易

---

### 策略 3：通过 Aura Finance 参与（推荐普通用户）

**步骤 10：在 Balancer 提供 LP**

1. 选择一个池子（如 wstETH-WETH）
2. 点击 "Add Liquidity"
3. 输入资金数量（单币或多币）
4. 获得 BPT（Balancer Pool Token）

**步骤 11：将 BPT 存入 Aura**

1. 访问 app.aura.finance
2. 连接钱包
3. 找到对应的池子
4. 点击 "Deposit"
5. 授权 BPT（首次需要）
6. 存入 BPT
7. 开始赚取 BAL + AURA 奖励

**步骤 12：领取 Aura 奖励**

- Aura 会自动复投部分收益
- 定期 Claim BAL 和 AURA 代币
- 可以卖出或继续复投

---

## ⚠️ 风险提示

### 主要风险

**1. BAL 代币价格波动风险 ⭐⭐⭐⭐**
- **风险说明：** BAL 价格波动较大（历史区间 $3-80）
- **影响：** 即使投票收益高，BAL 下跌仍会侵蚀本金
- **应对措施：**
  - 通过 80/20 池参与，20% ETH 对冲部分风险
  - 定期兑现收益为稳定币
  - 分批建仓降低成本

**2. 多币池无常损失风险 ⭐⭐⭐⭐**
- **风险说明：** 多资产池的无常损失计算更复杂
- **影响：** 如果某个代币暴涨或暴跌，会产生损失
- **应对措施：**
  - 优先选择相关资产池（如 wstETH-rETH-sfrxETH）
  - 或稳定币池（无常损失极低）
  - 避免波动性大的代币组合

**3. 智能合约风险 ⭐⭐⭐**
- **风险说明：** Balancer 的多池路由增加了复杂度
- **应对措施：**
  - Balancer 已通过多次审计
  - 协议运行超过 4 年，TVL 超 10 亿美元
  - 但仍不要投入全部资产

**4. Bribes 不确定性 ⭐⭐⭐**
- **风险说明：** Hidden Hand 上的 Bribes 每轮变化
- **应对措施：**
  - 不要全部依赖 Bribes
  - 协议手续费是更稳定的收益来源
  - 分散投票

**5. Gas 费风险（以太坊主网）⭐⭐⭐**
- **风险说明：** 主网 Gas 费高
- **应对措施：**
  - 资金 < $5,000 建议在 L2 参与
  - 累积收益后再 Claim
  - 或通过 Aura 降低 Gas 成本

**6. Aura 集中化风险 ⭐⭐**
- **风险说明：** Aura 控制了大量 veBAL
- **影响：** Aura 的决策影响整个 Balancer 生态
- **应对措施：**
  - 分散一部分资金直接持有 veBAL
  - 关注 Aura 治理动态

---

## ❓ 常见问题 FAQ

**Q1：Balancer 和 Curve 有什么区别？**
A1：
- Balancer 支持多达 8 种代币，Curve 通常 2-4 种
- Balancer 可自定义权重，Curve 通常等权重
- Balancer 适合投资组合再平衡，Curve 专注稳定币
- Balancer veBAL 锁定最长 1 年，Curve veCRV 可锁 4 年
- Balancer 要求锁定 80/20 LP，降低了价格风险

**Q2：为什么要锁定 80/20 而不是纯 BAL？**
A2：
- 降低 BAL 价格波动风险（20% ETH 对冲）
- 鼓励为 BAL/ETH 池提供流动性
- 使 veBAL 持有者和协议利益一致
- 但这也意味着你需要同时持有 BAL 和 ETH

**Q3：Aura Finance 安全吗？**
A3：
- Aura 类似 Convex，为 Balancer 生态服务
- 已通过审计，运行超过 1 年
- 控制约 30-40% 的 veBAL 供应
- 相对安全，但仍有智能合约风险

**Q4：如何选择投票给哪些池子？**
A4：评估标准：
1. Hidden Hand 上的 $/veBAL 比率（越高越好）
2. 池子的 TVL 和交易量（稳定性指标）
3. 资产质量（避免高风险代币）
4. 历史 Bribes 稳定性

**Q5：Balancer 在 L2 上的收益如何？**
A5：
- L2（Arbitrum、Optimism）的 TVL 较低
- 收益可能比主网低 20-30%
- 但 Gas 费降低 95%，适合小资金
- 建议：资金 < $5,000 在 L2，> $10,000 在主网

**Q6：可以提前解锁 veBAL 吗？**
A6：
- 不能直接提前解锁
- veBAL 不可转让（与 Velodrome 不同）
- 只能等到期后解锁
- 或通过 Aura 间接参与（无锁定）

**Q7：如何优化多资产池的配置？**
A7：
- 选择相关资产（如 stETH-rETH-wstETH LST 池）
- 或稳定币池（USDC-DAI-USDT）
- 避免混合波动性差异大的资产
- 使用 Balancer 的 "Single Asset Deposit" 功能简化操作

**Q8：Balancer 的"Boosted Pools"是什么？**
A8：
- Boosted Pools 与借贷协议（如 Aave）集成
- 闲置流动性自动存入 Aave 赚取利息
- 既能赚交易手续费，又能赚借贷利息
- 收益更高，但复杂度也增加

**Q9：veBAL 的收益主要来自哪里？**
A9：收益占比：
- 协议手续费：40-50%（最稳定）
- Bribes：40-50%（波动大但高收益）
- BAL 释放：5-10%
建议：不要过度依赖 Bribes，手续费是基础

**Q10：需要多少资金参与？**
A10：
- 以太坊主网：建议 > $10,000（Gas 费占比 < 1%）
- Arbitrum：建议 > $3,000
- Polygon：可从 $500 开始
- 如果通过 Aura：门槛可降低 50%

---

## 📚 总结

Balancer veBAL 治理挖矿是 DeFi 中灵活性最高的流动性挖矿策略之一。相比 Curve 专注稳定币，Balancer 支持多资产池和自定义权重，为投资组合管理提供了更多可能性。

**关键要点：**
1. **多资产支持**：最多 8 种代币，自定义权重
2. **80/20 锁定**：降低价格风险的创新设计
3. **多链部署**：以太坊、Arbitrum、Polygon、Optimism
4. **Aura 生态**：为普通用户提供无锁定的参与方式
5. **灵活期限**：最长锁 1 年，比 Curve 更灵活

**收益预期：**
- 纯 veBAL 投票：年化 20-40%
- veBAL + 自己 LP Boost：年化 25-50%
- 通过 Aura 参与：年化 18-35%
- 综合策略：年化 30-65%

**适合人群：**
- 持有多种资产，希望统一管理
- DeFi 中高级用户，熟悉多资产池
- 中大资金（> $5,000）
- 看好 LST 或稳定币市场
- 愿意主动参与治理投票

**与其他协议对比：**
- vs Curve：更灵活，支持多资产，但稳定币交易不如 Curve 高效
- vs Uniswap V3：无需集中流动性管理，更适合被动投资
- vs Velodrome：锁定期更短（1 年 vs 4 年），但 veBAL 不可转让

**最终建议：**
如果你持有多种资产（特别是 ETH、wstETH、rETH 等 LST），Balancer 是非常好的收益工具。通过 veBAL 投票可以获得协议手续费分成和 Bribes，而 80/20 的设计降低了单一代币风险。

对于不想锁定的用户，Aura Finance 提供了极好的替代方案——收益略低，但保持流动性，操作更简单。

记住：DeFi 有风险，多资产池的无常损失需要认真评估。从小额开始，理解机制后再增加投入！`,
  steps: [
    '选择参与网络（以太坊主网或 L2）',
    '准备 BAL 和 ETH（80:20 比例）',
    '在 Balancer 提供 80/20 BAL/ETH 流动性',
    '锁定 LP Token 获得 veBAL（1 周 - 1 年）',
    '研究各池子的 TVL、交易量和 Gauge 权重',
    '在 Hidden Hand 查看 Bribes 信息',
    '制定投票策略并执行投票（每两周）',
    '定期 Claim 协议手续费和 Bribes',
    '处理收益：复投或兑换为稳定币',
    '（可选）通过 Aura Finance 参与（无锁定）',
    '锁定到期后选择重新锁定或解锁退出'
  ]
};

const STRATEGY_14_6 = {
  title: 'GMX V2 流动性提供 - 永续合约流动性池',
  slug: 'liquidity-mining-14-6-gmx-v2-liquidity',
  summary: '为 GMX V2 提供 GM Token 流动性，作为永续合约交易的对手方赚取交易手续费。支持单币提供流动性，收益稳定，适合看好衍生品市场的投资者。',
  category: 'liquidity-mining',
  category_l1: 'yield',
  category_l2: '流动性引导',
  difficulty_level: 'intermediate',
  risk_level: 4,
  apy_min: 12,
  apy_max: 50,
  threshold_capital: '中等',
  threshold_capital_min: 2000,
  time_commitment: '极低',
  time_commitment_minutes: 15,
  threshold_tech_level: 'intermediate',
  status: 'published',
  content: `# GMX V2 流动性提供 - 永续合约流动性池

## 📖 小赵的合约困境

小赵是个期货老玩家，经常在中心化交易所（如 Binance）做永续合约。但他发现：
- 中心化交易所可能冻结账户
- 需要 KYC 验证
- 资金不在自己掌控中
- 深度不足时滑点很大

后来他发现了 GMX——去中心化的永续合约平台，不仅可以交易，还能通过提供流动性赚取交易者的手续费。这就像成为"去中心化交易所的庄家"。

**中心化合约交易的问题：**
- 需要 KYC，隐私泄露
- 平台可能跑路或冻结资金
- 高杠杆诱导过度交易
- 手续费被平台赚走

**GMX V2 流动性提供的优势：**
- 完全去中心化，资金自己掌控
- 提供流动性即成为交易对手方
- 赚取交易者支付的手续费
- 支持单币提供流动性（无无常损失风险）
- 多链部署（Arbitrum、Avalanche）

---

## 🎯 策略核心原理

### GMX 是什么？

GMX 是去中心化永续合约交易平台，核心特点：

**1. 永续合约交易**
- 支持 BTC、ETH、ARB 等主流币种
- 最高 50 倍杠杆
- 零滑点（使用预言机价格）
- 低手续费（开仓 0.05-0.07%）

**2. 流动性池设计**

GMX V2 引入了全新的 GM Token 机制：

- 每个交易对有独立的流动性池（如 ETH/USD、BTC/USD）
- LP 提供的资金作为交易者的对手方
- 交易者盈利 = LP 亏损，交易者亏损 = LP 盈利
- LP 赚取所有交易手续费

**3. 单币提供流动性**

这是 GMX V2 的重大创新：
- 可以只用 ETH 提供流动性（不需要配对 USDC）
- 或只用 USDC 提供
- 或按任意比例混合
- 避免了传统 AMM 的无常损失

### 收益来源

| 收益类型 | 说明 | 占比 | 稳定性 |
|---------|------|------|--------|
| **交易手续费** | 开仓、平仓、资金费率 | 70% | ⭐⭐⭐⭐ |
| **清算手续费** | 清算爆仓头寸的奖励 | 15% | ⭐⭐⭐ |
| **借贷利息** | 杠杆交易者支付的借币利息 | 10% | ⭐⭐⭐⭐⭐ |
| **价格影响费** | 大额交易支付的额外费用 | 5% | ⭐⭐ |

**核心逻辑：**
- 交易越活跃 → 手续费越多 → LP 收益越高
- 交易者整体倾向于亏损（零和博弈）→ LP 长期盈利

### 风险：成为交易对手方

LP 的盈亏与交易者相反：
- 如果交易者整体盈利（如单边牛市，大量做多成功）→ LP 亏损
- 如果交易者整体亏损（大部分情况）→ LP 盈利

**历史数据显示：**
- 80% 的合约交易者长期亏损
- LP 的 PnL（盈亏）长期为正
- 但短期（如单边暴涨行情）可能出现浮亏

---

## 📊 收益对比表

| 流动性池 | 资产类型 | 预计年化收益 | 风险等级 | 波动性 | 适合人群 |
|---------|---------|------------|---------|--------|---------|
| **ETH/USD** | 50% ETH + 50% USDC | 15-35% | ⭐⭐⭐⭐ | 高 | 看好 ETH 长期上涨 |
| **BTC/USD** | 50% BTC + 50% USDC | 12-30% | ⭐⭐⭐⭐ | 中高 | BTC 长期持有者 |
| **ARB/USD** | 50% ARB + 50% USDC | 20-50% | ⭐⭐⭐⭐⭐ | 极高 | 激进投资者 |
| **纯 USDC 池** | 100% USDC | 8-18% | ⭐⭐ | 极低 | 保守投资者 |
| **纯 ETH 池** | 100% ETH | 18-40% | ⭐⭐⭐⭐ | 高 | ETH 信仰者 |

---

## 💰 收益计算示例

### 案例 1：平衡策略（50% ETH + 50% USDC）

小赵投入 20,000 USDT：

**初始设置：**
- 购买 ETH：10,000 USDT ÷ $2,000/ETH = 5 ETH
- 保留 USDC：10,000 USDC
- 在 GMX V2 提供 ETH/USD 流动性
- 获得 GM-ETH Token

**月度收益计算：**

**来源 1：交易手续费**
- ETH/USD 池月交易量：$500,000,000
- 开仓费率：0.06%
- 平仓费率：0.06%
- 总手续费：$500M × (0.06% + 0.06%) = $600,000
- 小赵占池子份额：0.05%
- 手续费收入：$600,000 × 0.05% = $300

**来源 2：借贷利息**
- 杠杆交易者借 ETH 和 USDC
- 年化利率：5-10%（动态调整）
- 小赵的资金被借用比例：70%
- 月利息收入：$20,000 × 70% × 8% ÷ 12 = $93

**来源 3：资金费率**
- 多空不平衡时，一方支付费用给另一方
- LP 从中抽成
- 平均月收入：约 $50

**来源 4：清算收入**
- 爆仓头寸清算，LP 获得部分抵押品
- 月收入：约 $30（波动大）

**月总收益：** $300 + $93 + $50 + $30 = $473

**月收益率：** $473 ÷ $20,000 = 2.37%
**年化收益率：** 2.37% × 12 = 28.4%

**但需要考虑 PnL 风险：**
- 如果交易者整体盈利 $10,000，LP 对应亏损
- 如果交易者整体亏损 $15,000，LP 对应盈利
- 历史数据：交易者平均月亏损 1-2%
- 小赵的 PnL 收益：$20,000 × 1.5% = $300

**实际月收益：** $473 + $300 = $773
**实际年化收益率：** 约 35-40%

---

### 案例 2：保守策略（100% USDC 提供）

小李不想承担 ETH 价格波动，只用 USDC：

**操作：**
- 投入 20,000 USDC 到 ETH/USD 池
- GMX 会将 USDC 作为池子的 USD 一侧
- 只赚取手续费和利息，不承担 ETH 价格风险

**收益计算：**
- 交易手续费：$300/月（与案例 1 相同）
- 借贷利息：$93/月
- 资金费率：$50/月
- PnL 收益：$150/月（因为只做 USD 一侧，只承担交易者在 USD 侧的盈亏）

**月总收益：** $300 + $93 + $50 + $150 = $593
**年化收益率：** 约 25-30%

**优势：**
- 无 ETH 价格波动风险
- 收益稳定可预测
- 适合稳健投资者

---

### 案例 3：激进策略（100% ETH 提供）

老张是 ETH 信仰者，全部用 ETH 提供流动性：

**操作：**
- 投入 10 ETH（价值 $20,000）到 ETH/USD 池
- 只做 ETH 一侧的流动性

**收益：**
- 交易手续费：$300/月
- ETH 借贷利息：更高（因为杠杆多头需要借 ETH）
- 利息收入：$150/月
- PnL：如果 ETH 涨，做多交易者盈利，老张亏损；如果 ETH 跌，做空交易者盈利，老张也可能亏损

**风险：**
- ETH 价格暴涨时，大量做多成功，LP 亏损严重
- ETH 价格暴跌时，大量做空成功，LP 也亏损
- 适合对 ETH 价格走势有判断的高级玩家

**预期年化：** 30-50%（高风险高收益）

---

### 案例 4：多池分散策略

资深玩家老王分散投资多个池子：

**资金分配：**
- 40% → ETH/USD（50/50 平衡）：$16,000
- 30% → BTC/USD（50/50 平衡）：$12,000
- 20% → 纯 USDC 到 ARB/USD：$8,000
- 10% → 纯 USDC 到 AVAX/USD：$4,000

**总投入：** $40,000

**月收益：**
- ETH/USD：$380
- BTC/USD：$250
- ARB/USD：$180
- AVAX/USD：$90
- 总计：$900

**年化收益率：** $900 × 12 ÷ $40,000 = 27%

**优势：**
- 风险分散到多个池子
- 不同资产的交易活跃度不同
- 降低单一资产暴涨暴跌的 PnL 风险

---

## 🔧 操作步骤详解

### 准备阶段（首次设置：15 分钟）

**步骤 1：选择网络**

GMX V2 支持：
- **Arbitrum**（推荐）：交易量最大，流动性最好
- **Avalanche**：交易量较小，但手续费更便宜

**步骤 2：准备钱包和资金**
1. 安装 MetaMask
2. 添加 Arbitrum 网络
3. 准备资金：
   - 如果提供 ETH/USD：准备 ETH 和 USDC（可以任意比例）
   - 如果只用单币：只准备 ETH 或 USDC
4. 准备少量 ETH 作为 Gas 费（0.001 ETH 足够）

---

### 提供流动性（10 分钟）

**步骤 3：访问 GMX V2**

1. 访问 app.gmx.io
2. 连接钱包
3. 切换到 Arbitrum 网络
4. 点击顶部 "Earn" 标签

**步骤 4：选择流动性池**

GMX V2 展示所有可用池子：

| 池子 | TVL | APY | 交易量 | 推荐度 |
|------|-----|-----|--------|-------|
| **ETH/USD** | 最高 | 15-35% | 最大 | ⭐⭐⭐⭐⭐ |
| **BTC/USD** | 高 | 12-30% | 大 | ⭐⭐⭐⭐⭐ |
| **ARB/USD** | 中 | 20-50% | 中 | ⭐⭐⭐⭐ |
| **AVAX/USD** | 中 | 18-40% | 中 | ⭐⭐⭐ |

选择标准：
- 新手：选 ETH/USD 或 BTC/USD（流动性最好）
- 激进：选 ARB/USD（波动大，收益高）
- 保守：选 ETH/USD 但只提供 USDC 一侧

**步骤 5：存入资金**

1. 点击你选择的池子
2. 点击 "Buy GM"（GM 是该池子的 LP Token）
3. 选择存入资产：
   - **Long**：提供 ETH（或 BTC/ARB 等）
   - **Short**：提供 USDC
   - **Mixed**：两者都提供
4. 输入金额
5. 点击 "Preview"
6. 查看：
   - 将获得的 GM Token 数量
   - 池子当前比例（Long/Short Ratio）
   - 预估 APY
7. 确认交易（Gas 费 $0.5-2）

**池子比例建议：**
- 如果池子 Long 过多（> 60%），提供 USDC 会获得奖励
- 如果池子 Short 过多（> 60%），提供 ETH 会获得奖励
- 平衡池子可降低 PnL 风险

---

### 监控和管理（每周 5 分钟）

**步骤 6：查看收益和 PnL**

1. 在 GMX V2 "Earn" 页面查看持仓
2. 关键指标：
   - **Total Value**：当前 LP 总价值
   - **PnL**：盈亏情况（绿色为盈利，红色为亏损）
   - **Fees Earned**：累计赚取的手续费
   - **APY**：实时年化收益率

**PnL 解读：**
- 正 PnL：交易者整体亏损，你在赚钱
- 负 PnL：交易者整体盈利，你在亏损
- 长期来看，PnL 通常为正（交易者平均亏损）

**步骤 7：领取收益**

GMX V2 的收益自动累积在 GM Token 中，无需手动 Claim：
- 手续费自动复投
- GM Token 的价值会随时间增长
- 提取时会自动获得所有累积收益

**步骤 8：再平衡（可选）**

如果池子比例失衡：
1. 查看 Long/Short Ratio
2. 如果 Long 过多，可以卖出部分 GM 并重新买入时多提供 USDC
3. 或等待市场自然再平衡

---

### 提取流动性（5 分钟）

**步骤 9：赎回 GM Token**

1. 在 "Earn" 页面点击你的池子
2. 点击 "Sell GM"
3. 选择要赎回的比例（可以部分赎回）
4. 选择接收资产：
   - 赎回为 ETH
   - 赎回为 USDC
   - 或按当前池子比例混合赎回
5. 点击 "Preview"
6. 查看：
   - 将收到的资产数量
   - 总收益（包括手续费 + PnL）
   - 是否有退出费用（通常无）
7. 确认交易

**提取注意事项：**
- 无锁定期，随时可以退出
- 极端行情时可能有小额滑点
- 建议在交易量低时提取（减少影响）

---

## ⚠️ 风险提示

### 主要风险

**1. PnL 风险（核心风险）⭐⭐⭐⭐⭐**
- **风险说明：** LP 是交易者的对手方，交易者盈利 = LP 亏损
- **影响：** 单边行情时（如暴涨暴跌），大量交易者盈利，LP 出现亏损
- **历史案例：**
  - 2023 年 3 月 ETH 暴涨 30%，大量做多盈利，ETH/USD LP 短期亏损 5-8%
  - 但 2023 全年，交易者整体亏损，LP 最终盈利 25%+
- **应对措施：**
  - 长期持有（至少 6 个月），平滑短期波动
  - 分散到多个池子
  - 只提供 USDC 一侧，降低波动
  - 关注市场情绪，极度贪婪时（大量做多）减少持仓

**2. 资产价格波动风险 ⭐⭐⭐⭐**
- **风险说明：** 如果提供 ETH 流动性，ETH 价格下跌会影响本金
- **应对措施：**
  - 只提供 USDC 避免价格风险
  - 或 50/50 平衡策略
  - 对冲：在其他平台做空 ETH

**3. 智能合约风险 ⭐⭐⭐**
- **风险说明：** GMX V2 是较新的协议（2023 年上线）
- **应对措施：**
  - GMX V1 运行 2 年无重大事故
  - V2 已通过审计，但仍有潜在风险
  - 不要投入全部资产

**4. 流动性风险（极端行情）⭐⭐**
- **风险说明：** 极端行情时可能暂时无法退出
- **应对措施：**
  - 保留一定现金应急
  - 分批退出
  - 通常 24-48 小时内恢复正常

**5. 清算瀑布风险 ⭐⭐⭐**
- **风险说明：** 如果大量杠杆多头被清算，LP 可能短期浮亏
- **应对措施：**
  - 关注市场杠杆率（GMX 仪表板提供数据）
  - 杠杆率过高时（> 10 倍平均）降低持仓

**6. Arbitrum 网络风险 ⭐⭐**
- **风险说明：** Arbitrum 作为 L2，依赖以太坊主网
- **应对措施：**
  - Arbitrum 由 Offchain Labs 开发，技术成熟
  - 风险相对较低

---

## ❓ 常见问题 FAQ

**Q1：GMX LP 和传统 AMM LP 有什么区别？**
A1：
- GMX：LP 是交易者的对手方，赚取手续费但承担 PnL 风险
- AMM（如 Uniswap）：LP 提供流动性给交易者，赚取手续费但承担无常损失
- GMX 适合看好交易者整体亏损，AMM 适合看好双币价格相对稳定

**Q2：为什么交易者长期会亏损？**
A2：
- 合约交易是零和博弈（不考虑手续费）
- 大部分散户过度杠杆、情绪化交易
- 历史数据：70-80% 交易者长期亏损
- 这让 LP 长期盈利

**Q3：单边行情时 LP 会损失多少？**
A3：
- 假设 ETH 暴涨 20%，大量做多成功
- LP 可能短期亏损 3-5%
- 但手续费收入可部分抵消
- 如果只提供 USDC 一侧，亏损更小

**Q4：可以只提供一种资产吗？**
A4：
- 可以！这是 GMX V2 的创新
- 只提供 ETH：更高收益，但承担 ETH 价格风险
- 只提供 USDC：更稳定，但收益略低
- 50/50：平衡风险和收益

**Q5：如何查看交易者的持仓情况？**
A5：
1. 访问 GMX 仪表板
2. 查看 Long/Short Ratio
3. 如果 Long 过多，说明市场偏多，可能面临清算风险
4. 可以据此调整策略

**Q6：GMX V2 和 V1 有什么区别？**
A6：
- V1：使用 GLP 单一流动性池，所有资产混合
- V2：每个交易对独立池子，更灵活
- V2 支持单币提供流动性
- V2 的 PnL 风险更可控

**Q7：收益多久结算一次？**
A7：
- 收益实时累积在 GM Token 价值中
- 无需手动 Claim
- 提取 GM Token 时自动获得所有收益

**Q8：需要多少资金参与？**
A8：
- 最低：$100（但收益太小）
- 建议：$2,000+（才能覆盖 Gas 费和获得可观收益）
- 理想：$10,000+（充分分散风险）

**Q9：可以在多个池子同时提供流动性吗？**
A9：
- 可以！建议分散到 2-3 个池子
- 例如：50% ETH/USD + 30% BTC/USD + 20% ARB/USD
- 降低单一资产的 PnL 风险

**Q10：如果 PnL 一直是负的怎么办？**
A10：
- 短期负 PnL 是正常的（市场波动）
- 如果连续 3 个月负 PnL，考虑：
  - 检查是否处于单边牛市或熊市
  - 调整为 100% USDC 策略
  - 或暂时退出等待市场平稳

**Q11：GMX 的手续费收入稳定吗？**
A11：
- 取决于交易量
- 高波动期（如 FOMC 会议、黑天鹅事件）：交易量暴增，手续费翻倍
- 平静期：交易量下降，手续费减少
- 平均来看，手续费收入相对稳定（占 APY 的 60-70%）

**Q12：GMX 安全吗？会不会跑路？**
A12：
- GMX 是去中心化协议，无法跑路
- 代码开源，已通过审计
- V1 运行 2 年无重大事故
- 但仍有智能合约风险，建议分散投资

---

## 📚 总结

GMX V2 流动性提供是 DeFi 中独特的收益策略——你不是为交易者提供便利，而是直接成为他们的对手方。这是一场"庄家 vs 散户"的博弈，而历史数据表明，庄家（LP）长期占优。

**关键要点：**
1. **对手方机制**：LP 收益 = 交易者亏损
2. **手续费为主**：60-70% 收益来自稳定的手续费
3. **PnL 波动**：短期可能亏损，长期通常盈利
4. **单币灵活性**：可以只用 USDC，避免价格风险
5. **多链部署**：Arbitrum、Avalanche

**收益预期：**
- 保守策略（纯 USDC）：年化 12-25%
- 平衡策略（50/50）：年化 18-35%
- 激进策略（纯 ETH）：年化 25-50%

**适合人群：**
- 相信"大部分合约交易者会亏损"
- 愿意承担短期 PnL 波动
- 中长期投资者（至少 6 个月）
- 有一定 DeFi 和合约交易知识
- 中等资金量（$2,000+）

**与其他策略对比：**
- vs Uniswap LP：无无常损失，但有 PnL 风险
- vs Curve LP：收益更高，但风险也更大
- vs Aave 借贷：收益更高，但需要主动管理

**风险管理建议：**
1. 分散到多个池子（ETH、BTC、ARB）
2. 优先提供 USDC 一侧（降低波动）
3. 长期持有平滑短期 PnL 波动
4. 关注市场情绪和杠杆率
5. 不要投入超过 30% 的总资产

记住：GMX LP 本质上是在赌交易者的失败。如果你相信"散户必输定律"，这是一个高收益的策略；但如果市场出现持续单边行情，LP 也会面临短期亏损。做好风险管理，长期来看回报可观！`,
  steps: [
    '选择网络（推荐 Arbitrum）并准备钱包',
    '决定策略：纯 USDC / 纯 ETH / 50-50 平衡',
    '访问 GMX V2 并连接钱包',
    '选择流动性池（推荐 ETH/USD 或 BTC/USD）',
    '存入资金获得 GM Token',
    '每周查看 PnL 和收益情况',
    '（可选）根据市场情况调整池子比例',
    '提取时赎回 GM Token 获得本金和收益'
  ]
};

async function getAuthToken() {
  try {
    const response = await axios.post('http://localhost:8055/auth/login', {
      email: 'the_uk1@outlook.com',
      password: 'Mygcdjmyxzg2026!'
    });
    return response.data.data.access_token;
  } catch (error) {
    console.error('认证失败:', error.response?.data || error.message);
    throw error;
  }
}

async function createStrategies() {
  try {
    const token = await getAuthToken();
    console.log('认证成功，开始创建策略...\n');

    // 创建策略 14.5
    console.log('正在创建策略 14.5: Balancer veBAL 治理挖矿...');
    const response1 = await axios.post(
      'http://localhost:8055/items/strategies',
      STRATEGY_14_5,
      {
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        }
      }
    );
    console.log('✅ 策略 14.5 创建成功! ID:', response1.data.data.id);
    console.log(`   标题: ${STRATEGY_14_5.title}`);
    console.log(`   Slug: ${STRATEGY_14_5.slug}\n`);

    // 创建策略 14.6
    console.log('正在创建策略 14.6: GMX V2 流动性提供...');
    const response2 = await axios.post(
      'http://localhost:8055/items/strategies',
      STRATEGY_14_6,
      {
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        }
      }
    );
    console.log('✅ 策略 14.6 创建成功! ID:', response2.data.data.id);
    console.log(`   标题: ${STRATEGY_14_6.title}`);
    console.log(`   Slug: ${STRATEGY_14_6.slug}\n`);

    // 获取总策略数
    const countResponse = await axios.get(
      'http://localhost:8055/items/strategies?aggregate[count]=id',
      {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      }
    );
    const totalCount = countResponse.data.data[0].count.id;
    console.log('========================================');
    console.log('🎉 所有策略创建完成！');
    console.log(`📊 当前数据库中共有 ${totalCount} 个策略`);
    console.log('========================================');

  } catch (error) {
    console.error('❌ 创建策略时出错:', error.response?.data || error.message);
    throw error;
  }
}

createStrategies();
