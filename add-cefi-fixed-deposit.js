const axios = require('axios');

const DIRECTUS_URL = 'http://localhost:8055';

const GUIDE_CONFIG = {
  title: 'CeFi 定期理财锁仓',
  slug: 'cefi-fixed-deposit',
  summary:
    'CeFi定期理财锁仓实战：Binance/OKX/Bybit定期产品对比（5-12% APY）、7天/30天/90天期限选择、自动续期设置、提前赎回规则、阶梯式到期策略、VIP等级加息、双币宝固定期限、利率锁定机制、流动性管理、平台倒闭风险防范、$30K本金90天赚$900案例。',

  category: 'stablecoin-yield',
  category_l1: 'yield',
  category_l2: '稳定币理财',

  difficulty_level: 1,
  risk_level: 2,
  apy_min: 5,
  apy_max: 12,

  threshold_capital: '1,000–100,000 USD（定期锁仓，流动性降低）',
  threshold_capital_min: 1000,
  time_commitment: '初始设置30分钟，到期续投每月10分钟，完全自动化可选',
  time_commitment_minutes: 10,
  threshold_tech_level: 'beginner',

  content: `> **适用人群**：持有稳定币、确定一段时间不需要使用资金、追求高于活期的收益率、低风险偏好的保守型投资者

> **阅读时间**：≈ 15–20 分钟

> **关键词**：Fixed Deposit / Term Savings / Locked Staking / Auto-renewal / Maturity Date / Early Redemption / Ladder Strategy / CEX Earn

---

## 🧭 TL;DR

**核心策略**：将稳定币锁定在CEX的定期理财产品中，换取比活期更高的收益率。

**定期 vs 活期对比**：
- **活期理财**：3-5% APY，随时提现
- **7天定期**：4-6% APY，锁定7天
- **30天定期**：5-8% APY，锁定30天
- **90天定期**：6-12% APY，锁定90天

**收益模型**（$30K本金）：
- **活期4%**：$30K × 4% = $1,200/年（$100/月）
- **30天定期6%**：$30K × 6% = $1,800/年（$150/月）
- **90天定期10%**：$30K × 10% = $3,000/年（$250/月）

**多赚收益**：
- 30天定期 vs 活期：+$600/年（+50%）
- 90天定期 vs 活期：+$1,800/年（+150%）

**优势**：
- ✅ 收益高于活期（多1-5%）
- ✅ 操作简单（一键申购）
- ✅ 门槛低（$100起）
- ✅ 收益稳定可预测

**劣势**：
- ❌ 锁定期内无法提现（流动性差）
- ❌ 提前赎回损失利息
- ❌ 平台倒闭风险（FTX前车之鉴）
- ❌ 利率可能下调（续投时APY变化）

---

## 📊 定期理财产品对比

### 主流平台利率表（2025年1月）

#### Binance Locked Staking
| 期限 | USDT APY | USDC APY | 最低金额 | 提前赎回 |
|------|----------|----------|----------|----------|
| 7天 | 4.5% | 4.2% | $100 | 损失全部利息 |
| 30天 | 6.0% | 5.8% | $100 | 损失全部利息 |
| 90天 | 8.5% | 8.2% | $100 | 不可提前 |
| 180天 | 10% | 9.5% | $1,000 | 不可提前 |

#### OKX Fixed Earning
| 期限 | USDT APY | USDC APY | 最低金额 | 提前赎回 |
|------|----------|----------|----------|----------|
| 7天 | 4.0% | 3.8% | $10 | 扣除3天利息 |
| 30天 | 5.5% | 5.2% | $10 | 扣除7天利息 |
| 60天 | 7.5% | 7.2% | $100 | 扣除10天利息 |
| 90天 | 9.0% | 8.5% | $100 | 不可提前 |

#### Bybit Savings
| 期限 | USDT APY | USDC APY | 最低金额 | 提前赎回 |
|------|----------|----------|----------|----------|
| 7天 | 5.0% | 4.8% | $50 | 损失全部利息 |
| 30天 | 6.5% | 6.2% | $50 | 损失全部利息 |
| 90天 | 10% | 9.5% | $50 | 不可提前 |

---

## ⏰ 期限选择策略

### 短期（7天）

**适合场景**：测试定期产品、短期闲置资金、市场不确定时

**收益**：APY 4-5%（比活期高0.5-1%），$10K每周赚$8.7

**优势**：灵活度高（仅锁7天）、可快速调整策略

**劣势**：收益提升有限、频繁到期需续投

---

### 中期（30天）

**适合场景**：确定一个月不用资金、平衡收益与流动性、主流选择

**收益**：APY 5.5-6.5%（比活期高2-3%），$30K每月赚$150

**优势**：收益显著提升、到期频率适中（每月续投一次）

**劣势**：锁定期中等

---

### 长期（90天）

**适合场景**：长期闲置资金、追求高收益、熊市囤币期

**收益**：APY 8-10%（比活期高4-6%），$50K每90天赚$1,250

**优势**：收益率最高、减少续投次数

**劣势**：流动性差（锁定3个月）、提前赎回通常不可能

---

## 🪜 阶梯式到期管理

### 什么是阶梯策略

**问题**：全部资金锁定90天，中途急需用钱无法提现

**解决方案**：分批锁定，到期日分散，确保每月都有资金到期可用

---

### 阶梯式配置示例

#### 配置方案A：三阶梯（30天期）

总资金$30K，分成3批：
- 1月1日：$10K锁定30天（2月1日到期）
- 1月10日：$10K锁定30天（2月10日到期）
- 1月20日：$10K锁定30天（2月20日到期）

**结果**：
- 每10天有$10K到期
- 应急时最多等10天
- 全部资金享受30天定期利率6%
- 年收益：$30K × 6% = $1,800

---

#### 配置方案B：混合阶梯

总资金$30K：
- 活期：$5K（应急资金）
- 30天定期：$10K
- 90天定期：$15K

**收益**：
- 活期：$5K × 4% = $200
- 30天：$10K × 6% = $600
- 90天：$15K × 10% = $1,500
- 总收益：$2,300/年（7.67% APY）

**流动性**：紧急情况可用$5K活期，每月有$10K定期到期

---

## 🔄 自动续期设置

### 什么是自动续期

**定义**：到期后自动申购同期限产品

**示例**：申购$10K USDT 30天定期（6% APY），开启自动续期，30天后自动续投30天定期

---

### 自动续期优劣

**优势**：
- ✅ 省时省力：无需每月手动操作
- ✅ 不错过收益：避免到期后闲置
- ✅ 复利效应：利息自动再投入

**劣势**：
- ❌ 利率可能下调：续投时APY可能从6%降至4%
- ❌ 失去调整机会：无法根据市场切换策略
- ❌ 资金锁定：持续锁定，无法退出

---

### 最佳实践

**推荐**：
- ❌ 不推荐无限次自动续期（失去灵活性）
- ✅ 推荐续投1-2次（平衡自动化与控制）
- ✅ 设置日历提醒（到期前评估是否继续）

---

## ⚠️ 提前赎回规则

### 各平台规则对比

| 平台 | 7天定期 | 30天定期 | 90天定期 |
|------|---------|----------|----------|
| Binance | 损失全部利息 | 损失全部利息 | 不可提前赎回 |
| OKX | 扣3天利息 | 扣7天利息 | 不可提前赎回 |
| Bybit | 损失全部利息 | 损失全部利息 | 不可提前赎回 |

---

### 提前赎回成本计算

#### 示例A：Binance 30天定期

申购$10K USDT，30天，6% APY，第15天提前赎回：
- 预期利息：$10K × 6% ÷ 12 = $50
- 实际利息：$0（损失全部利息）
- 损失：$50

**结论**：Binance提前赎回代价高，需谨慎

---

#### 示例B：OKX 30天定期

申购$10K USDT，30天，5.5% APY，第15天提前赎回：
- 已产生利息：$10K × 5.5% × 15/365 = $22.6
- 扣除7天利息：$10K × 5.5% × 7/365 = $10.5
- 实际获得利息：$22.6 - $10.5 = $12.1

**结论**：OKX提前赎回友好（扣除部分而非全部）

---

## 📈 利率优化技巧

### 1. VIP等级加息

**Binance VIP阶梯**：
| 等级 | 30天交易量 | 定期加息 |
|------|-----------|---------|
| VIP 0 | <$1M | 0% |
| VIP 1 | $1M+ | +0.3% |
| VIP 2 | $10M+ | +0.7% |

**策略**：通过套利刷量至VIP 1，定期APY从6%升至6.3%，$50K本金额外收益$150/年

---

### 2. BNB持仓加息

**规则**：持有≥1 BNB定期+0.5% APY，持有≥10 BNB定期+1% APY

**成本收益分析**：
- 持有10 BNB（价值$3,000）
- $50K定期本金加息1%：$50K × 1% = $500/年
- BNB机会成本：$3,000 × 5% = $150/年
- 净收益：$500 - $150 = $350/年

**结论：值得！**

---

### 3. 新用户福利

**Bybit新用户**：首笔定期享受12% APY（前30天），最高$10K额度

**策略**：注册家庭成员账户，每个账户$10K定期，3个账户额外$200/月

---

## 💰 真实收益案例

### 案例1：保守型（$30K，30天阶梯）

**配置**：Binance 30天定期（6% APY），阶梯式$10K × 3批

**年度收益**：
- 总本金：$30K
- 年化APY：6%
- 年收益：$1,800
- 对比活期（4%）：多赚$600/年（+50%）

**操作时间**：每月续投1次，每次5分钟，总计60分钟/年

---

### 案例2：平衡型（$50K，混合配置）

**配置**：
- 活期：$10K（4% APY）
- 30天定期：$20K（6% APY）
- 90天定期：$20K（10% APY）

**年度收益**：
- 活期：$400
- 30天：$1,200
- 90天：$2,000
- 总收益：$3,600（7.2% APY）
- 对比全活期：多赚$1,600/年（+80%）

---

### 案例3：激进型（$100K，VIP加持）

**配置**：
- Binance VIP 2（刷量$10M/月）
- 90天定期：$100K
- 基础APY：10% + VIP加息0.7% + BNB加息1% = 11.7%

**年度收益**：$100K × 11.7% = $11,700

---

## ❓ 常见问题FAQ

**Q1：定期比活期多赚多少？**
> 一般多1-5% APY。例如30天定期6% vs 活期4%（多50%收益），90天定期10% vs 活期4%（多150%收益）。但需要牺牲流动性。

**Q2：提前赎回会怎样？**
> 看平台。Binance/Bybit：损失全部利息。OKX：扣除部分天数利息。建议：预留应急资金，避免提前赎回。

**Q3：自动续期好吗？**
> 看情况。优势：省事+不错过收益。劣势：利率可能下降+无法调整策略。建议：续投1-2次（而非无限次）。

**Q4：定期安全吗？**
> 相对安全，但非绝对。风险：平台倒闭（FTX教训）。建议：选大平台+单平台<50%资金+定期提现到冷钱包。

**Q5：多少资金适合定期？**
> 看流动性需求。保守型：30%定期+70%活期。平衡型：50%定期+50%活期。激进型：80%定期+20%活期。

---

## ✅ 执行清单

### 新手快速开始（1小时）
- [ ] 评估流动性需求（未来3个月是否用钱）
- [ ] 测试申购$1K USDT 7天定期
- [ ] 设置到期日提醒（Google Calendar）
- [ ] 观察7天后收益到账

### 规模化配置（第2周）
- [ ] 增加至$10K-$50K本金
- [ ] 选择期限（30天平衡 or 90天激进）
- [ ] 建立阶梯式配置（分3批申购）
- [ ] 决定是否开启自动续期（推荐1-2次）

### 长期管理（持续）
- [ ] 每月检查到期产品（到期前3天）
- [ ] 对比当前利率（是否续投）
- [ ] 每月提现20%利息到冷钱包
- [ ] 每季度审查资金分配
- [ ] 关注平台动态（风险信号）

---

## 🔚 结语

CeFi定期理财锁仓是**提升稳定币收益的简单方法**：
- ✅ 优势：收益高于活期（多1-5% APY）、操作简单、门槛低
- ⚠️ 风险：流动性降低、平台倒闭风险、提前赎回损失

**三个核心原则**：
1. **流动性管理**：预留20-30%应急资金在活期
2. **阶梯式配置**：分批到期，平衡收益与流动性
3. **平台分散**：单平台<50%资金，定期提现到冷钱包

定期理财是**提升稳定币收益的必修课**！💰🔒
`,

  steps: [
    { step_number: 1, title: '流动性需求评估', description: '评估未来3-6个月资金使用计划，计算需要保留的应急资金（建议总资金的20-30%），确定可用于定期锁仓的金额，理解提前赎回规则和成本（Binance损失全部利息，OKX扣除部分），决定适合的期限（7天/30天/90天）。', estimated_time: '30 分钟' },
    { step_number: 2, title: '平台选择与测试', description: '对比Binance/OKX/Bybit的定期产品利率和规则，新手小额测试$1K USDT 7天定期（体验流程），查看申购后收益累积情况，测试到期赎回流程（确认资金到账时间），评估用户体验选择主力平台。', estimated_time: '1–2 小时' },
    { step_number: 3, title: '阶梯式配置部署', description: '将资金分成3-5批（如$30K分成$10K×3批），间隔5-10天申购同期限产品（如都选30天），设置到期日提醒（Google Calendar/手机备忘录），首次到期时评估是否续投（查看当前利率），建立滚动续投节奏。', estimated_time: '1 小时' },
    { step_number: 4, title: '收益优化配置', description: '评估VIP等级加息是否值得（需刷交易量），考虑持有BNB享受额外加息（Binance +0.5-1% APY），设置自动续期1-2次（平衡自动化与控制），混合配置不同期限（如50%活期 + 30%定期30天 + 20%定期90天）。', estimated_time: '1–2 小时' },
    { step_number: 5, title: '长期监控与风险管理', description: '每月检查到期产品并决定续投或提现，对比各平台利率变化（必要时转移资金），每月提现20%利息到冷钱包（降低平台累积风险），每季度审查资金分配比例（根据市场环境调整活期vs定期），关注平台风险信号（提现延迟、负面新闻）。', estimated_time: '每月10分钟' },
  ],
};

async function getAuthToken() {
  const response = await axios.post(`${DIRECTUS_URL}/auth/login`, {
    email: 'the_uk1@outlook.com',
    password: 'Mygcdjmyxzg2026!',
  });
  return response.data.data.access_token;
}

async function addGuide() {
  try {
    const token = await getAuthToken();

    const strategy = {
      ...GUIDE_CONFIG,
      status: 'published',
      is_featured: true,
      view_count: 0,
      bookmark_count: 0,
      published_at: new Date().toISOString(),
    };

    const response = await axios.post(
      `${DIRECTUS_URL}/items/strategies`,
      strategy,
      {
        headers: {
          Authorization: `Bearer ${token}`,
          'Content-Type': 'application/json',
        },
      },
    );

    console.log('\n✅ CeFi 定期理财锁仓创建成功!');
    console.log(`   ID: ${response.data.data.id}`);
    console.log(`   Slug: ${response.data.data.slug}`);
    console.log(`   访问: http://localhost:3000/strategies/${response.data.data.slug}\n`);
  } catch (error) {
    console.error('\n❌ 创建失败:', error.response?.data || error.message);
  }
}

addGuide();