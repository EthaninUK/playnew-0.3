# ä½“åŠ›å€¼ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ

## ä¸€ã€èƒŒæ™¯

ç”±äºæ”¿ç­–å’Œæ³•å¾‹ç›¸å…³çš„è§„å®šï¼Œå¹³å°å–æ¶ˆä¼šå‘˜ä»˜è´¹åˆ¶åº¦ï¼Œæ”¹ä¸ºåŸºäº"ä½“åŠ›å€¼"çš„å…è´¹å†…å®¹è®¿é—®æ§åˆ¶ç³»ç»Ÿã€‚

---

## äºŒã€æ ¸å¿ƒæ¦‚å¿µ

**ä½“åŠ›å€¼ï¼ˆEnergy Pointsï¼‰** æ˜¯ç”¨æˆ·åœ¨å¹³å°ä¸Šè®¿é—®ä¼˜è´¨å†…å®¹å’ŒåŠŸèƒ½çš„è™šæ‹Ÿç§¯åˆ†ã€‚è¿™ä¸ªç³»ç»Ÿå®Œå…¨å…è´¹ï¼Œé€šè¿‡ç”¨æˆ·çš„æ´»è·ƒåº¦å’Œè´¡çŒ®æ¥åˆ†é…èµ„æºè®¿é—®æƒé™ã€‚

---

## ä¸‰ã€ä½“åŠ›å€¼ç³»ç»Ÿæ ¸å¿ƒæœºåˆ¶

### 1. åŸºç¡€å±æ€§

- **åˆå§‹ä½“åŠ›å€¼**: æ–°ç”¨æˆ·æ³¨å†Œè·å¾— 100 ç‚¹
- **æ¯æ—¥æ¢å¤**: æ¯å¤© 00:00 (UTC+8) è‡ªåŠ¨æ¢å¤ 50 ç‚¹ï¼ˆéœ€ç™»å½•ï¼‰
- **æœ€å¤§ä¸Šé™**: æ ¹æ®ç”¨æˆ·ç­‰çº§ 200-500 ç‚¹
- **æœ€å°ä¿ç•™**: ä¿æŒè‡³å°‘ 10 ç‚¹ï¼ˆç¡®ä¿ç”¨æˆ·å§‹ç»ˆèƒ½è®¿é—®åŸºç¡€å†…å®¹ï¼‰

### 2. ä½“åŠ›å€¼æ¶ˆè€—è§„åˆ™

| å†…å®¹ç±»å‹ | æ¶ˆè€—ä½“åŠ›å€¼ | è¯´æ˜ |
|---------|-----------|------|
| **å…è´¹å†…å®¹** | 0 ç‚¹ | æ‰€æœ‰å…¬å¼€çš„åŸºç¡€ç­–ç•¥ã€æ–°é—»åˆ—è¡¨é¡µ |
| **æ™®é€šç­–ç•¥è¯¦æƒ…** | 5 ç‚¹/æ¬¡ | æŸ¥çœ‹å®Œæ•´ç­–ç•¥å†…å®¹ |
| **é«˜çº§ç­–ç•¥è¯¦æƒ…** | 10 ç‚¹/æ¬¡ | æŸ¥çœ‹ç²¾é€‰/é«˜é£é™©é«˜å›æŠ¥ç­–ç•¥ (`featured=true`) |
| **å¥—åˆ©ä¿¡å·è¯¦æƒ…** | 15 ç‚¹/æ¬¡ | æŸ¥çœ‹å®æ—¶å¥—åˆ©æœºä¼šè¯¦æƒ… |
| **å…«å¦è¯¦æƒ…** | 3 ç‚¹/æ¬¡ | æŸ¥çœ‹è¡Œä¸šå…«å¦å®Œæ•´å†…å®¹ |
| **æ–°é—»è¯¦æƒ…** | 2 ç‚¹/æ¬¡ | æŸ¥çœ‹æ·±åº¦æ–°é—»åˆ†æ |
| **ä¸‹è½½èµ„æ–™** | 20 ç‚¹/æ¬¡ | ä¸‹è½½PDFã€è¡¨æ ¼ç­‰èµ„æ–™ |
| **AIå¯¹è¯** | 5 ç‚¹/æ¡ | ä¸AIåŠ©æ‰‹å¯¹è¯ï¼ˆæœªæ¥åŠŸèƒ½ï¼‰|

**æ³¨æ„**:
- åŒä¸€å†…å®¹720å°æ—¶å†…é‡å¤è®¿é—®ä¸å†æ‰£é™¤ä½“åŠ›å€¼
- å…è´¹å†…å®¹åŒ…æ‹¬ï¼šé¦–é¡µã€åˆ†ç±»é¡µã€åˆ—è¡¨é¡µã€å…³äºæˆ‘ä»¬ã€å¸®åŠ©ä¸­å¿ƒç­‰

### 3. ä½“åŠ›å€¼è·å–æ–¹å¼

| è¡Œä¸º | è·å¾—ä½“åŠ›å€¼ | é¢‘ç‡é™åˆ¶ | è¯´æ˜ |
|------|----------|---------|------|
| **æ¯æ—¥ç™»å½•** | +10 ç‚¹ | æ¯å¤©1æ¬¡ | éœ€åœ¨å¹³å°åœç•™30ç§’ä»¥ä¸Š |
| **è¿ç»­ç™»å½•å¥–åŠ±** | +20 ç‚¹ | è¿ç»­7å¤© | æ–­ç­¾éœ€é‡æ–°ç´¯è®¡ |
| **å®Œå–„ä¸ªäººèµ„æ–™** | +30 ç‚¹ | ä¸€æ¬¡æ€§ | åŒ…æ‹¬å¤´åƒã€ç®€ä»‹ã€å…´è¶£æ ‡ç­¾ |
| **åˆ†äº«å†…å®¹** | +5 ç‚¹ | æ¯å¤©5æ¬¡ | åˆ†äº«åˆ°Twitter/Telegramç­‰ |
| **å‘è¡¨è¯„è®º** | +3 ç‚¹ | æ¯å¤©10æ¡ | æœ‰æ•ˆè¯„è®ºï¼ˆ>20å­—ï¼‰ |
| **ä¼˜è´¨å†…å®¹è¯„è®º** | +10 ç‚¹ | ç®¡ç†å‘˜è®¤å®š | æ·±åº¦åˆ†æã€æœ‰ä»·å€¼è§‚ç‚¹ |
| **å‘å¸ƒç­–ç•¥/æ”»ç•¥** | +50 ç‚¹ | å®¡æ ¸é€šè¿‡ | åŸåˆ›å†…å®¹ï¼Œè´¨é‡å®¡æ ¸ |
| **é‚€è¯·æ–°ç”¨æˆ·** | +40 ç‚¹ | æ¯ä¸ªæ–°ç”¨æˆ· | æ–°ç”¨æˆ·å®Œæˆæ³¨å†Œå¹¶æ´»è·ƒ3å¤© |
| **å‚ä¸è°ƒæŸ¥é—®å·** | +15 ç‚¹ | ä¸å®šæœŸ | å¹³å°äº§å“è°ƒç ” |
| **ä¸¾æŠ¥è¿è§„å†…å®¹** | +20 ç‚¹ | å®¡æ ¸é€šè¿‡ | æœ‰æ•ˆä¸¾æŠ¥ |
| **è§‚çœ‹å¹¿å‘Š** | +2 ç‚¹ | æ¯å¤©10æ¬¡ | å®Œæ•´è§‚çœ‹15-30ç§’å¹¿å‘Š |
| **å®Œæˆæ¯å‘¨ä»»åŠ¡** | +30 ç‚¹ | æ¯å‘¨1æ¬¡ | é˜…è¯»5ç¯‡æ–‡ç« ã€è¯„è®º3æ¬¡ç­‰ |

---

## å››ã€ç”¨æˆ·ç­‰çº§ä½“ç³»

ç”¨æˆ·ç­‰çº§å½±å“ä½“åŠ›ä¸Šé™å’Œå†…å®¹æŠ˜æ‰£ï¼š

### ğŸŒ± æ–°æ‰‹ç”¨æˆ· (0-500 ç´¯è®¡æ´»è·ƒåº¦)
- ä½“åŠ›ä¸Šé™: 200
- æ¯æ—¥æ¢å¤: 50
- å†…å®¹æŠ˜æ‰£: æ— 

### ğŸŒ¿ æ´»è·ƒç”¨æˆ· (501-2000 ç´¯è®¡æ´»è·ƒåº¦)
- ä½“åŠ›ä¸Šé™: 300
- æ¯æ—¥æ¢å¤: 70
- å†…å®¹æŠ˜æ‰£: ç­–ç•¥æ¶ˆè€— -20%

### ğŸŒ³ èµ„æ·±ç”¨æˆ· (2001-5000 ç´¯è®¡æ´»è·ƒåº¦)
- ä½“åŠ›ä¸Šé™: 400
- æ¯æ—¥æ¢å¤: 100
- å†…å®¹æŠ˜æ‰£: ç­–ç•¥æ¶ˆè€— -40%
- ç‰¹æƒ: éƒ¨åˆ†æ™®é€šç­–ç•¥å…è´¹

### ğŸ† æ ¸å¿ƒç”¨æˆ· (5000+ ç´¯è®¡æ´»è·ƒåº¦)
- ä½“åŠ›ä¸Šé™: 500
- æ¯æ—¥æ¢å¤: 150
- å†…å®¹æŠ˜æ‰£: ç­–ç•¥æ¶ˆè€— -60%
- ç‰¹æƒ: å¤§éƒ¨åˆ†å†…å®¹å…è´¹ï¼Œä»…é«˜çº§ç­–ç•¥å’Œå¥—åˆ©ä¿¡å·éœ€æ¶ˆè€—

### ç´¯è®¡æ´»è·ƒåº¦è®¡ç®—å…¬å¼

```
ç´¯è®¡æ´»è·ƒåº¦ = ç™»å½•å¤©æ•° Ã— 2 + è¯„è®ºæ•° + åˆ†äº«æ•° Ã— 3 + å†…å®¹è´¡çŒ®æ•° Ã— 10
```

---

## äº”ã€æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### 5.1 æ•°æ®åº“è®¾è®¡

#### è¡¨1: user_energyï¼ˆç”¨æˆ·ä½“åŠ›è¡¨ï¼‰

```sql
CREATE TABLE user_energy (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) NOT NULL UNIQUE,
  current_energy INT DEFAULT 100 CHECK (current_energy >= 0),
  max_energy INT DEFAULT 200 CHECK (max_energy > 0),
  daily_recovery INT DEFAULT 50,
  user_level VARCHAR(20) DEFAULT 'newbie' CHECK (user_level IN ('newbie', 'active', 'senior', 'core')),
  total_activity_score INT DEFAULT 0,
  last_recovery_at TIMESTAMP DEFAULT NOW(),
  last_login_at TIMESTAMP DEFAULT NOW(),
  consecutive_login_days INT DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_user_energy_user_id ON user_energy(user_id);
CREATE INDEX idx_user_energy_level ON user_energy(user_level);
```

#### è¡¨2: energy_transactionsï¼ˆä½“åŠ›äº¤æ˜“è®°å½•ï¼‰

```sql
CREATE TABLE energy_transactions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) NOT NULL,
  energy_change INT NOT NULL, -- æ­£æ•°ä¸ºè·å¾—ï¼Œè´Ÿæ•°ä¸ºæ¶ˆè€—
  energy_before INT NOT NULL,
  energy_after INT NOT NULL,
  transaction_type VARCHAR(50) NOT NULL, -- 'view_strategy', 'daily_login', 'share', etc.
  content_id UUID, -- å…³è”çš„å†…å®¹IDï¼ˆå¦‚æœé€‚ç”¨ï¼‰
  content_type VARCHAR(50), -- 'strategy', 'news', 'arbitrage', 'gossip'
  description TEXT,
  metadata JSONB, -- é¢å¤–ä¿¡æ¯ï¼Œå¦‚åˆ†äº«å¹³å°ã€è¯„è®ºå†…å®¹ç­‰
  created_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_energy_trans_user_id ON energy_transactions(user_id);
CREATE INDEX idx_energy_trans_type ON energy_transactions(transaction_type);
CREATE INDEX idx_energy_trans_created ON energy_transactions(created_at DESC);
CREATE INDEX idx_energy_trans_content ON energy_transactions(content_id, content_type);
```

#### è¡¨3: content_energy_configï¼ˆå†…å®¹ä½“åŠ›é…ç½®ï¼‰

```sql
CREATE TABLE content_energy_config (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  content_type VARCHAR(50) NOT NULL, -- 'strategy', 'news', 'arbitrage', 'gossip'
  is_premium BOOLEAN DEFAULT FALSE, -- æ˜¯å¦ä¸ºé«˜çº§å†…å®¹
  is_free BOOLEAN DEFAULT FALSE, -- æ˜¯å¦å®Œå…¨å…è´¹
  base_energy_cost INT DEFAULT 0 CHECK (base_energy_cost >= 0),
  description TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(content_type, is_premium)
);

-- åˆå§‹æ•°æ®
INSERT INTO content_energy_config (content_type, is_premium, is_free, base_energy_cost, description) VALUES
('strategy', false, false, 5, 'æ™®é€šç­–ç•¥è¯¦æƒ…'),
('strategy', true, false, 10, 'ç²¾é€‰é«˜çº§ç­–ç•¥'),
('news', false, false, 2, 'æ–°é—»è¯¦æƒ…'),
('gossip', false, false, 3, 'å…«å¦è¯¦æƒ…'),
('arbitrage', false, false, 15, 'å¥—åˆ©ä¿¡å·è¯¦æƒ…');
```

#### è¡¨4: user_content_accessï¼ˆç”¨æˆ·å†…å®¹è®¿é—®è®°å½•ï¼‰

ç”¨äºå®ç°"24å°æ—¶å†…é‡å¤è®¿é—®ä¸æ‰£è´¹"åŠŸèƒ½ï¼š

```sql
CREATE TABLE user_content_access (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) NOT NULL,
  content_id UUID NOT NULL,
  content_type VARCHAR(50) NOT NULL,
  first_accessed_at TIMESTAMP DEFAULT NOW(),
  last_accessed_at TIMESTAMP DEFAULT NOW(),
  access_count INT DEFAULT 1,
  created_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_content_access_user_content ON user_content_access(user_id, content_id, content_type);
CREATE INDEX idx_content_access_time ON user_content_access(last_accessed_at);

-- è‡ªåŠ¨æ¸…ç†7å¤©å‰çš„è®°å½•
CREATE OR REPLACE FUNCTION cleanup_old_content_access()
RETURNS void AS $$
BEGIN
  DELETE FROM user_content_access WHERE last_accessed_at < NOW() - INTERVAL '7 days';
END;
$$ LANGUAGE plpgsql;
```

#### è¡¨5: daily_tasksï¼ˆæ¯æ—¥ä»»åŠ¡é…ç½®ï¼‰

```sql
CREATE TABLE daily_tasks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  task_key VARCHAR(50) NOT NULL UNIQUE, -- 'daily_login', 'share_content', etc.
  task_name VARCHAR(100) NOT NULL,
  description TEXT,
  energy_reward INT DEFAULT 0,
  daily_limit INT DEFAULT 1, -- æ¯æ—¥å®Œæˆæ¬¡æ•°é™åˆ¶
  is_active BOOLEAN DEFAULT TRUE,
  required_action VARCHAR(50), -- 'login', 'share', 'comment', etc.
  metadata JSONB, -- ä»»åŠ¡é¢å¤–é…ç½®
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- åˆå§‹ä»»åŠ¡æ•°æ®
INSERT INTO daily_tasks (task_key, task_name, description, energy_reward, daily_limit, required_action) VALUES
('daily_login', 'æ¯æ—¥ç™»å½•', 'æ¯å¤©ç™»å½•å¹³å°è·å¾—ä½“åŠ›å€¼', 10, 1, 'login'),
('share_content', 'åˆ†äº«å†…å®¹', 'åˆ†äº«å†…å®¹åˆ°ç¤¾äº¤åª’ä½“', 5, 5, 'share'),
('write_comment', 'å‘è¡¨è¯„è®º', 'å‘è¡¨æœ‰æ•ˆè¯„è®ºï¼ˆ>20å­—ï¼‰', 3, 10, 'comment'),
('watch_ad', 'è§‚çœ‹å¹¿å‘Š', 'è§‚çœ‹å®Œæ•´å¹¿å‘Š', 2, 10, 'watch_ad');
```

#### è¡¨6: user_task_progressï¼ˆç”¨æˆ·ä»»åŠ¡è¿›åº¦ï¼‰

```sql
CREATE TABLE user_task_progress (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) NOT NULL,
  task_key VARCHAR(50) NOT NULL,
  date DATE DEFAULT CURRENT_DATE,
  completed_count INT DEFAULT 0,
  total_energy_earned INT DEFAULT 0,
  last_completed_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, task_key, date)
);

-- ç´¢å¼•
CREATE INDEX idx_task_progress_user_date ON user_task_progress(user_id, date);
CREATE INDEX idx_task_progress_task ON user_task_progress(task_key, date);
```

---

### 5.2 API ç«¯ç‚¹è®¾è®¡

#### 1. GET /api/energy/status
è·å–ç”¨æˆ·å½“å‰ä½“åŠ›å€¼çŠ¶æ€

**Response:**
```json
{
  "success": true,
  "data": {
    "current_energy": 150,
    "max_energy": 200,
    "daily_recovery": 50,
    "user_level": "active",
    "total_activity_score": 850,
    "next_recovery_at": "2025-01-12T00:00:00Z",
    "consecutive_login_days": 5
  }
}
```

#### 2. POST /api/energy/consume
æ¶ˆè€—ä½“åŠ›å€¼ï¼ˆæŸ¥çœ‹å†…å®¹ï¼‰

**Request:**
```json
{
  "content_type": "strategy",
  "content_id": "uuid-here",
  "content_slug": "uniswap-v3-strategy"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "energy_consumed": 5,
    "remaining_energy": 145,
    "transaction_id": "uuid-here",
    "is_free_access": false,
    "reason": "å·²åœ¨24å°æ—¶å†…è®¿é—®è¿‡" // å¦‚æœå…è´¹
  }
}
```

**Error Response (ä½“åŠ›ä¸è¶³):**
```json
{
  "success": false,
  "error": {
    "code": "INSUFFICIENT_ENERGY",
    "message": "ä½“åŠ›å€¼ä¸è¶³",
    "required": 10,
    "current": 5,
    "suggestions": [
      "å®Œæˆæ¯æ—¥ç™»å½•ä»»åŠ¡è·å¾— 10 ç‚¹",
      "åˆ†äº«å†…å®¹è·å¾— 5 ç‚¹",
      "è§‚çœ‹å¹¿å‘Šè·å¾— 2 ç‚¹"
    ]
  }
}
```

#### 3. POST /api/energy/earn
è·å¾—ä½“åŠ›å€¼ï¼ˆå®Œæˆä»»åŠ¡ï¼‰

**Request:**
```json
{
  "action_type": "daily_login",
  "metadata": {
    "platform": "web",
    "session_duration": 45
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "energy_earned": 10,
    "current_energy": 160,
    "transaction_id": "uuid-here",
    "message": "æ¯æ—¥ç™»å½•å¥–åŠ± +10 ä½“åŠ›å€¼",
    "consecutive_login_days": 6,
    "bonus": null
  }
}
```

#### 4. GET /api/energy/transactions
æŸ¥è¯¢ä½“åŠ›äº¤æ˜“å†å²

**Query Parameters:**
- `limit`: æ¯é¡µæ•°é‡ (é»˜è®¤ 20)
- `offset`: åç§»é‡ (é»˜è®¤ 0)
- `type`: è¿‡æ»¤ç±»å‹ (å¯é€‰)

**Response:**
```json
{
  "success": true,
  "data": {
    "transactions": [
      {
        "id": "uuid",
        "energy_change": -5,
        "energy_before": 150,
        "energy_after": 145,
        "transaction_type": "view_strategy",
        "content_type": "strategy",
        "description": "æŸ¥çœ‹ç­–ç•¥ï¼šUniswap V3 æµåŠ¨æ€§æŒ–çŸ¿",
        "created_at": "2025-01-11T10:30:00Z"
      }
    ],
    "total_count": 48,
    "pagination": {
      "limit": 20,
      "offset": 0,
      "has_more": true
    }
  }
}
```

#### 5. GET /api/energy/daily-tasks
è·å–æ¯æ—¥ä»»åŠ¡åˆ—è¡¨åŠè¿›åº¦

**Response:**
```json
{
  "success": true,
  "data": {
    "date": "2025-01-11",
    "tasks": [
      {
        "task_key": "daily_login",
        "task_name": "æ¯æ—¥ç™»å½•",
        "description": "æ¯å¤©ç™»å½•å¹³å°è·å¾—ä½“åŠ›å€¼",
        "energy_reward": 10,
        "daily_limit": 1,
        "completed": true,
        "progress": {
          "current": 1,
          "total": 1
        },
        "next_available_at": "2025-01-12T00:00:00Z"
      },
      {
        "task_key": "share_content",
        "task_name": "åˆ†äº«å†…å®¹",
        "description": "åˆ†äº«å†…å®¹åˆ°ç¤¾äº¤åª’ä½“",
        "energy_reward": 5,
        "daily_limit": 5,
        "completed": false,
        "progress": {
          "current": 2,
          "total": 5
        },
        "next_available_at": null
      }
    ],
    "total_earned_today": 20
  }
}
```

#### 6. GET /api/energy/check-access
æ£€æŸ¥æ˜¯å¦å¯ä»¥è®¿é—®æŸä¸ªå†…å®¹ï¼ˆä¸å®é™…æ‰£è´¹ï¼‰

**Query Parameters:**
- `content_type`: å†…å®¹ç±»å‹
- `content_id`: å†…å®¹ID

**Response:**
```json
{
  "success": true,
  "data": {
    "can_access": true,
    "is_free": false,
    "energy_cost": 5,
    "current_energy": 150,
    "reason": "é¦–æ¬¡è®¿é—®éœ€æ¶ˆè€— 5 ç‚¹ä½“åŠ›å€¼",
    "already_accessed": false,
    "free_until": null
  }
}
```

#### 7. POST /api/energy/recover
æ‰‹åŠ¨è§¦å‘ä½“åŠ›æ¢å¤ï¼ˆä»…ç®¡ç†å‘˜æˆ–å®šæ—¶ä»»åŠ¡ï¼‰

**Request:**
```json
{
  "user_id": "uuid" // å¯é€‰ï¼Œä¸ä¼ åˆ™æ¢å¤æ‰€æœ‰ç”¨æˆ·
}
```

---

### 5.3 å®šæ—¶ä»»åŠ¡è®¾è®¡

#### æ¯æ—¥ä½“åŠ›æ¢å¤ (Cron Job)

**æ‰§è¡Œæ—¶é—´**: æ¯å¤© 00:00 UTC+8

**ä¼ªä»£ç **:
```sql
-- æ›´æ–°æ‰€æœ‰ç”¨æˆ·çš„ä½“åŠ›å€¼
UPDATE user_energy
SET
  current_energy = LEAST(current_energy + daily_recovery, max_energy),
  last_recovery_at = NOW(),
  updated_at = NOW()
WHERE last_recovery_at < CURRENT_DATE;

-- é‡ç½®è¿ç»­ç™»å½•å¤©æ•°ï¼ˆè¶…è¿‡48å°æ—¶æœªç™»å½•ï¼‰
UPDATE user_energy
SET consecutive_login_days = 0
WHERE last_login_at < NOW() - INTERVAL '48 hours';
```

#### æ¸…ç†è¿‡æœŸè®¿é—®è®°å½•

**æ‰§è¡Œæ—¶é—´**: æ¯å¤© 03:00 UTC+8

```sql
DELETE FROM user_content_access
WHERE last_accessed_at < NOW() - INTERVAL '7 days';
```

#### ç”¨æˆ·ç­‰çº§æ›´æ–°

**æ‰§è¡Œæ—¶é—´**: æ¯å°æ—¶

```sql
UPDATE user_energy
SET
  user_level = CASE
    WHEN total_activity_score >= 5000 THEN 'core'
    WHEN total_activity_score >= 2001 THEN 'senior'
    WHEN total_activity_score >= 501 THEN 'active'
    ELSE 'newbie'
  END,
  max_energy = CASE
    WHEN total_activity_score >= 5000 THEN 500
    WHEN total_activity_score >= 2001 THEN 400
    WHEN total_activity_score >= 501 THEN 300
    ELSE 200
  END,
  daily_recovery = CASE
    WHEN total_activity_score >= 5000 THEN 150
    WHEN total_activity_score >= 2001 THEN 100
    WHEN total_activity_score >= 501 THEN 70
    ELSE 50
  END
WHERE updated_at < NOW() - INTERVAL '1 hour';
```

---

### 5.4 å‰ç«¯ç»„ä»¶è®¾è®¡

#### ç»„ä»¶1: EnergyDisplayï¼ˆä½“åŠ›å€¼æ˜¾ç¤ºï¼‰

ä½ç½®ï¼šHeader ç»„ä»¶ä¸­

```tsx
// components/energy/EnergyDisplay.tsx
import { Zap } from 'lucide-react';
import { Progress } from '@/components/ui/progress';

interface EnergyDisplayProps {
  current: number;
  max: number;
  level: string;
}

export function EnergyDisplay({ current, max, level }: EnergyDisplayProps) {
  const percentage = (current / max) * 100;

  return (
    <div className="flex items-center gap-3 px-3 py-2 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border border-yellow-200">
      <Zap className="w-5 h-5 text-yellow-500 fill-yellow-500" />
      <div className="flex flex-col gap-1">
        <div className="flex items-baseline gap-1">
          <span className="text-sm font-bold text-gray-900">{current}</span>
          <span className="text-xs text-gray-500">/ {max}</span>
        </div>
        <Progress value={percentage} className="w-24 h-1.5" />
      </div>
    </div>
  );
}
```

#### ç»„ä»¶2: EnergyInsufficientDialogï¼ˆä½“åŠ›ä¸è¶³å¼¹çª—ï¼‰

```tsx
// components/energy/EnergyInsufficientDialog.tsx
import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { Zap, Gift, Share2, MessageSquare } from 'lucide-react';

interface Suggestion {
  icon: React.ReactNode;
  title: string;
  reward: number;
  action: () => void;
}

export function EnergyInsufficientDialog({
  open,
  onClose,
  required,
  current
}: Props) {
  const suggestions: Suggestion[] = [
    {
      icon: <Gift className="w-5 h-5" />,
      title: 'å®Œæˆæ¯æ—¥ä»»åŠ¡',
      reward: 10,
      action: () => router.push('/tasks')
    },
    {
      icon: <Share2 className="w-5 h-5" />,
      title: 'åˆ†äº«å†…å®¹',
      reward: 5,
      action: () => handleShare()
    },
    {
      icon: <MessageSquare className="w-5 h-5" />,
      title: 'å‘è¡¨è¯„è®º',
      reward: 3,
      action: () => handleComment()
    }
  ];

  return (
    <Dialog open={open} onOpenChange={onClose}>
      <DialogContent>
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Zap className="w-6 h-6 text-yellow-500" />
            ä½“åŠ›å€¼ä¸è¶³
          </DialogTitle>
        </DialogHeader>

        <div className="space-y-4">
          <p className="text-sm text-gray-600">
            æŸ¥çœ‹æ­¤å†…å®¹éœ€è¦ <strong>{required}</strong> ç‚¹ä½“åŠ›å€¼ï¼Œ
            æ‚¨å½“å‰ä»…æœ‰ <strong>{current}</strong> ç‚¹ã€‚
          </p>

          <div className="space-y-2">
            <p className="text-sm font-medium">å¿«é€Ÿè·å–ä½“åŠ›å€¼ï¼š</p>
            {suggestions.map((item, index) => (
              <Button
                key={index}
                variant="outline"
                className="w-full justify-between"
                onClick={item.action}
              >
                <span className="flex items-center gap-2">
                  {item.icon}
                  {item.title}
                </span>
                <span className="text-yellow-600">+{item.reward}</span>
              </Button>
            ))}
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}
```

#### ç»„ä»¶3: DailyTasksPanelï¼ˆæ¯æ—¥ä»»åŠ¡é¢æ¿ï¼‰

```tsx
// components/energy/DailyTasksPanel.tsx
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Progress } from '@/components/ui/progress';
import { CheckCircle2, Circle } from 'lucide-react';

export function DailyTasksPanel() {
  const { data: tasks, isLoading } = useDailyTasks();

  return (
    <Card>
      <CardHeader>
        <CardTitle>æ¯æ—¥ä»»åŠ¡</CardTitle>
        <CardDescription>å®Œæˆä»»åŠ¡è·å–ä½“åŠ›å€¼</CardDescription>
      </CardHeader>
      <CardContent className="space-y-3">
        {tasks?.map(task => (
          <div key={task.task_key} className="flex items-center justify-between p-3 rounded-lg border">
            <div className="flex items-center gap-3">
              {task.completed ? (
                <CheckCircle2 className="w-5 h-5 text-green-500" />
              ) : (
                <Circle className="w-5 h-5 text-gray-300" />
              )}
              <div>
                <p className="font-medium">{task.task_name}</p>
                <p className="text-sm text-gray-500">
                  {task.progress.current}/{task.progress.total}
                </p>
              </div>
            </div>
            <span className="text-yellow-600 font-medium">+{task.energy_reward}</span>
          </div>
        ))}
      </CardContent>
    </Card>
  );
}
```

#### ç»„ä»¶4: EnergyTransactionHistoryï¼ˆä½“åŠ›å†å²ï¼‰

```tsx
// components/energy/EnergyTransactionHistory.tsx
export function EnergyTransactionHistory() {
  const { data, fetchNextPage, hasNextPage } = useEnergyTransactions();

  return (
    <div className="space-y-2">
      {data?.pages.map(page =>
        page.transactions.map(tx => (
          <div key={tx.id} className="flex items-center justify-between p-3 border-b">
            <div>
              <p className="text-sm font-medium">{tx.description}</p>
              <p className="text-xs text-gray-500">
                {new Date(tx.created_at).toLocaleString()}
              </p>
            </div>
            <span className={cn(
              "font-medium",
              tx.energy_change > 0 ? "text-green-600" : "text-red-600"
            )}>
              {tx.energy_change > 0 ? '+' : ''}{tx.energy_change}
            </span>
          </div>
        ))
      )}

      {hasNextPage && (
        <Button onClick={() => fetchNextPage()} variant="outline">
          åŠ è½½æ›´å¤š
        </Button>
      )}
    </div>
  );
}
```

---

### 5.5 å†…å®¹è®¿é—®æ§åˆ¶ä¸­é—´ä»¶

åœ¨æŸ¥çœ‹è¯¦æƒ…é¡µå‰æ‹¦æˆªå¹¶æ£€æŸ¥ä½“åŠ›å€¼ï¼š

```tsx
// hooks/useEnergyGate.ts
export function useEnergyGate() {
  const router = useRouter();
  const [showInsufficientDialog, setShowInsufficientDialog] = useState(false);

  async function checkAndConsumeEnergy(
    contentType: string,
    contentId: string,
    contentSlug: string
  ): Promise<boolean> {
    try {
      // 1. æ£€æŸ¥è®¿é—®æƒé™
      const checkRes = await fetch(
        `/api/energy/check-access?content_type=${contentType}&content_id=${contentId}`
      );
      const checkData = await checkRes.json();

      // 2. å¦‚æœå…è´¹æˆ–å·²è®¿é—®è¿‡ï¼Œç›´æ¥é€šè¿‡
      if (checkData.data.is_free || checkData.data.already_accessed) {
        return true;
      }

      // 3. æ£€æŸ¥ä½“åŠ›å€¼æ˜¯å¦è¶³å¤Ÿ
      if (!checkData.data.can_access) {
        setShowInsufficientDialog(true);
        return false;
      }

      // 4. æ¶ˆè€—ä½“åŠ›å€¼
      const consumeRes = await fetch('/api/energy/consume', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ content_type: contentType, content_id: contentId })
      });

      if (!consumeRes.ok) {
        toast.error('ä½“åŠ›å€¼æ‰£é™¤å¤±è´¥');
        return false;
      }

      // 5. æ˜¾ç¤ºæˆåŠŸæç¤º
      const consumeData = await consumeRes.json();
      toast.success(`æ¶ˆè€— ${consumeData.data.energy_consumed} ç‚¹ä½“åŠ›å€¼`);

      return true;
    } catch (error) {
      console.error('Energy gate error:', error);
      return false;
    }
  }

  return { checkAndConsumeEnergy, showInsufficientDialog, setShowInsufficientDialog };
}
```

ä½¿ç”¨ç¤ºä¾‹ï¼š

```tsx
// app/strategies/[slug]/page.tsx
export default function StrategyDetailPage({ params }: { params: { slug: string } }) {
  const { checkAndConsumeEnergy } = useEnergyGate();
  const [canView, setCanView] = useState(false);

  useEffect(() => {
    async function checkAccess() {
      const allowed = await checkAndConsumeEnergy('strategy', strategyId, params.slug);
      setCanView(allowed);
    }
    checkAccess();
  }, [params.slug]);

  if (!canView) {
    return <EnergyGatePlaceholder />;
  }

  return <StrategyDetail strategy={strategy} />;
}
```

---

## å…­ã€å®æ–½æ­¥éª¤

### Phase 1: æ•°æ®åº“å’Œåç«¯åŸºç¡€ (ç¬¬1å‘¨)

**ç›®æ ‡**: å»ºç«‹ä½“åŠ›å€¼ç³»ç»Ÿçš„æ•°æ®åŸºç¡€

- [ ] åˆ›å»º `user_energy` è¡¨
- [ ] åˆ›å»º `energy_transactions` è¡¨
- [ ] åˆ›å»º `content_energy_config` è¡¨
- [ ] åˆ›å»º `user_content_access` è¡¨
- [ ] åˆ›å»º `daily_tasks` è¡¨
- [ ] åˆ›å»º `user_task_progress` è¡¨
- [ ] ç¼–å†™åˆå§‹åŒ–SQLè„šæœ¬
- [ ] ä¸ºæ‰€æœ‰ç°æœ‰ç”¨æˆ·åˆ›å»ºåˆå§‹ä½“åŠ›å€¼è®°å½•

### Phase 2: API ç«¯ç‚¹å¼€å‘ (ç¬¬2å‘¨)

**ç›®æ ‡**: å®ç°æ‰€æœ‰ä½“åŠ›å€¼ç›¸å…³API

- [ ] å®ç° `/api/energy/status` (è·å–çŠ¶æ€)
- [ ] å®ç° `/api/energy/consume` (æ¶ˆè€—ä½“åŠ›)
- [ ] å®ç° `/api/energy/earn` (è·å¾—ä½“åŠ›)
- [ ] å®ç° `/api/energy/transactions` (å†å²è®°å½•)
- [ ] å®ç° `/api/energy/daily-tasks` (ä»»åŠ¡åˆ—è¡¨)
- [ ] å®ç° `/api/energy/check-access` (æ£€æŸ¥è®¿é—®æƒé™)
- [ ] ç¼–å†™APIå•å…ƒæµ‹è¯•
- [ ] ç¼–å†™APIé›†æˆæµ‹è¯•

### Phase 3: å®šæ—¶ä»»åŠ¡å’Œè‡ªåŠ¨åŒ– (ç¬¬2å‘¨)

**ç›®æ ‡**: å®ç°ä½“åŠ›å€¼è‡ªåŠ¨æ¢å¤å’Œç®¡ç†

- [ ] è®¾ç½®æ¯æ—¥ä½“åŠ›æ¢å¤ Cron Job
- [ ] è®¾ç½®è®¿é—®è®°å½•æ¸…ç† Cron Job
- [ ] è®¾ç½®ç”¨æˆ·ç­‰çº§è‡ªåŠ¨æ›´æ–° Cron Job
- [ ] å®ç°è¿ç»­ç™»å½•æ£€æµ‹é€»è¾‘
- [ ] å®ç°æ´»è·ƒåº¦è‡ªåŠ¨è®¡ç®—
- [ ] æµ‹è¯•å®šæ—¶ä»»åŠ¡å¯é æ€§

### Phase 4: å†…å®¹æ ‡è®°å’Œé…ç½® (ç¬¬3å‘¨)

**ç›®æ ‡**: ä¸ºç°æœ‰å†…å®¹é…ç½®ä½“åŠ›æ¶ˆè€—

- [ ] æ ‡è®°æ‰€æœ‰ç­–ç•¥çš„ `featured` å­—æ®µï¼ˆåŒºåˆ†æ™®é€š/é«˜çº§ï¼‰
- [ ] é…ç½®æ–°é—»çš„ä½“åŠ›æ¶ˆè€—è§„åˆ™
- [ ] é…ç½®å…«å¦çš„ä½“åŠ›æ¶ˆè€—è§„åˆ™
- [ ] é…ç½®å¥—åˆ©ä¿¡å·çš„ä½“åŠ›æ¶ˆè€—è§„åˆ™
- [ ] åˆ›å»ºå…è´¹å†…å®¹ç™½åå•
- [ ] ç¼–å†™å†…å®¹ç®¡ç†åå°ç•Œé¢ï¼ˆDirectusï¼‰

### Phase 5: å‰ç«¯UIå¼€å‘ (ç¬¬3-4å‘¨)

**ç›®æ ‡**: å®ç°ç”¨æˆ·ä¾§çš„ä½“åŠ›å€¼ç•Œé¢

- [ ] åœ¨ Header æ·»åŠ ä½“åŠ›å€¼æ˜¾ç¤ºç»„ä»¶
- [ ] åˆ›å»ºä½“åŠ›ä¸è¶³å¼¹çª—ç»„ä»¶
- [ ] åˆ›å»ºæ¯æ—¥ä»»åŠ¡é¢æ¿
- [ ] åˆ›å»ºä½“åŠ›å†å²è®°å½•é¡µé¢
- [ ] å®ç°å†…å®¹è®¿é—®æ‹¦æˆªé€»è¾‘ (`useEnergyGate`)
- [ ] æ·»åŠ ä½“åŠ›å€¼å˜åŒ–åŠ¨ç”»æ•ˆæœ
- [ ] åˆ›å»ºä½“åŠ›å€¼è¯´æ˜é¡µé¢ `/energy/help`
- [ ] æ·»åŠ æ–°æ‰‹å¼•å¯¼

### Phase 6: ç”¨æˆ·ä½“éªŒä¼˜åŒ– (ç¬¬4å‘¨)

**ç›®æ ‡**: ä¼˜åŒ–äº¤äº’å’Œè§†è§‰æ•ˆæœ

- [ ] æ·»åŠ ä½“åŠ›å€¼è·å¾—/æ¶ˆè€—çš„ Toast æç¤º
- [ ] ä¼˜åŒ–ä½“åŠ›ä¸è¶³æ—¶çš„å¼•å¯¼æµç¨‹
- [ ] æ·»åŠ å†…å®¹é¢„è§ˆåŠŸèƒ½ï¼ˆä¸æ¶ˆè€—ä½“åŠ›ï¼‰
- [ ] å®ç°"æ”¶è—"åŠŸèƒ½ï¼ˆå·²æŸ¥çœ‹å†…å®¹å¯å…è´¹å†æ¬¡è®¿é—®ï¼‰
- [ ] æ·»åŠ ä½“åŠ›å€¼ä½¿ç”¨å»ºè®®ï¼ˆæ™ºèƒ½æ¨èï¼‰
- [ ] A/B æµ‹è¯•ä¸åŒçš„ä½“åŠ›æ¶ˆè€—å€¼

### Phase 7: æµ‹è¯•å’Œè°ƒä¼˜ (ç¬¬5å‘¨)

**ç›®æ ‡**: ç¡®ä¿ç³»ç»Ÿç¨³å®šå’Œå¹³è¡¡

- [ ] è¿›è¡Œå†…éƒ¨æµ‹è¯•ï¼ˆ10-20äººï¼‰
- [ ] æ”¶é›†æµ‹è¯•åé¦ˆ
- [ ] è°ƒæ•´ä½“åŠ›æ¶ˆè€—/è·å–æ¯”ä¾‹
- [ ] æ€§èƒ½æµ‹è¯•ï¼ˆé«˜å¹¶å‘åœºæ™¯ï¼‰
- [ ] å®‰å…¨æµ‹è¯•ï¼ˆé˜²æ­¢åˆ·ä½“åŠ›å€¼ï¼‰
- [ ] ä¿®å¤å‘ç°çš„ Bug

### Phase 8: æ¸…ç†æ—§ç³»ç»Ÿ (ç¬¬5å‘¨)

**ç›®æ ‡**: ç§»é™¤ä¼šå‘˜ä»˜è´¹ç³»ç»Ÿ

- [ ] åˆ é™¤ `/api/subscription` ç›¸å…³ä»£ç 
- [ ] åˆ é™¤ `/api/memberships` ç›¸å…³ä»£ç 
- [ ] åˆ é™¤ Stripe æ”¯ä»˜é›†æˆ
- [ ] åˆ é™¤ä¼šå‘˜ç›¸å…³æ•°æ®è¡¨ï¼ˆæˆ–æ ‡è®°ä¸ºå·²å¼ƒç”¨ï¼‰
- [ ] åˆ é™¤ `/pricing` é¡µé¢
- [ ] åˆ é™¤ `/membership` é¡µé¢
- [ ] æ›´æ–°æ–‡æ¡£å’Œå¸®åŠ©ä¸­å¿ƒ

### Phase 9: ä¸Šçº¿å’Œç›‘æ§ (ç¬¬6å‘¨)

**ç›®æ ‡**: æ­£å¼å‘å¸ƒå¹¶æŒç»­ç›‘æ§

- [ ] éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- [ ] å‘å¸ƒå…¬å‘Šé€šçŸ¥ç”¨æˆ·
- [ ] è®¾ç½®æ•°æ®ç›‘æ§é¢æ¿ï¼ˆä½“åŠ›å€¼æ¶ˆè€—/è·å–ç»Ÿè®¡ï¼‰
- [ ] ç›‘æ§ç”¨æˆ·åé¦ˆ
- [ ] å‡†å¤‡åº”æ€¥å›æ»šæ–¹æ¡ˆ
- [ ] æŒç»­ä¼˜åŒ–å‚æ•°

---

## ä¸ƒã€é£é™©å’Œåº”å¯¹

### é£é™©1: ä½“åŠ›å€¼è¢«åˆ·

**é£é™©**: ç”¨æˆ·é€šè¿‡è‡ªåŠ¨åŒ–è„šæœ¬åˆ·ä½“åŠ›å€¼

**åº”å¯¹**:
- æ·»åŠ éªŒè¯ç ï¼ˆGoogle reCAPTCHAï¼‰
- æ£€æµ‹å¼‚å¸¸è¡Œä¸ºï¼ˆçŸ­æ—¶é—´å†…å¤§é‡æ“ä½œï¼‰
- è®¾ç½®æ¯æ—¥ä»»åŠ¡çš„æ—¶é—´é—´éš”é™åˆ¶
- ä½¿ç”¨ IP é™æµ

### é£é™©2: ä½“åŠ›å€¼ä¸å¤Ÿç”¨

**é£é™©**: ç”¨æˆ·åé¦ˆä½“åŠ›å€¼å¤ªå°‘ï¼Œå½±å“ä½“éªŒ

**åº”å¯¹**:
- åˆæœŸè®¾ç½®è¾ƒå®½æ¾çš„ä½“åŠ›å€¼ï¼ˆé™ä½æ¶ˆè€—50%ï¼‰
- æ ¹æ®æ•°æ®é€æ­¥è°ƒæ•´
- æä¾›æ›´å¤šè·å–ä½“åŠ›çš„æ–¹å¼
- å¯¹æ–°ç”¨æˆ·ç»™äºˆé¢å¤–å¥–åŠ±

### é£é™©3: ç”¨æˆ·æµå¤±

**é£é™©**: éƒ¨åˆ†ç”¨æˆ·ä¸é€‚åº”æ–°ç³»ç»Ÿç¦»å¼€

**åº”å¯¹**:
- æå‰1-2å‘¨å…¬å‘Šï¼Œè¯´æ˜åŸå› 
- ç»™äºˆè€ç”¨æˆ·è¡¥å¿ï¼ˆé¢å¤–ä½“åŠ›å€¼æˆ–ç­‰çº§ï¼‰
- æä¾›è¯¦ç»†çš„æ–°æ‰‹æ•™ç¨‹
- æ”¶é›†åé¦ˆå¿«é€Ÿè¿­ä»£

### é£é™©4: æŠ€æœ¯æ•…éšœ

**é£é™©**: ä½“åŠ›å€¼ç³»ç»Ÿå‡ºç° Bug å¯¼è‡´è¯¯æ‰£æˆ–æ— æ³•æ¢å¤

**åº”å¯¹**:
- è¯¦ç»†çš„æ—¥å¿—è®°å½•
- ä½“åŠ›å€¼äº¤æ˜“å¯è¿½æº¯ã€å¯å›æ»š
- å®šæœŸå¤‡ä»½æ•°æ®
- è®¾ç½®å‘Šè­¦æœºåˆ¶

---

## å…«ã€æ•°æ®ç›‘æ§æŒ‡æ ‡

### å…³é”®æŒ‡æ ‡ (KPI)

1. **ç”¨æˆ·æ´»è·ƒåº¦**
   - DAU (æ—¥æ´»è·ƒç”¨æˆ·)
   - MAU (æœˆæ´»è·ƒç”¨æˆ·)
   - å¹³å‡åœç•™æ—¶é—´

2. **ä½“åŠ›å€¼å¹³è¡¡**
   - å¹³å‡ä½“åŠ›å€¼ä½™é¢
   - æ¯æ—¥ä½“åŠ›æ¶ˆè€—æ€»é‡
   - æ¯æ—¥ä½“åŠ›è·å–æ€»é‡
   - ä½“åŠ›å€¼æ¶ˆè€—/è·å–æ¯”ä¾‹ï¼ˆç›®æ ‡ï¼š0.8-1.2ï¼‰

3. **å†…å®¹è®¿é—®**
   - è¢«æŸ¥çœ‹å†…å®¹çš„æ•°é‡
   - è¢«æŸ¥çœ‹æœ€å¤šçš„å†…å®¹ç±»å‹
   - å¹³å‡æ¯ç”¨æˆ·æ¯æ—¥è®¿é—®å†…å®¹æ•°

4. **ä»»åŠ¡å®Œæˆç‡**
   - æ¯æ—¥ç™»å½•å®Œæˆç‡
   - åˆ†äº«ä»»åŠ¡å®Œæˆç‡
   - è¯„è®ºä»»åŠ¡å®Œæˆç‡

5. **ç”¨æˆ·ç­‰çº§åˆ†å¸ƒ**
   - å„ç­‰çº§ç”¨æˆ·å æ¯”
   - ç­‰çº§æ™‹å‡é€Ÿåº¦

### ç›‘æ§ Dashboard

å»ºè®®ä½¿ç”¨å·¥å…·ï¼š
- **æ•°æ®å¯è§†åŒ–**: Grafana / Metabase
- **æ—¥å¿—åˆ†æ**: Elasticsearch + Kibana
- **ç”¨æˆ·è¡Œä¸º**: Mixpanel / Amplitude

---

## ä¹ã€ä¼˜åŠ¿æ€»ç»“

âœ… **åˆè§„æ€§**: å®Œå…¨å…è´¹ï¼Œæ— ä»˜è´¹å†…å®¹ï¼Œç¬¦åˆç›‘ç®¡è¦æ±‚
âœ… **ç”¨æˆ·ç²˜æ€§**: æ¯æ—¥ç™»å½•å’Œä»»åŠ¡æœºåˆ¶æé«˜ DAU/MAU
âœ… **å…¬å¹³æ€§**: æ´»è·ƒç”¨æˆ·è·å¾—æ›´å¤šæƒç›Šï¼Œä½“ç°ä»·å€¼
âœ… **å¯æŒç»­æ€§**: å¯é€šè¿‡å¹¿å‘Šã€æ•°æ®åˆ†æã€API æˆæƒç­‰æ–¹å¼å˜ç°
âœ… **çµæ´»æ€§**: å¯éšæ—¶è°ƒæ•´ä½“åŠ›æ¶ˆè€—è§„åˆ™ï¼Œå¿«é€Ÿå“åº”å¸‚åœº
âœ… **ç¤¾åŒºé©±åŠ¨**: é¼“åŠ±ç”¨æˆ·è´¡çŒ®å†…å®¹ã€äº’åŠ¨è®¨è®º
âœ… **æ•°æ®ä»·å€¼**: ç”¨æˆ·è¡Œä¸ºæ•°æ®æ›´æœ‰ä»·å€¼ï¼ˆçœŸå®æ´»è·ƒåº¦ï¼‰

---

## åã€åç»­ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸï¼ˆ1-3ä¸ªæœˆï¼‰
- å¢åŠ æ›´å¤šè·å–ä½“åŠ›çš„æ–¹å¼ï¼ˆé—®å·ã€æ¨èç­‰ï¼‰
- ä¼˜åŒ–ä»»åŠ¡ç³»ç»Ÿï¼ˆæ¯å‘¨ä»»åŠ¡ã€æˆå°±ç³»ç»Ÿï¼‰
- æ·»åŠ ä½“åŠ›å€¼ç¤¼åŒ…ï¼ˆèŠ‚æ—¥æ´»åŠ¨ï¼‰

### ä¸­æœŸï¼ˆ3-6ä¸ªæœˆï¼‰
- å¼•å…¥"VIPä½“éªŒå¡"ï¼ˆä¸´æ—¶æå‡ä½“åŠ›ä¸Šé™ï¼Œéä»˜è´¹è´­ä¹°ï¼‰
- å®ç°å†…å®¹æ¨èç®—æ³•ï¼ˆé™ä½ç”¨æˆ·ä¸æ„Ÿå…´è¶£å†…å®¹çš„æ¶ˆè€—ï¼‰
- æ·»åŠ ç¤¾äº¤åŠŸèƒ½ï¼ˆå¥½å‹äº’èµ ä½“åŠ›å€¼ï¼‰

### é•¿æœŸï¼ˆ6-12ä¸ªæœˆï¼‰
- å¼€å‘ä½“åŠ›å€¼å…‘æ¢ç³»ç»Ÿï¼ˆå…‘æ¢å®ä½“å¥–å“ã€åˆä½œå¹³å°ä¼˜æƒ ï¼‰
- å¼•å…¥ç§¯åˆ†å•†åŸï¼ˆç”¨ä½“åŠ›å€¼å…‘æ¢å·¥å…·ã€æœåŠ¡ï¼‰
- æ„å»ºåˆ›ä½œè€…æ¿€åŠ±ä½“ç³»ï¼ˆå†…å®¹è´¡çŒ®è€…åˆ†äº«æ”¶ç›Šï¼‰

---

## åä¸€ã€FAQï¼ˆå¸¸è§é—®é¢˜ï¼‰

**Q1: ä¸ºä»€ä¹ˆè¦å–æ¶ˆä¼šå‘˜åˆ¶ï¼Ÿ**
A: æ ¹æ®ç›¸å…³æ”¿ç­–å’Œæ³•å¾‹è§„å®šï¼Œä¸ºç¡®ä¿å¹³å°åˆè§„è¿è¥ï¼Œæˆ‘ä»¬å†³å®šé‡‡ç”¨å…è´¹çš„ä½“åŠ›å€¼ç³»ç»Ÿã€‚

**Q2: ä½“åŠ›å€¼ä¼šè¿‡æœŸå—ï¼Ÿ**
A: ä¸ä¼šã€‚æ‚¨çš„ä½“åŠ›å€¼ä¼šä¸€ç›´ä¿ç•™ï¼Œä½†ä¼šæœ‰ä¸Šé™é™åˆ¶ã€‚

**Q3: å¦‚ä½•å¿«é€Ÿè·å¾—ä½“åŠ›å€¼ï¼Ÿ**
A: æ¯æ—¥ç™»å½•ã€åˆ†äº«å†…å®¹ã€å‘è¡¨è¯„è®ºã€é‚€è¯·å¥½å‹ç­‰éƒ½å¯ä»¥è·å¾—ä½“åŠ›å€¼ã€‚

**Q4: å¯ä»¥è´­ä¹°ä½“åŠ›å€¼å—ï¼Ÿ**
A: ä¸å¯ä»¥ã€‚ä½“åŠ›å€¼ç³»ç»Ÿå®Œå…¨å…è´¹ï¼Œæ— æ³•é€šè¿‡ä»˜è´¹è´­ä¹°ã€‚

**Q5: ä»€ä¹ˆå†…å®¹éœ€è¦æ¶ˆè€—ä½“åŠ›å€¼ï¼Ÿ**
A: æŸ¥çœ‹ç­–ç•¥è¯¦æƒ…ã€å¥—åˆ©ä¿¡å·ã€æ·±åº¦æ–°é—»ç­‰é«˜ä»·å€¼å†…å®¹éœ€è¦æ¶ˆè€—ä½“åŠ›å€¼ã€‚åˆ—è¡¨é¡µã€é¦–é¡µç­‰åŸºç¡€å†…å®¹å®Œå…¨å…è´¹ã€‚

**Q6: ä½“åŠ›å€¼ä¸å¤Ÿæ€ä¹ˆåŠï¼Ÿ**
A: æ‚¨å¯ä»¥é€šè¿‡å®Œæˆæ¯æ—¥ä»»åŠ¡ã€åˆ†äº«å†…å®¹ã€å‘è¡¨è¯„è®ºç­‰æ–¹å¼å¿«é€Ÿè·å–ä½“åŠ›å€¼ã€‚

**Q7: åŒä¸€å†…å®¹ä¼šé‡å¤æ‰£è´¹å—ï¼Ÿ**
A: ä¸ä¼šã€‚24å°æ—¶å†…é‡å¤è®¿é—®åŒä¸€å†…å®¹ä¸ä¼šå†æ¬¡æ‰£é™¤ä½“åŠ›å€¼ã€‚

**Q8: å¦‚ä½•æå‡ç”¨æˆ·ç­‰çº§ï¼Ÿ**
A: é€šè¿‡æŒç»­æ´»è·ƒã€è´¡çŒ®å†…å®¹ã€å®Œæˆä»»åŠ¡ç­‰æ–¹å¼æå‡æ´»è·ƒåº¦ï¼Œæ´»è·ƒåº¦è¾¾åˆ°ä¸€å®šå€¼ä¼šè‡ªåŠ¨æ™‹å‡ç­‰çº§ã€‚

---

## é™„å½•

### A. æ•°æ®åº“å®Œæ•´åˆå§‹åŒ–è„šæœ¬

è§ `/sql/init-energy-system.sql`

### B. API è¯¦ç»†æ–‡æ¡£

è§ `/docs/api/energy-system.md`

### C. å‰ç«¯ç»„ä»¶åº“

è§ `/frontend/components/energy/`

### D. æµ‹è¯•ç”¨ä¾‹

è§ `/tests/energy-system/`

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-01-11
**ä½œè€…**: PlayNew äº§å“å›¢é˜Ÿ
**å®¡æ ¸**: [å¾…å®¡æ ¸]

