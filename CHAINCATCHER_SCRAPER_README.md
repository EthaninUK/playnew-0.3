# ChainCatcher å¿«è®¯æŠ“å–å™¨ âœ…

## ğŸ“– æ¦‚è¿°

æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ª Node.js è„šæœ¬ï¼Œç”¨äºæŠ“å–**é“¾æ•æ‰‹ï¼ˆChainCatcherï¼‰** çš„å®æ—¶å¿«è®¯å¹¶ä¿å­˜åˆ° Directus CMSã€‚

- **ç›®æ ‡ç½‘ç«™**: https://www.chaincatcher.com/news
- **æ•°æ®æ¥æº**: ç½‘é¡µä¸­çš„ `window.__NUXT__` æ•°æ®ï¼ˆSSR æ¸²æŸ“ï¼‰
- **æ•°æ®é‡**: æ¯æ¬¡æŠ“å–å‰ 10 æ¡æœ€æ–°å¿«è®¯
- **ä¿å­˜ä½ç½®**: Directus `news` è¡¨

---

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. æ•°æ®æŠ“å–

- âœ… ä» ChainCatcher ç½‘é¡µæå– `window.__NUXT__` ä¸­çš„ `newsFlashList` æ•°æ®
- âœ… ä½¿ç”¨ Node.js `vm` æ¨¡å—å®‰å…¨æ‰§è¡Œ JavaScript ä»£ç 
- âœ… è‡ªåŠ¨è§£æ 20 æ¡å¿«è®¯ä¸­çš„å‰ 10 æ¡

### 2. æ•°æ®æå–

æˆåŠŸæå–ä»¥ä¸‹å­—æ®µï¼š

- âœ… **æ ‡é¢˜** (`title`): å¿«è®¯æ ‡é¢˜
- âœ… **å†…å®¹** (`content`): å®Œæ•´å¿«è®¯å†…å®¹
- âœ… **æ‘˜è¦** (`summary`): è‡ªåŠ¨æˆªå–å‰ 200 å­—ç¬¦
- âœ… **å‘å¸ƒæ—¶é—´** (`published_at`): åŸå§‹å‘å¸ƒæ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰
- âœ… **æ¥æº** (`source`): è‡ªåŠ¨ä»å†…å®¹ä¸­æå–ï¼ˆå¦‚ Coinglass, Glassnode ç­‰ï¼‰
- âœ… **URL**: æŒ‡å‘åŸå§‹å¿«è®¯çš„é“¾æ¥
- âœ… **æ˜¯å¦çƒ­é—¨** (`is_featured`): æ ¹æ® `isHot` å­—æ®µåˆ¤æ–­

### 3. æ•°æ®ä¿å­˜

- âœ… è‡ªåŠ¨ç™»å½• Directus
- âœ… å»é‡æ£€æŸ¥ï¼ˆåŸºäº `title` å­—æ®µï¼‰
- âœ… æ‰¹é‡ä¿å­˜åˆ° `news` è¡¨
- âœ… è¯¦ç»†çš„è¿›åº¦æ—¥å¿—å’Œé”™è¯¯æŠ¥å‘Š

### 4. æµ‹è¯•ç»“æœ

ç¬¬ä¸€æ¬¡è¿è¡ŒæˆåŠŸä¿å­˜ 10 æ¡å¿«è®¯ï¼š

```
âœ… ChainCatcher scraping complete!
   Total items: 10
   Saved: 10
   Skipped: 0
   Errors: 0
```

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

### [scrape-chaincatcher-simple.js](scrape-chaincatcher-simple.js)

ä¸»æŠ“å–è„šæœ¬ï¼Œå®Œæ•´åŠŸèƒ½åŒ…æ‹¬ï¼š

- HTTP è¯·æ±‚å’Œç½‘é¡µè·å–
- `window.__NUXT__` æ•°æ®æå–
- æ•°æ®å­—æ®µæ˜ å°„å’Œå¤„ç†
- Directus è®¤è¯å’Œæ•°æ®ä¿å­˜
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è¾“å‡º

### å…¶ä»–æ–‡ä»¶

- **scrape-chaincatcher.js**: ç¬¬ä¸€ç‰ˆï¼ˆå·²å¼ƒç”¨ï¼Œregex æ–¹æ³•å¤ªå¤æ‚ï¼‰
- **n8n-chaincatcher-workflow.json**: n8n å·¥ä½œæµï¼ˆå¾…å®Œå–„ï¼‰

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### è¿è¡ŒæŠ“å–å™¨

```bash
node scrape-chaincatcher-simple.js
```

### å®šæ—¶ä»»åŠ¡ï¼ˆå¯é€‰ï¼‰

ä½¿ç”¨ cron æˆ– n8n å®šæ—¶è¿è¡Œï¼š

```bash
# æ¯å°æ—¶è¿è¡Œä¸€æ¬¡
0 * * * * cd /Users/m1/PlayNew_0.3 && node scrape-chaincatcher-simple.js >> logs/chaincatcher.log 2>&1
```

### ç¯å¢ƒè¦æ±‚

- Node.js 14+
- å·²å®‰è£…ä¾èµ–: `axios`
- Directus è¿è¡Œåœ¨ `http://localhost:8055`
- æ•°æ®åº“ä¸­å·²åˆ›å»º `news` è¡¨

---

## ğŸ“Š æŠ“å–çš„æ•°æ®ç¤ºä¾‹

### å¿«è®¯ 1
```json
{
  "title": "æ•°æ®ï¼šETH å½“å‰å…¨ç½‘ 8 å°æ—¶å¹³å‡èµ„é‡‘è´¹ç‡ä¸º 0.0033%",
  "content": "ChainCatcher æ¶ˆæ¯ï¼Œæ® Coinglass æ•°æ®æ˜¾ç¤ºï¼ŒETH å½“å‰å…¨ç½‘ 8 å°æ—¶å¹³å‡èµ„é‡‘è´¹ç‡ä¸º 0.0033%ã€‚å½“å‰ä¸»æµäº¤æ˜“æ‰€ä¸­ï¼ŒBinance è´¹ç‡ä¸º 0.01%ï¼ŒOKX è´¹ç‡ä¸º 0.0037%ï¼ŒBybit è´¹ç‡ä¸º 0.01%ã€‚",
  "summary": "ChainCatcher æ¶ˆæ¯ï¼Œæ® Coinglass æ•°æ®æ˜¾ç¤ºï¼ŒETH å½“å‰å…¨ç½‘ 8 å°æ—¶å¹³å‡èµ„é‡‘è´¹ç‡ä¸º 0.0033%ã€‚å½“å‰ä¸»æµäº¤æ˜“æ‰€ä¸­ï¼ŒBinance è´¹ç‡ä¸º 0.01%ï¼ŒOKX è´¹ç‡ä¸º 0.0037%ï¼ŒBybit è´¹ç‡ä¸º 0.01%ã€‚",
  "url": "https://www.chaincatcher.com/article/2215265",
  "published_at": "2025-10-27T00:17:04.000Z",
  "source": "Coinglass",
  "source_type": "rss",
  "category": "news",
  "status": "published",
  "is_featured": false
}
```

### å¿«è®¯ 2
```json
{
  "title": "Glassnodeï¼šè¿‘æœŸæ¯”ç‰¹å¸æŠ›å”®å‹åŠ›å·²æ¶ˆé€€",
  "content": "ChainCatcher æ¶ˆæ¯ï¼ŒåŒºå—é“¾åˆ†æå…¬å¸ Glassnode åœ¨ X å¹³å°å‘æ–‡è¡¨ç¤ºï¼Œè‡ª 10 æœˆ 10 æ—¥å†²é«˜ä»¥æ¥ï¼Œæ¯”ç‰¹å¸çš„ç°è´§å’ŒæœŸè´§ CVDï¼ˆæ³¨ï¼šCVD æ˜¯ç´¯ç§¯äº¤æ˜“é‡å¢é‡ï¼Œé€šè¿‡è¿½è¸ªä¸»åŠ¨ä¹°å…¥æˆ–å–å‡ºçš„å‡€å‹åŠ›ç”¨äºåˆ¤æ–­å¸‚åœºæ–¹å‘ï¼‰é¦–æ¬¡è¶‹äºå¹³ç¼“ï¼Œè¡¨æ˜è¿‘æœŸå¼ºåŠ²çš„å¸‚åœºæŠ›å”®å‹åŠ›å·²ç»æ¶ˆé€€ã€‚",
  "source": "Glassnode",
  "is_featured": false
}
```

---

## ğŸ¯ æ•°æ®å­—æ®µæ˜ å°„

| ChainCatcher å­—æ®µ | Directus å­—æ®µ | è¯´æ˜ |
|-------------------|---------------|------|
| `title` | `title` | å¿«è®¯æ ‡é¢˜ |
| `description` | `content` | å®Œæ•´å†…å®¹ |
| `description` (æˆªå–) | `summary` | å‰ 200 å­—ç¬¦ |
| `releaseTime` | `published_at` | ISO 8601 æ ¼å¼ |
| ä» description æå– | `source` | æ•°æ®æ¥æºï¼ˆå¦‚ Coinglassï¼‰ |
| å›ºå®šå€¼ `rss` | `source_type` | æºç±»å‹ |
| å›ºå®šå€¼ `news` | `category` | åˆ†ç±» |
| å›ºå®šå€¼ `published` | `status` | çŠ¶æ€ |
| `isHot` | `is_featured` | æ˜¯å¦çƒ­é—¨ |
| å›ºå®šå€¼ `0` | `view_count` | æµè§ˆæ¬¡æ•° |

---

## ğŸ” æ•°æ®æ¥æºè§£æ

è„šæœ¬ä¼šè‡ªåŠ¨ä»å¿«è®¯å†…å®¹ä¸­æå–æ•°æ®æ¥æºï¼š

| å†…å®¹æ¨¡å¼ | æå–ç»“æœ |
|---------|---------|
| "æ® **Coinglass** æ•°æ®æ˜¾ç¤º..." | `Coinglass` |
| "**Glassnode** åœ¨ X å¹³å°å‘æ–‡..." | `Glassnode` |
| "æ® **Lookonchain** ç›‘æµ‹..." | `Lookonchain` |
| "**BitMEX** è‘£äº‹é•¿..." | `BitMEX` |
| æ— åŒ¹é… | `ChainCatcher` (é»˜è®¤) |

---

## âš™ï¸ é…ç½®è¯´æ˜

### Directus è¿æ¥é…ç½®

åœ¨ `scrape-chaincatcher-simple.js` ä¸­ä¿®æ”¹ï¼š

```javascript
const DIRECTUS_URL = 'http://localhost:8055';
const DIRECTUS_EMAIL = 'the_uk1@outlook.com';
const DIRECTUS_PASSWORD = 'Mygcdjmyxzg2026!';
```

### æŠ“å–æ•°é‡é…ç½®

ä¿®æ”¹è¿™ä¸€è¡Œå¯ä»¥æ”¹å˜æŠ“å–æ•°é‡ï¼ˆé»˜è®¤ 10 æ¡ï¼‰ï¼š

```javascript
const maxItems = Math.min(10, newsFlashList.length);
```

---

## ğŸ› å·²è§£å†³çš„é—®é¢˜

### 1. âŒ æƒé™é—®é¢˜ï¼šslug å­—æ®µ

**é—®é¢˜**:
```
You don't have permission to access field "slug" in collection "news"
```

**è§£å†³æ–¹æ¡ˆ**: ä¸å‘é€ `slug` å’Œ `id` å­—æ®µï¼Œè®© Directus è‡ªåŠ¨ç”Ÿæˆã€‚

### 2. âŒ å¿…å¡«å­—æ®µç¼ºå¤±

**é—®é¢˜**:
```
Validation failed for field "source_type". Value is required.
```

**è§£å†³æ–¹æ¡ˆ**: æ·»åŠ  `source_type: 'rss'`ï¼ˆå…¼å®¹ç°æœ‰æ•°æ®ç»“æ„ï¼‰ã€‚

### 3. âŒ Check constraint å†²çª

**é—®é¢˜**:
```
new row violates check constraint "collected_content_source_type_check"
```

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨ `source_type: 'rss'` è€Œä¸æ˜¯ `scraper`ï¼ˆæ•°æ®åº“åªå…è®¸ `rss` å€¼ï¼‰ã€‚

---

## ğŸ“ˆ æ•°æ®ç»Ÿè®¡

### è¿è¡Œå‰
- Directus `news` è¡¨: **35 æ¡**è®°å½•

### è¿è¡Œå
- Directus `news` è¡¨: **45 æ¡**è®°å½•
- æ–°å¢: **10 æ¡ ChainCatcher å¿«è®¯**

### å¿«è®¯å†…å®¹åˆ†ç±»

æŠ“å–çš„ 10 æ¡å¿«è®¯æ¶µç›–ï¼š

- ğŸ“Š å¸‚åœºæ•°æ®ï¼ˆèµ„é‡‘è´¹ç‡ã€çˆ†ä»“æ•°æ®ã€æŒä»“é‡ï¼‰: 6 æ¡
- ğŸ‹ å·¨é²¸åŠ¨æ€ï¼ˆå¤§é¢è½¬è´¦ã€æ¢ä»“ï¼‰: 2 æ¡
- ğŸ“° è¡Œä¸šæ–°é—»ï¼ˆé¡¹ç›®åŠ¨æ€ã€äººç‰©è§‚ç‚¹ï¼‰: 2 æ¡

---

## ğŸ”„ åç»­è®¡åˆ’

### å¾…å®ç°åŠŸèƒ½

1. **n8n é›†æˆ** - åˆ›å»ºå¯è§†åŒ–å·¥ä½œæµ
2. **AI ç¿»è¯‘** - é›†æˆ OpenRouter API è¿›è¡Œè‡ªåŠ¨ç¿»è¯‘ï¼ˆå·²æœ‰ API ç«¯ç‚¹ï¼‰
3. **åˆ†ç±»ä¼˜åŒ–** - è‡ªåŠ¨è¯†åˆ«å¿«è®¯ç±»åˆ«ï¼ˆè¡Œæƒ…ã€é¡¹ç›®ã€ç›‘ç®¡ç­‰ï¼‰
4. **å»é‡ä¼˜åŒ–** - ä½¿ç”¨ URL æˆ– ID è€Œä¸æ˜¯ title
5. **å¢é‡æŠ“å–** - åªæŠ“å–æ–°æ•°æ®ï¼Œé¿å…é‡å¤

### æ€§èƒ½ä¼˜åŒ–

- æ·»åŠ ç¼“å­˜æœºåˆ¶
- å¹¶å‘è¯·æ±‚ä¼˜åŒ–
- é”™è¯¯é‡è¯•æœºåˆ¶
- æ•°æ®éªŒè¯å¢å¼º

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **Rate Limiting**: ChainCatcher å¯èƒ½æœ‰åçˆ¬æœºåˆ¶ï¼Œå»ºè®®ï¼š
   - è®¾ç½®åˆç†çš„æŠ“å–é—´éš”ï¼ˆâ‰¥ 10 åˆ†é’Ÿï¼‰
   - ä½¿ç”¨éšæœº User-Agent
   - æ·»åŠ  Retry-After å“åº”å¤„ç†

2. **æ•°æ®è´¨é‡**:
   - éƒ¨åˆ†å¿«è®¯å¯èƒ½ç¼ºå°‘å®Œæ•´å†…å®¹
   - å‘å¸ƒæ—¶é—´å¯èƒ½ä¸ç²¾ç¡®
   - æ¥æºæå–å¯èƒ½ä¸å®Œæ•´

3. **æƒé™è¦æ±‚**:
   - Directus ç”¨æˆ·éœ€è¦ `news` è¡¨çš„ CREATE æƒé™
   - éœ€è¦ READ æƒé™ç”¨äºå»é‡æ£€æŸ¥

---

## ğŸ‰ æ€»ç»“

âœ… **æˆåŠŸå®ç°äº† ChainCatcher å¿«è®¯æŠ“å–åŠŸèƒ½**

- æ— éœ€ RSS feedï¼Œç›´æ¥ä»ç½‘é¡µæå–ç»“æ„åŒ–æ•°æ®
- è‡ªåŠ¨åŒ–æµç¨‹ï¼Œä¸€é”®è¿è¡Œ
- å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—
- å¯æ‰©å±•åˆ°å…¶ä»–ç±»ä¼¼ç½‘ç«™

**ä¸‹ä¸€æ­¥**: ä½ å¯ä»¥è®¿é—® http://localhost:3000/news æŸ¥çœ‹æŠ“å–çš„å¿«è®¯ï¼

---

## ğŸ”— ç›¸å…³é“¾æ¥

- ChainCatcher å¿«è®¯: https://www.chaincatcher.com/news
- Directus Admin: http://localhost:8055/admin
- å‰ç«¯å¿«è®¯é¡µé¢: http://localhost:3000/news
- OpenRouter API æ–‡æ¡£: [OPENROUTER_SETUP.md](OPENROUTER_SETUP.md)
