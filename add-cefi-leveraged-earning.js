const axios = require('axios');

const DIRECTUS_URL = 'http://localhost:8055';

const GUIDE_CONFIG = {
  title: 'CeFi 平台杠杆理财',
  slug: 'cefi-leveraged-earning',
  summary:
    'CeFi中心化平台杠杆理财策略：Binance/OKX/Bybit质押借币、杠杆ETF、Grid Trading Bot、Dual Investment双币理财、结构化产品、Shark Fin鲨鱼鳍、定期理财、流动性挖矿、历史APY 5-50%、风险对冲、平台安全评估、成本$500起。',

  category: 'lending',
  category_l1: 'yield',
  category_l2: '借贷挖息',

  difficulty_level: 2,
  risk_level: 3,
  apy_min: 5,
  apy_max: 50,

  threshold_capital: '500–100,000 USD（CeFi门槛低，$500起步）',
  threshold_capital_min: 500,
  time_commitment: '初始设置1–2小时，自动化运行，每周检查1次',
  time_commitment_minutes: 20,
  threshold_tech_level: 'beginner',

  content: `> **适用人群**：DeFi新手、追求简单操作、信任中心化平台、希望获得稳定收益的投资者
> **阅读时间**：≈ 40–55 分钟
> **关键词**：CeFi / Binance Earn / OKX Earn / Bybit Earn / Staking / Dual Investment / Grid Trading / Structured Products / Leverage / Risk Management

---

## 📊 TL;DR（60秒速览）

**核心思路**：利用CeFi平台的理财产品，通过质押、借币、杠杆获取收益

| 产品类型 | 年化收益 | 风险等级 | 流动性 |
|---------|---------|---------|--------|
| **活期理财** | 1–5% | ⭐ 极低 | 随时取 |
| **定期质押** | 3–15% | ⭐⭐ 低 | 锁仓期 |
| **Dual Investment** | 10–50% | ⭐⭐⭐ 中 | 到期结算 |
| **Grid Trading** | 5–30% | ⭐⭐⭐ 中 | 可随时停止 |
| **杠杆借币** | 8–40% | ⭐⭐⭐⭐ 高 | 需还款 |

**CeFi vs DeFi对比**：

| 特性 | CeFi（Binance/OKX） | DeFi（Aave/Compound） |
|------|-------------------|---------------------|
| **门槛** | $10起 | $500起（Gas费） |
| **操作难度** | ⭐ 简单 | ⭐⭐⭐ 复杂 |
| **Gas费** | ❌ 无 | ✅ 有（$10-100） |
| **托管** | 平台托管 | 自我托管 |
| **安全性** | 平台风险 | 智能合约风险 |
| **收益率** | 中等 | 较高 |

**CeFi优势**：
1. **零Gas费**：所有操作免手续费
2. **简单易用**：网页/APP操作，无需钱包
3. **低门槛**：$10即可开始
4. **客服支持**：7x24小时人工客服

---

## 🏗️ 主流CeFi平台对比

### 平台安全性评估

| 平台 | 监管 | 储备金证明 | 保险基金 | 历史事故 | 推荐度 |
|------|------|----------|---------|---------|--------|
| **Binance** | 多国牌照 | ✅ | ✅ $1B | 无 | ⭐⭐⭐⭐⭐ |
| **OKX** | 部分牌照 | ✅ | ✅ $500M | 无 | ⭐⭐⭐⭐⭐ |
| **Bybit** | 部分牌照 | ✅ | ✅ $300M | 无 | ⭐⭐⭐⭐ |
| **Kraken** | 美国牌照 | ✅ | ❌ | 无 | ⭐⭐⭐⭐ |
| **Coinbase** | 美国上市 | ✅ | ❌ | 无 | ⭐⭐⭐⭐ |

**推荐**：Binance或OKX（收益率高+安全性好）

---

## 🎯 策略1：质押借币套利

### 原理

\`\`\`
步骤1：质押BNB赚取收益（年化5%）
步骤2：借出USDT（年化3%）
步骤3：将USDT存入理财（年化8%）
步骤4：净收益 = 8% - 3% + 5% = 10%
\`\`\`

---

### Binance操作指南

**步骤1：质押BNB**

\`\`\`
1. 登录Binance
2. 【理财】→ 【质押】→ 搜索"BNB"
3. 选择"定期质押"（30天/60天/90天）
4. 输入金额：例如 10 BNB
5. 确认质押

收益：
• 30天：4% APY
• 60天：5% APY
• 90天：6% APY

锁仓期满自动赎回
\`\`\`

---

**步骤2：借币**

\`\`\`
1. 【理财】→ 【借币】
2. 选择"质押借币"
3. 抵押品：已质押的BNB
4. 借入：USDT
5. 最大可借：质押价值的65%

示例：
• 质押：10 BNB（价值$3,000）
• 最大可借：$1,950 USDT
• 保守借款：$1,500 USDT（50%）

借款利率：
• 日利率：0.0082%（年化3%）
• 按日计息，随借随还
\`\`\`

---

**步骤3：USDT理财**

\`\`\`
1. 【理财】→ 【活期】→ USDT
2. 存入借来的$1,500 USDT
3. 活期利率：约8% APY

或选择"定期"：
• 7天：6% APY
• 30天：8% APY
• 90天：10% APY
\`\`\`

---

**收益计算**：

\`\`\`
投入：10 BNB（$3,000）

年收益：
• BNB质押：$3,000 × 5% = $150
• USDT理财：$1,500 × 8% = $120
• 借币成本：$1,500 × 3% = -$45
• 净收益：$225（7.5% APY）

优势：
• 保留BNB持仓（若看涨BNB）
• 获得额外收益
• 零Gas费

风险：
• BNB价格下跌导致清算（LTV>65%）
• 平台风险
\`\`\`

---

## 🎯 策略2：Dual Investment双币理财

### 原理

**Dual Investment**（双币理财）：

\`\`\`
产品类型：结构化期权

运作方式：
• 挂钩价格：例如BTC $40,000
• 看涨/看涨选择
• 锁定期：1-7天
• 高收益（10-50% APY）

结算规则：
• 到期时，根据BTC价格结算
• 价格在目标上方/下方，决定结算币种
\`\`\`

---

### 示例：BTC看涨双币

\`\`\`
当前BTC价格：$38,000

产品参数：
• 投入：$10,000 USDT
• 挂钩价格：$40,000
• 期限：7天
• 年化收益：30%
• 实际收益：$10,000 × 30% × 7/365 = $57.5

到期结算：
场景A：BTC ≥ $40,000
• 结算为BTC（以$40,000兑换）
• 获得：$10,057.5 / $40,000 = 0.251 BTC

场景B：BTC < $40,000
• 结算为USDT
• 获得：$10,057.5 USDT

收益分析：
• 看涨BTC：场景A更优（以$40K买入BTC）
• 看跌/中性：场景B更优（保留USDT+收益）
\`\`\`

---

### OKX操作指南

\`\`\`
1. 登录OKX
2. 【金融业务】→ 【赚币】→ 【双币理财】
3. 选择币对：BTC/USDT
4. 选择方向：看涨/看跌
5. 输入金额和期限
6. 确认申购

推荐策略：
• 震荡市：选择窄幅挂钩价格（高收益）
• 趋势市：选择趋势方向（锁定方向+收益）
\`\`\`

---

## 🎯 策略3：Grid Trading网格交易

### 原理

**网格交易Bot**：自动化高抛低吸

\`\`\`
设置参数：
• 币对：BTC/USDT
• 价格区间：$35,000 - $45,000
• 网格数量：20个
• 投入：$10,000

运作方式：
每个网格$500间隔：
├─ $35,000 → 买入
├─ $35,500 → 卖出（赚$500 × 1.4% = $7）
├─ $36,000 → 买入
├─ $36,500 → 卖出
...

收益：
• 震荡市：每次买卖赚1-2%
• 日成交10次：日收益1%
• 月收益：约10-30%（取决于波动）
\`\`\`

---

### Binance Grid Trading

\`\`\`
1. 【现货】→ 【策略交易】→ 【网格交易】
2. 选择币对：BTC/USDT
3. 设置参数：
   • 模式：等差网格（推荐）
   • 价格区间：$35,000 - $45,000
   • 网格数量：20-50个（数量越多，收益频率越高）
   • 投资金额：$10,000
4. 【创建策略】

监控：
• 实时查看成交记录
• 累计收益显示
• 随时停止（返还本金+收益）

适用市场：
✅ 震荡市（横盘）
❌ 单边市（暴涨/暴跌会跑飞）
\`\`\`

---

### 收益计算

\`\`\`
投入：$10,000
BTC价格区间：$35K - $45K
网格数：20个

假设BTC每天波动3%：
• 触发网格：5-10次/天
• 每次收益：1.5%（网格利润）
• 日收益：$10,000 × 1.5% × 7次 ÷ 20网格 = $52.5
• 月收益：$1,575（15.75% APY）

⚠️ 风险：
• 单边行情：BTC涨至$50K，错过涨幅
• 缓解：设置止盈止损
\`\`\`

---

## 🎯 策略4：Shark Fin鲨鱼鳍

### 原理

**Shark Fin**（鲨鱼鳍）：保本型结构化产品

\`\`\`
产品特点：
• 保本：最低收益保证（如1%）
• 浮动收益：根据价格波动
• 锁定期：7-30天

收益曲线：
         /\\
        /  \\
最高收益 ──    ── 最高收益
       /      \\
      /        \\
保底收益────────────保底收益
    下界  现价  上界

示例：
• 当前BTC：$38,000
• 下界：$35,000
• 上界：$41,000
• 保底收益：1%
• 最高收益：15%

结算规则：
• BTC在$35K-41K之间：最高收益15%
• BTC超出范围：收益递减至保底1%
\`\`\`

---

### Bybit操作

\`\`\`
1. 【金融】→ 【理财】→ 【鲨鱼鳍】
2. 选择产品：BTC鲨鱼鳍（7天）
3. 查看参数：
   • 保底收益：1% APY
   • 最高收益：15% APY
   • 价格区间：$35K-41K
4. 投入金额：$5,000 USDT
5. 确认申购

7天后结算：
• 场景A：BTC在区间内 → $5,000 × 15% × 7/365 = $14.4
• 场景B：BTC超出区间 → $5,000 × 1% × 7/365 = $0.96

优势：
• 保本（至少获得1%）
• 震荡市高收益
• 适合谨慎投资者
\`\`\`

---

## 🎯 策略5：杠杆ETF

### 原理

**杠杆ETF**：自动调仓的杠杆代币

\`\`\`
传统杠杆：
• 需要抵押品
• 需要管理清算风险
• 需要手动平仓

杠杆ETF：
• 无需抵押品
• 无清算风险（自动再平衡）
• 买卖如现货

示例：
• BTC3L：3倍做多BTC
• BTC3S：3倍做空BTC
• ETH5L：5倍做多ETH

收益：
BTC涨10% → BTC3L涨30%
BTC跌10% → BTC3L跌30%
\`\`\`

---

### OKX杠杆ETF

\`\`\`
1. 【交易】→ 【杠杆ETF】
2. 选择代币：BTC3L（3倍做多）
3. 买入：$1,000 BTC3L

持有7天：
• BTC从$38K涨至$42K（+10.5%）
• BTC3L涨：10.5% × 3 = 31.5%
• 收益：$1,000 × 31.5% = $315

⚠️ 管理费：
• 日管理费：0.1%（年化36.5%）
• 适合短期持有（<30天）
• 长期持有被管理费侵蚀

策略：
• 趋势明确时使用
• 设置止盈止损
• 不适合震荡市（费用高+反复打损）
\`\`\`

---

## ⚠️ 风险管理

### 1. **平台风险**

**历史平台爆雷**：
- FTX（2022-11）：挪用用户资金，破产
- Celsius（2022-06）：流动性危机，冻结提现
- BlockFi（2022-11）：受FTX牵连，破产

**风险缓解**：
\`\`\`
1. 分散平台（不要All-in单一平台）
   • 50% Binance
   • 30% OKX
   • 20% Bybit

2. 定期提现（锁定利润）
   • 每月提现收益到冷钱包
   • 不要让资金长期滞留平台

3. 关注储备金证明
   • Binance：每月发布储备金报告
   • OKX：每季度审计
   • 若储备金<100%，立即提现

4. 设置安全措施
   • 开启2FA（Google Authenticator）
   • 设置提现白名单
   • 绑定邮箱+手机号
\`\`\`

---

### 2. **市场风险**

**极端行情风险**：

\`\`\`
场景：质押BNB借USDT

正常情况：
• BNB $300，质押10个（$3,000）
• 借款$1,500（50%）
• LTV：50%（安全）

极端情况：
• BNB暴跌至$200（-33%）
• 抵押品价值：$2,000
• LTV：$1,500 / $2,000 = 75%（超过65%清算线）
• 触发清算，损失BNB

应对：
• 保守借款（LTV 40-50%）
• 设置价格预警
• 预留应急资金还款
\`\`\`

---

### 3. **Dual Investment风险**

\`\`\`
问题：结算价格不利

示例：
• 投入$10,000 USDT
• 看涨双币，挂钩价$40,000
• 到期BTC价格$45,000

结算：
• 获得$10,057.5 / $40,000 = 0.251 BTC
• 市价价值：0.251 × $45,000 = $11,295

看似盈利$1,295，但：
• 若直接买BTC：$10,000 / $38,000 × $45,000 = $11,842
• 机会成本：$11,842 - $11,295 = $547

风险提示：
• Dual Investment适合震荡市
• 单边市会损失潜在涨幅
\`\`\`

---

## 💰 收益计算实例

### 场景1：保守组合（$10K）

\`\`\`
本金：$10,000 USDT

资产配置：
• 40%（$4K）→ 活期理财（3% APY）
• 30%（$3K）→ BTC定期质押30天（8% APY）
• 20%（$2K）→ 鲨鱼鳍保本产品（保底2%，最高12%）
• 10%（$1K）→ 网格交易（15% APY）

年收益：
• 活期：$4,000 × 3% = $120
• 定期：$3,000 × 8% = $240
• 鲨鱼鳍：$2,000 × 6%（平均）= $120
• 网格：$1,000 × 15% = $150
• 总收益：$630（6.3% APY）

优势：
• 低风险
• 流动性好（60%随时可取）
• 无Gas费
\`\`\`

---

### 场景2：激进组合（$20K）

\`\`\`
本金：$20,000

资产配置：
• 50%（$10K）→ 质押BNB借USDT套利（10% APY）
• 30%（$6K）→ Dual Investment双币（25% APY）
• 20%（$4K）→ 杠杆ETF短期交易（40% APY，高风险）

年收益：
• 质押借币：$10,000 × 10% = $1,000
• 双币理财：$6,000 × 25% = $1,500
• 杠杆ETF：$4,000 × 40% = $1,600
• 总收益：$4,100（20.5% APY）

⚠️ 风险：
• 杠杆ETF波动大
• Dual Investment可能结算不利
• 质押借币有清算风险
\`\`\`

---

## 📋 执行检查清单

### 阶段1：准备（1天）

- [ ] 选择平台（Binance/OKX/Bybit）
- [ ] 完成KYC认证
- [ ] 设置2FA安全认证
- [ ] 充值初始资金（$500+）

### 阶段2：保守理财（1周）

- [ ] 体验活期理财（低风险）
- [ ] 尝试定期质押（BTC/ETH/BNB）
- [ ] 测试鲨鱼鳍产品（保本型）
- [ ] 计算实际APY

### 阶段3：进阶策略（2-4周）

- [ ] 测试质押借币套利（小额）
- [ ] 尝试网格交易（震荡币对）
- [ ] Dual Investment双币理财（理解规则）
- [ ] 对比不同平台收益

### 阶段4：风险管理（持续）

- [ ] 定期提现收益（每月）
- [ ] 关注平台储备金报告
- [ ] 分散到2-3个平台
- [ ] 设置止盈止损

---

## 🎯 总结

**CeFi平台杠杆理财**的核心是**简单易用+稳定收益**：

| 优势 | 说明 |
|------|------|
| ✅ **零门槛** | $10起投，无Gas费 |
| ✅ **简单操作** | 网页/APP，无需钱包 |
| ✅ **产品丰富** | 质押/借币/双币/网格等 |
| ✅ **客服支持** | 7x24小时人工服务 |
| ⚠️ **平台风险** | 中心化，可能爆雷 |
| ⚠️ **收益较低** | 通常低于DeFi协议 |

**推荐路径**：
1. 新手：活期+定期质押（APY 3-8%）
2. 进阶：质押借币+网格（APY 8-20%）
3. 专家：Dual Investment+杠杆ETF（APY 20-50%）

**风险提醒**：分散平台，定期提现，不要All-in单一平台！ 🛡️
`,

  steps: [
    {
      step_number: 1,
      title: '平台选择与账户设置',
      description:
        '选择主流平台（Binance/OKX/Bybit），完成KYC身份认证，设置Google 2FA双重验证，绑定提现白名单地址，充值初始资金（建议$500-1K测试）。',
      time_minutes: 60
    },
    {
      step_number: 2,
      title: '基础理财产品体验',
      description:
        '尝试活期理财（USDT/BUSD，APY 1-5%），测试定期质押（BTC/ETH 30天，APY 5-10%），体验鲨鱼鳍保本产品，理解产品规则和赎回机制。',
      time_minutes: 30
    },
    {
      step_number: 3,
      title: '质押借币套利',
      description:
        '质押BNB/ETH（APY 5-8%），借出稳定币USDT（利率3-5%），将借款存入理财赚取利差（APY 8-12%），监控LTV比率保持<50%避免清算。',
      time_minutes: 90
    },
    {
      step_number: 4,
      title: '网格交易与双币理财',
      description:
        '设置网格交易Bot（BTC/ETH震荡区间），测试Dual Investment双币理财（理解看涨/看跌结算规则），小额尝试杠杆ETF短期交易（设置止损）。',
      time_minutes: 120
    },
    {
      step_number: 5,
      title: '风险管理与优化',
      description:
        '分散资金到2-3个平台降低风险，每月提现收益到冷钱包，关注平台储备金证明报告，定期评估收益率并调整策略，设置价格预警避免清算。',
      time_minutes: 60
    }
  ],

  status: 'published'
};

async function main() {
  try {
    // 1. 登录获取token
    const authResponse = await axios.post(DIRECTUS_URL + '/auth/login', {
      email: 'the_uk1@outlook.com',
      password: 'Mygcdjmyxzg2026!'
    });

    const token = authResponse.data.data.access_token;

    // 2. 创建策略
    const response = await axios.post(
      DIRECTUS_URL + '/items/strategies',
      {
        ...GUIDE_CONFIG,
        steps: GUIDE_CONFIG.steps
      },
      {
        headers: {
          Authorization: 'Bearer ' + token,
          'Content-Type': 'application/json'
        }
      }
    );

    console.log('✅ CeFi 平台杠杆理财创建成功!');
    console.log('   ID: ' + response.data.data.id);
    console.log('   Slug: ' + response.data.data.slug);
    console.log('   访问: http://localhost:3000/strategies/' + response.data.data.slug);
  } catch (error) {
    console.error('❌ 创建失败:', error.response?.data || error.message);
  }
}

main();
